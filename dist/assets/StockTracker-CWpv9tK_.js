import{c as Ue,R as O,r as j,j as e,o as fe,G as Ke,P as Ve,X as ve,d as Ge,a as Je}from"./index-DZvGYDZx.js";import{W as He}from"./WorkspaceContext-a4SP8AtR.js";import{H as ke}from"./history-HHRrpftE.js";import{a as je,C as Xe}from"./chevron-left-lDjsGLEJ.js";import{C as we}from"./chart-pie-CSHCf4PB.js";import{j as Ye,e as Ne,D as Qe,F as Ze,a0 as et,L as ge,f as ae,C as tt,A as rt,a as Q,d as at,b as me,h as nt,g as st,k as Te,u as it,G as ot,l as Se,n as lt,o as dt,R as xe,T as ue,B as Ae,p as De}from"./generateCategoricalChart-Da9NiW74.js";import{X as ne,Y as se}from"./YAxis-CEg6XoPi.js";import{C as he}from"./CartesianGrid-Dzwtv_rx.js";import{B as Ce}from"./BarChart-DCCmzrpO.js";import{D as Oe}from"./download-CgZR0B2Y.js";import{T as ct}from"./trash-2-CI_c4LFd.js";import{B as gt}from"./briefcase-BhKlelno.js";import{U as xt}from"./upload-Cp9IRTdL.js";import{C as ut}from"./chevron-right-DaPw27d4.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=Ue("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var mt=["type","layout","connectNulls","ref"],yt=["key"];function H(a){"@babel/helpers - typeof";return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},H(a)}function Pe(a,n){if(a==null)return{};var s=pt(a,n),r,o;if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(a);for(o=0;o<g.length;o++)r=g[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(s[r]=a[r])}return s}function pt(a,n){if(a==null)return{};var s={};for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){if(n.indexOf(r)>=0)continue;s[r]=a[r]}return s}function Z(){return Z=Object.assign?Object.assign.bind():function(a){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(a[r]=s[r])}return a},Z.apply(this,arguments)}function $e(a,n){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(a,o).enumerable})),s.push.apply(s,r)}return s}function T(a){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?$e(Object(s),!0).forEach(function(r){E(a,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):$e(Object(s)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(s,r))})}return a}function J(a){return kt(a)||vt(a)||ft(a)||bt()}function bt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ft(a,n){if(a){if(typeof a=="string")return ye(a,n);var s=Object.prototype.toString.call(a).slice(8,-1);if(s==="Object"&&a.constructor&&(s=a.constructor.name),s==="Map"||s==="Set")return Array.from(a);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ye(a,n)}}function vt(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function kt(a){if(Array.isArray(a))return ye(a)}function ye(a,n){(n==null||n>a.length)&&(n=a.length);for(var s=0,r=new Array(n);s<n;s++)r[s]=a[s];return r}function jt(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Le(a,n){for(var s=0;s<n.length;s++){var r=n[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,Ee(r.key),r)}}function wt(a,n,s){return n&&Le(a.prototype,n),s&&Le(a,s),Object.defineProperty(a,"prototype",{writable:!1}),a}function Nt(a,n,s){return n=ie(n),St(a,_e()?Reflect.construct(n,s||[],ie(a).constructor):n.apply(a,s))}function St(a,n){if(n&&(H(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return At(a)}function At(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _e(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_e=function(){return!!a})()}function ie(a){return ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},ie(a)}function Dt(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),n&&pe(a,n)}function pe(a,n){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},pe(a,n)}function E(a,n,s){return n=Ee(n),n in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s,a}function Ee(a){var n=Ct(a,"string");return H(n)=="symbol"?n:n+""}function Ct(a,n){if(H(a)!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var r=s.call(a,n);if(H(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}var ee=function(a){function n(){var s;jt(this,n);for(var r=arguments.length,o=new Array(r),g=0;g<r;g++)o[g]=arguments[g];return s=Nt(this,n,[].concat(o)),E(s,"state",{isAnimationFinished:!0,totalLength:0}),E(s,"generateSimpleStrokeDasharray",function(c,u){return"".concat(u,"px ").concat(c-u,"px")}),E(s,"getStrokeDasharray",function(c,u,y){var v=y.reduce(function(k,P){return k+P});if(!v)return s.generateSimpleStrokeDasharray(u,c);for(var A=Math.floor(c/v),N=c%v,f=u-c,S=[],m=0,w=0;m<y.length;w+=y[m],++m)if(w+y[m]>N){S=[].concat(J(y.slice(0,m)),[N-w]);break}var x=S.length%2===0?[0,f]:[f];return[].concat(J(n.repeat(y,A)),J(S),x).map(function(k){return"".concat(k,"px")}).join(", ")}),E(s,"id",it("recharts-line-")),E(s,"pathRef",function(c){s.mainCurve=c}),E(s,"handleAnimationEnd",function(){s.setState({isAnimationFinished:!0}),s.props.onAnimationEnd&&s.props.onAnimationEnd()}),E(s,"handleAnimationStart",function(){s.setState({isAnimationFinished:!1}),s.props.onAnimationStart&&s.props.onAnimationStart()}),s}return Dt(n,a),wt(n,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var g=this.props,c=g.points,u=g.xAxis,y=g.yAxis,v=g.layout,A=g.children,N=Ze(A,et);if(!N)return null;var f=function(w,x){return{x:w.x,y:w.y,value:w.value,errorVal:Te(w.payload,x)}},S={clipPath:r?"url(#clipPath-".concat(o,")"):null};return O.createElement(ge,S,N.map(function(m){return O.cloneElement(m,{key:"bar-".concat(m.props.dataKey),data:c,xAxis:u,yAxis:y,layout:v,dataPointFormatter:f})}))}},{key:"renderDots",value:function(r,o,g){var c=this.props.isAnimationActive;if(c&&!this.state.isAnimationFinished)return null;var u=this.props,y=u.dot,v=u.points,A=u.dataKey,N=ae(this.props,!1),f=ae(y,!0),S=v.map(function(w,x){var k=T(T(T({key:"dot-".concat(x),r:3},N),f),{},{index:x,cx:w.x,cy:w.y,value:w.value,dataKey:A,payload:w.payload,points:v});return n.renderDotItem(y,k)}),m={clipPath:r?"url(#clipPath-".concat(o?"":"dots-").concat(g,")"):null};return O.createElement(ge,Z({className:"recharts-line-dots",key:"dots"},m),S)}},{key:"renderCurveStatically",value:function(r,o,g,c){var u=this.props,y=u.type,v=u.layout,A=u.connectNulls;u.ref;var N=Pe(u,mt),f=T(T(T({},ae(N,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:o?"url(#clipPath-".concat(g,")"):null,points:r},c),{},{type:y,layout:v,connectNulls:A});return O.createElement(tt,Z({},f,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,o){var g=this,c=this.props,u=c.points,y=c.strokeDasharray,v=c.isAnimationActive,A=c.animationBegin,N=c.animationDuration,f=c.animationEasing,S=c.animationId,m=c.animateNewValues,w=c.width,x=c.height,k=this.state,P=k.prevPoints,F=k.totalLength;return O.createElement(rt,{begin:A,duration:N,isActive:v,easing:f,from:{t:0},to:{t:1},key:"line-".concat(S),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(M){var $=M.t;if(P){var I=P.length/u.length,L=u.map(function(C,X){var z=Math.floor(X*I);if(P[z]){var U=P[z],_=Q(U.x,C.x),te=Q(U.y,C.y);return T(T({},C),{},{x:_($),y:te($)})}if(m){var oe=Q(w*2,C.x),le=Q(x/2,C.y);return T(T({},C),{},{x:oe($),y:le($)})}return T(T({},C),{},{x:C.x,y:C.y})});return g.renderCurveStatically(L,r,o)}var q=Q(0,F),B=q($),R;if(y){var W="".concat(y).split(/[,\s]+/gim).map(function(C){return parseFloat(C)});R=g.getStrokeDasharray(B,F,W)}else R=g.generateSimpleStrokeDasharray(F,B);return g.renderCurveStatically(u,r,o,{strokeDasharray:R})})}},{key:"renderCurve",value:function(r,o){var g=this.props,c=g.points,u=g.isAnimationActive,y=this.state,v=y.prevPoints,A=y.totalLength;return u&&c&&c.length&&(!v&&A>0||!at(v,c))?this.renderCurveWithAnimation(r,o):this.renderCurveStatically(c,r,o)}},{key:"render",value:function(){var r,o=this.props,g=o.hide,c=o.dot,u=o.points,y=o.className,v=o.xAxis,A=o.yAxis,N=o.top,f=o.left,S=o.width,m=o.height,w=o.isAnimationActive,x=o.id;if(g||!u||!u.length)return null;var k=this.state.isAnimationFinished,P=u.length===1,F=Ne("recharts-line",y),M=v&&v.allowDataOverflow,$=A&&A.allowDataOverflow,I=M||$,L=me(x)?this.id:x,q=(r=ae(c,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},B=q.r,R=B===void 0?3:B,W=q.strokeWidth,C=W===void 0?2:W,X=nt(c)?c:{},z=X.clipDot,U=z===void 0?!0:z,_=R*2+C;return O.createElement(ge,{className:F},M||$?O.createElement("defs",null,O.createElement("clipPath",{id:"clipPath-".concat(L)},O.createElement("rect",{x:M?f:f-S/2,y:$?N:N-m/2,width:M?S:S*2,height:$?m:m*2})),!U&&O.createElement("clipPath",{id:"clipPath-dots-".concat(L)},O.createElement("rect",{x:f-_/2,y:N-_/2,width:S+_,height:m+_}))):null,!P&&this.renderCurve(I,L),this.renderErrorBar(I,L),(P||c)&&this.renderDots(I,U,L),(!w||k)&&st.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(r,o){return r.animationId!==o.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:o.curPoints}:r.points!==o.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,o){for(var g=r.length%2!==0?[].concat(J(r),[0]):r,c=[],u=0;u<o;++u)c=[].concat(J(c),J(g));return c}},{key:"renderDotItem",value:function(r,o){var g;if(O.isValidElement(r))g=O.cloneElement(r,o);else if(Ye(r))g=r(o);else{var c=o.key,u=Pe(o,yt),y=Ne("recharts-line-dot",typeof r!="boolean"?r.className:"");g=O.createElement(Qe,Z({key:c},u,{className:y}))}return g}}])}(j.PureComponent);E(ee,"displayName","Line");E(ee,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ot.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});E(ee,"getComposedData",function(a){var n=a.props,s=a.xAxis,r=a.yAxis,o=a.xAxisTicks,g=a.yAxisTicks,c=a.dataKey,u=a.bandSize,y=a.displayedData,v=a.offset,A=n.layout,N=y.map(function(f,S){var m=Te(f,c);return A==="horizontal"?{x:Se({axis:s,ticks:o,bandSize:u,entry:f,index:S}),y:me(m)?null:r.scale(m),value:m,payload:f}:{x:me(m)?null:s.scale(m),y:Se({axis:r,ticks:g,bandSize:u,entry:f,index:S}),value:m,payload:f}});return T({points:N,layout:A},v)});var Ot=lt({chartName:"LineChart",GraphicalChild:ee,axisComponents:[{axisType:"xAxis",AxisComp:ne},{axisType:"yAxis",AxisComp:se}],formatAxisMap:dt});const Pt=["順張り","逆張り","材料/決算","デイトレ","スイング","長期/配当","優待","IPO","その他"],$t=[{id:"calm",label:"冷静",color:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300"},{id:"excited",label:"興奮",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300"},{id:"anxious",label:"不安",color:"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300"},{id:"angry",label:"怒り",color:"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"},{id:"fear",label:"恐怖",color:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}],Lt=({symbol:a})=>{const n=j.useRef(null);return j.useEffect(()=>{if(!n.current)return;n.current.innerHTML="";const s=document.createElement("div");s.className="tradingview-widget-container__widget",s.style.height="100%",s.style.width="100%",n.current.appendChild(s);const r=document.createElement("script");r.src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js",r.type="text/javascript",r.async=!0,r.innerHTML=JSON.stringify({autosize:!0,symbol:a,interval:"D",timezone:"Asia/Tokyo",theme:document.documentElement.classList.contains("dark")?"dark":"light",style:"1",locale:"ja",enable_publishing:!1,allow_symbol_change:!0,calendar:!1,support_host:"https://www.tradingview.com"}),n.current.appendChild(r)},[a]),e.jsx("div",{className:"tradingview-widget-container h-full w-full rounded-2xl overflow-hidden shadow-sm border border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900",ref:n,style:{height:"100%"}})},Gt=()=>{const a=j.useContext(He),[n,s]=j.useState("dashboard"),[r,o]=j.useState([]),[g,c]=j.useState(1e6),[u,y]=j.useState(!1),[v,A]=j.useState("TSE:7203"),[N,f]=j.useState(!1),[S,m]=j.useState(!1),w=j.useRef(null),[x,k]=j.useState({date:new Date().toISOString().split("T")[0],type:"sell",emotion:"calm",strategy:"順張り",quantity:100,pnl:0});j.useEffect(()=>{const t=localStorage.getItem("stock_trades"),l=localStorage.getItem("stock_initial_asset");if(t)try{const i=JSON.parse(t);if(Array.isArray(i)){const d=i.map(p=>({...p,price:Number(p.price)||0,quantity:Number(p.quantity)||0,pnl:Number(p.pnl)||0,date:p.date||new Date().toISOString().split("T")[0]}));o(d)}else o([])}catch(i){console.error("Failed to parse trades",i),o([])}else o([{id:"1",date:"2023-10-01",ticker:"7203",name:"トヨタ",type:"buy",price:2e3,quantity:100,pnl:0,comment:"エントリー",strategy:"順張り",emotion:"calm"},{id:"2",date:"2023-10-05",ticker:"7203",name:"トヨタ",type:"sell",price:2150,quantity:100,pnl:15e3,comment:"利確",strategy:"順張り",emotion:"excited"}]);l&&!isNaN(Number(l))&&c(Number(l)),y(!0)},[]),j.useEffect(()=>{u&&localStorage.setItem("stock_trades",JSON.stringify(r))},[r,u]),j.useEffect(()=>{u&&localStorage.setItem("stock_initial_asset",g.toString())},[g,u]);const P=new Date().toISOString().slice(0,7),F=r.reduce((t,l)=>t+(Number(l.pnl)||0),0),M=g+F,$=j.useMemo(()=>r.filter(t=>t.date&&t.date.startsWith(P)).reduce((t,l)=>t+(Number(l.pnl)||0),0),[r,P]),I=r.filter(t=>t.type==="sell"&&t.pnl!==0),L=I.filter(t=>t.pnl>0),q=I.filter(t=>t.pnl<0),B=I.length>0?L.length/I.length*100:0,R=L.reduce((t,l)=>t+l.pnl,0),W=Math.abs(q.reduce((t,l)=>t+l.pnl,0)),C=W===0?R>0?99.99:0:R/W,X=L.length>0?R/L.length:0,z=j.useMemo(()=>{const t=new Map,l=[...r].sort((i,d)=>new Date(i.date).getTime()-new Date(d.date).getTime());for(const i of l){if(!i.ticker)continue;const d=t.get(i.ticker)||{name:i.name||i.ticker,quantity:0,totalCost:0};if(i.type==="buy")d.quantity+=i.quantity,d.totalCost+=i.price*i.quantity;else if(i.type==="sell"){const p=d.quantity>0?d.totalCost/d.quantity:0;d.quantity-=i.quantity,d.totalCost-=p*i.quantity}d.quantity<1e-4?t.delete(i.ticker):t.set(i.ticker,d)}return Array.from(t.entries()).map(([i,d])=>({...d,ticker:i,avgPrice:d.quantity>0?d.totalCost/d.quantity:0}))},[r]),U=j.useMemo(()=>{const t=[...r].sort((h,b)=>new Date(h.date).getTime()-new Date(b.date).getTime()),l=new Map,i=new Date().toISOString().split("T")[0];let d=g;if(t.length===0)l.set(i,g);else{const h=t[0].date;if(h){const b=new Date(h);isNaN(b.getTime())||(b.setDate(b.getDate()-1),l.set(b.toISOString().split("T")[0],g))}}for(const h of t)h.date&&(d+=Number(h.pnl)||0,l.set(h.date,d));const p=Array.from(l.entries()).sort((h,b)=>new Date(h[0]).getTime()-new Date(b[0]).getTime()).map(([h,b])=>({date:h,asset:b})).filter(h=>!isNaN(h.asset));return p.length>0?p:[{date:i,asset:g}]},[r,g]),_=j.useMemo(()=>{const t={};r.forEach(i=>{if(!i.date)return;const d=i.date.slice(0,7);t[d]=(t[d]||0)+(Number(i.pnl)||0)});const l=Object.entries(t).sort().map(([i,d])=>({date:i,pnl:d}));return l.length>0?l:[{date:P,pnl:0}]},[r]),te=j.useMemo(()=>{const t={};return r.forEach(l=>{const i=l.strategy||"その他";t[i]=(t[i]||0)+(Number(l.pnl)||0)}),Object.entries(t).sort((l,i)=>i[1]-l[1]).map(([l,i])=>({name:l,value:i}))},[r]),oe=()=>{const t=`ID,日付,銘柄コード,銘柄名,売買区分,価格,株数,損益,戦略,感情,コメント
`,l=r.map(h=>`"${h.id}","${h.date}","${h.ticker}","${h.name}","${h.type}",${h.price},${h.quantity},${h.pnl},"${h.strategy}","${h.emotion}","${h.comment}"`).join(`
`),i=new Blob([new Uint8Array([239,187,191]),t+l],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(i),p=document.createElement("a");p.href=d,p.download=`trade_history_${new Date().toISOString().split("T")[0]}.csv`,p.click(),URL.revokeObjectURL(d)},le=()=>{confirm("全ての取引データを削除しますか？この操作は取り消せません。")&&(o([]),c(1e6),alert("データを初期化しました。"))},Ie=()=>{const t={initialAsset:g,trades:r},l=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(l),d=document.createElement("a");d.href=i,d.download=`stock_tracker_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(i)},Re=t=>{var d;const l=(d=t.target.files)==null?void 0:d[0];if(!l)return;const i=new FileReader;i.onload=p=>{var h;try{const b=JSON.parse((h=p.target)==null?void 0:h.result);b.trades&&Array.isArray(b.trades)?confirm("現在のデータを上書きして復元しますか？")&&(o(b.trades),typeof b.initialAsset=="number"&&c(b.initialAsset),alert("復元が完了しました。"),m(!1)):alert("無効なデータ形式です。")}catch{alert("ファイルの読み込みに失敗しました。")}w.current&&(w.current.value="")},i.readAsText(l)},Me=()=>{if(!x.date){alert("日付は必須です");return}const t={id:Date.now().toString(),date:x.date,ticker:x.ticker||"",name:x.name||x.ticker||"取引",type:x.type||"sell",price:Number(x.price)||0,quantity:Number(x.quantity)||0,pnl:Number(x.pnl)||0,comment:x.comment||"",strategy:x.strategy||"その他",emotion:x.emotion||"calm"};o(l=>[...l,t]),f(!1),k({date:new Date().toISOString().split("T")[0],type:"sell",emotion:"calm",strategy:"順張り",quantity:100,pnl:0,name:"",ticker:"",comment:"",price:0})},ze=t=>{confirm("この記録を削除しますか？")&&o(r.filter(l=>l.id!==t))},re=({title:t,value:l,sub:i,colorClass:d})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase",children:t}),e.jsx("div",{className:`text-2xl font-black mt-1 ${d||"text-gray-800 dark:text-white"}`,children:l}),i&&e.jsx("span",{className:"text-[10px] text-gray-400 mt-1",children:i})]}),Fe=()=>{const t=new Date,l=[];for(let i=89;i>=0;i--){const d=new Date;d.setDate(t.getDate()-i),l.push(d.toISOString().split("T")[0])}return e.jsx("div",{className:"flex flex-wrap gap-1",children:l.map(i=>{const p=r.filter(b=>b.date===i&&b.pnl!==0).reduce((b,de)=>b+de.pnl,0);let h="bg-gray-100 dark:bg-gray-700";return p>5e4?h="bg-red-500":p>1e4?h="bg-red-400":p>0?h="bg-red-300":p<-5e4?h="bg-emerald-600":p<-1e4?h="bg-emerald-500":p<0&&(h="bg-emerald-400"),e.jsx("div",{className:`w-3 h-3 rounded-sm ${h}`,title:`${i}: ${p.toLocaleString()}円`},i)})})},qe=()=>{const[t,l]=j.useState(new Date),i=t.getFullYear(),d=t.getMonth(),p=new Date(i,d,1).getDay(),h=new Date(i,d+1,0).getDate(),b=[];for(let D=0;D<p;D++)b.push(null);for(let D=1;D<=h;D++)b.push(D);const de=`${i}-${String(d+1).padStart(2,"0")}`,ce=r.filter(D=>D.date&&D.date.startsWith(de)).reduce((D,K)=>D+Number(K.pnl),0);return e.jsxs("div",{className:"animate-fade-in bg-white dark:bg-gray-800 p-4 md:p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"font-bold text-lg md:text-xl text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(je,{className:"text-indigo-500"}),i,"年",d+1,"月",e.jsxs("span",{className:`text-sm ml-2 font-mono ${ce>=0?"text-red-500":"text-emerald-500"}`,children:["(",ce>0?"+":"",ce.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l(new Date(i,d-1,1)),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300",children:e.jsx(Xe,{size:20})}),e.jsx("button",{onClick:()=>l(new Date),className:"text-xs font-bold px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300",children:"今月"}),e.jsx("button",{onClick:()=>l(new Date(i,d+1,1)),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300",children:e.jsx(ut,{size:20})})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 md:gap-2",children:[["日","月","火","水","木","金","土"].map((D,K)=>e.jsx("div",{className:`text-center text-xs font-bold py-2 ${K===0?"text-red-400":K===6?"text-blue-400":"text-gray-400"}`,children:D},D)),b.map((D,K)=>{if(!D)return e.jsx("div",{className:"h-16 md:h-24 bg-transparent"},K);const be=`${i}-${String(d+1).padStart(2,"0")}-${String(D).padStart(2,"0")}`,Y=r.filter(G=>G.date===be),V=Y.reduce((G,We)=>G+We.pnl,0),Be=new Date().toISOString().slice(0,10)===be;return e.jsxs("div",{className:`h-16 md:h-24 p-1 md:p-2 border rounded-xl flex flex-col justify-between transition-all hover:shadow-md ${Y.length>0?"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600":"bg-transparent border-transparent"} ${Be?"ring-2 ring-indigo-500":""}`,children:[e.jsx("span",{className:"text-[10px] md:text-xs font-bold text-gray-500 dark:text-gray-400",children:D}),Y.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-right font-black text-[10px] md:text-sm ${V>0?"text-red-500":V<0?"text-emerald-500":"text-gray-400"}`,children:V!==0&&(V>0?"+":"")+(Math.abs(V)>=1e6?(V/1e4).toFixed(0)+"万":V.toLocaleString())}),e.jsxs("div",{className:"flex justify-end gap-0.5 md:gap-1 mt-1",children:[Y.some(G=>G.type==="buy")&&e.jsx("div",{className:"w-1 md:w-1.5 h-1 md:h-1.5 rounded-full bg-blue-400"}),Y.some(G=>G.type==="sell")&&e.jsx("div",{className:"w-1 md:w-1.5 h-1 md:h-1.5 rounded-full bg-red-400"})]})]})]},K)})]})]})};return e.jsxs("div",{className:`${a?"mx-auto h-full flex flex-col w-full p-2":"mx-auto max-w-6xl space-y-6 pb-20"}`,children:[!a&&e.jsxs("div",{className:"flex justify-between items-center shrink-0",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(fe,{className:"text-indigo-500"})," 株トレード記録"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>m(!0),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:"設定"})})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl overflow-x-auto no-scrollbar shrink-0",children:[{id:"dashboard",icon:ht,label:"ホーム"},{id:"market",icon:Ke,label:"マーケット"},{id:"history",icon:ke,label:"履歴"},{id:"calendar",icon:je,label:"カレンダー"},{id:"analytics",icon:we,label:"分析"}].map(t=>e.jsxs("button",{onClick:()=>s(t.id),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-xs sm:text-sm font-bold transition-all whitespace-nowrap ${n===t.id?"bg-white dark:bg-gray-700 text-indigo-600 dark:text-indigo-400 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[e.jsx(t.icon,{size:16}),t.label]},t.id))}),e.jsxs("div",{className:a?"flex-1 overflow-y-auto no-scrollbar":"",children:[n==="dashboard"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(re,{title:"総資産評価額",value:`¥${M.toLocaleString()}`,colorClass:"text-indigo-600 dark:text-indigo-400"}),e.jsx(re,{title:"今月の損益",value:`¥${($||0).toLocaleString()}`,colorClass:($||0)>=0?"text-red-500":"text-emerald-500"}),e.jsx(re,{title:"勝率",value:`${B.toFixed(1)}%`,sub:`${L.length}勝 ${q.length}敗`}),e.jsx(re,{title:"PF / リスクリワード",value:C.toFixed(2),sub:`Avg Win: ¥${Math.round(X).toLocaleString()}`})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(fe,{size:18})," 資産推移"]}),e.jsx(xe,{width:"100%",height:"100%",children:e.jsxs(Ot,{data:U,children:[e.jsx(he,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(ne,{dataKey:"date",tick:{fontSize:10},tickFormatter:t=>typeof t=="string"&&t.length>=5?t.slice(5):"",stroke:"#9ca3af"}),e.jsx(se,{tick:{fontSize:10},tickFormatter:t=>`${t/1e4}万`,width:40,domain:["auto","auto"],stroke:"#9ca3af"}),e.jsx(ue,{formatter:t=>`¥${t.toLocaleString()}`,contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)",backgroundColor:"rgba(255,255,255,0.9)",color:"#333"}}),e.jsx(ee,{type:"monotone",dataKey:"asset",stroke:"#4f46e5",strokeWidth:3,dot:!1,activeDot:{r:6}})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(we,{size:18})," 月次損益"]}),e.jsx(xe,{width:"100%",height:"100%",children:e.jsxs(Ce,{data:_,children:[e.jsx(he,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(ne,{dataKey:"date",tick:{fontSize:10},tickFormatter:t=>typeof t=="string"&&t.length>=5?t.slice(5):"",stroke:"#9ca3af"}),e.jsx(se,{tickFormatter:t=>`${t/1e4}万`,width:40,stroke:"#9ca3af"}),e.jsx(ue,{formatter:t=>`¥${t.toLocaleString()}`,cursor:{fill:"transparent"},contentStyle:{backgroundColor:"rgba(255,255,255,0.9)",borderRadius:"8px",color:"#333"}}),e.jsx(Ae,{dataKey:"pnl",children:_.map((t,l)=>e.jsx(De,{fill:t.pnl>=0?"#ef4444":"#10b981"},`cell-${l}`))})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(ke,{size:18})," アクティビティ"]}),e.jsx("div",{className:"mb-4",children:e.jsx(Fe,{})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase",children:"直近の取引"}),r.slice(-5).reverse().map(t=>e.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-gray-100 dark:border-gray-700 pb-2 last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs font-bold px-1.5 py-0.5 rounded mr-2 ${t.type==="buy"?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"}`,children:t.type==="buy"?"買":t.type==="sell"?"売":t.type}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:t.name})]}),e.jsx("div",{className:`font-bold ${t.pnl>0?"text-red-500":t.pnl<0?"text-emerald-500":"text-gray-400"}`,children:t.pnl!==0?(t.pnl>0?"+":"")+t.pnl.toLocaleString():"-"})]},t.id))]})]})]})]}),n==="market"&&e.jsx("div",{className:`flex flex-col animate-fade-in space-y-4 ${a?"h-full":"h-[80vh] min-h-[500px]"}`,children:e.jsx("div",{className:"flex-1 bg-white dark:bg-gray-800 rounded-3xl overflow-hidden shadow-sm border border-gray-100 dark:border-gray-700 relative",children:e.jsx(Lt,{symbol:v},v)})}),n==="history"&&e.jsxs("div",{className:`animate-fade-in bg-white dark:bg-gray-800 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col ${a?"h-full":"min-h-[500px]"}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-300",children:"取引履歴一覧"}),e.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs font-bold text-gray-600 dark:text-gray-300 transition-colors",children:[e.jsx(Oe,{size:14})," CSV出力"]})]}),e.jsx("div",{className:`overflow-x-auto ${a?"flex-1":""}`,children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400 font-bold sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 whitespace-nowrap",children:"日付"}),e.jsx("th",{className:"p-4 whitespace-nowrap",children:"銘柄"}),e.jsx("th",{className:"p-4 whitespace-nowrap",children:"売買"}),e.jsx("th",{className:"p-4 whitespace-nowrap text-right",children:"価格(円)"}),e.jsx("th",{className:"p-4 whitespace-nowrap text-right",children:"株数"}),e.jsx("th",{className:"p-4 whitespace-nowrap text-right",children:"損益"}),e.jsx("th",{className:"p-4 whitespace-nowrap",children:"戦略/感情"}),e.jsx("th",{className:"p-4 w-10"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[[...r].sort((t,l)=>new Date(l.date).getTime()-new Date(t.date).getTime()).map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"p-4 font-mono text-gray-600 dark:text-gray-400",children:t.date}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-bold text-gray-800 dark:text-white",children:t.name}),e.jsx("div",{className:"text-xs text-gray-400 font-mono",children:t.ticker})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${t.type==="buy"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":t.type==="sell"?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"bg-gray-100 text-gray-600"}`,children:t.type==="buy"?"買付":t.type==="sell"?"売却":t.type})}),e.jsx("td",{className:"p-4 text-right font-mono text-gray-700 dark:text-gray-300",children:t.price.toLocaleString()}),e.jsx("td",{className:"p-4 text-right font-mono text-gray-700 dark:text-gray-300",children:t.quantity.toLocaleString()}),e.jsx("td",{className:`p-4 text-right font-mono font-bold ${t.pnl>0?"text-red-500":t.pnl<0?"text-emerald-500":"text-gray-400"}`,children:t.pnl!==0?(t.pnl>0?"+":"")+t.pnl.toLocaleString():"-"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 px-2 py-0.5 rounded w-fit",children:t.strategy}),t.emotion&&e.jsx("span",{className:"text-[10px] text-gray-400",children:t.emotion})]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>ze(t.id),className:"text-gray-400 hover:text-red-500 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(ct,{size:16})})})]},t.id)),r.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"p-8 text-center text-gray-400",children:"取引データがありません"})})]})]})})]}),n==="calendar"&&e.jsx(qe,{}),n==="analytics"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4",children:"月別損益推移"}),e.jsx(xe,{width:"100%",height:"100%",children:e.jsxs(Ce,{data:_,children:[e.jsx(he,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(ne,{dataKey:"date",tick:{fontSize:10},tickFormatter:t=>typeof t=="string"&&t.length>=5?t.slice(5):"",stroke:"#9ca3af"}),e.jsx(se,{tickFormatter:t=>`${t/1e4}万`,width:40,stroke:"#9ca3af"}),e.jsx(ue,{formatter:t=>`¥${t.toLocaleString()}`,cursor:{fill:"transparent"},contentStyle:{backgroundColor:"rgba(255,255,255,0.9)",borderRadius:"8px",color:"#333"}}),e.jsx(Ae,{dataKey:"pnl",children:_.map((t,l)=>e.jsx(De,{fill:t.pnl>=0?"#ef4444":"#10b981"},`cell-${l}`))})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4",children:"戦略別パフォーマンス"}),e.jsx("div",{className:"h-full overflow-y-auto no-scrollbar pb-6",children:te.length>0?e.jsx("div",{className:"space-y-3",children:te.map((t,l)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 text-xs font-bold text-gray-600 dark:text-gray-400 truncate",children:t.name}),e.jsx("div",{className:"flex-1 h-2 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden flex",children:t.value>0?e.jsx("div",{className:"h-full bg-red-500",style:{width:`${Math.min(Math.abs(t.value)/5e4*100,100)}%`}}):e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${Math.min(Math.abs(t.value)/5e4*100,100)}%`}})}),e.jsxs("div",{className:`w-20 text-right text-xs font-bold ${t.value>=0?"text-red-500":"text-emerald-500"}`,children:[t.value>0?"+":"",t.value.toLocaleString()]})]},l))}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-sm",children:"データがありません"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(gt,{size:18})," 現在の保有銘柄 (履歴から推定)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400 font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"銘柄"}),e.jsx("th",{className:"p-3 text-right",children:"保有数"}),e.jsx("th",{className:"p-3 text-right",children:"平均取得単価"}),e.jsx("th",{className:"p-3 text-right",children:"推定投資額"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:z.length>0?z.map((t,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30",children:[e.jsxs("td",{className:"p-3 font-medium text-gray-800 dark:text-gray-200",children:[t.name," ",e.jsx("span",{className:"text-xs text-gray-400 ml-1",children:t.ticker})]}),e.jsx("td",{className:"p-3 text-right font-mono text-gray-700 dark:text-gray-300",children:t.quantity.toLocaleString()}),e.jsxs("td",{className:"p-3 text-right font-mono text-gray-700 dark:text-gray-300",children:["¥",Math.round(t.avgPrice).toLocaleString()]}),e.jsxs("td",{className:"p-3 text-right font-mono font-bold text-gray-800 dark:text-white",children:["¥",Math.round(t.avgPrice*t.quantity).toLocaleString()]})]},l)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-6 text-center text-gray-400",children:"保有なし"})})})]})})]})]})]}),e.jsx("button",{onClick:()=>f(!0),className:`${a?"absolute bottom-4 right-4 p-3 shadow-lg":"fixed bottom-8 right-8 p-5 shadow-2xl"} bg-indigo-600 text-white rounded-full hover:bg-indigo-700 hover:scale-105 transition-all z-20 flex items-center justify-center active:scale-95`,children:e.jsx(Ve,{size:a?20:32})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl w-full max-w-sm shadow-2xl border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white",children:"設定"}),e.jsx("button",{onClick:()=>m(!1),children:e.jsx(ve,{className:"text-gray-400"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-2",children:"初期資産 (円)"}),e.jsx("input",{type:"number",value:g,onChange:t=>c(Number(t.target.value)),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono font-bold focus:ring-2 focus:ring-indigo-500"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:"※ここに入力した金額をスタート地点として損益を加算します。"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsxs("button",{onClick:Ie,className:"py-2 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 text-xs font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Oe,{size:14})," バックアップ"]}),e.jsxs("label",{className:"py-2 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 text-xs font-bold rounded-lg transition-colors flex items-center justify-center gap-2 cursor-pointer",children:[e.jsx(xt,{size:14})," 復元 (読込)",e.jsx("input",{type:"file",accept:".json",onChange:Re,className:"hidden",ref:w})]})]}),e.jsx("div",{className:"pt-2",children:e.jsxs("button",{onClick:le,className:"w-full py-2 text-red-500 text-xs font-bold hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ge,{size:14})," 全データを初期化"]})}),e.jsx("button",{onClick:()=>m(!1),className:"w-full py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-colors",children:"完了"})]})]})}),N&&e.jsx("div",{className:`z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in ${a?"absolute inset-0":"fixed inset-0 bg-black/60"}`,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl w-full max-w-md p-6 shadow-2xl border border-gray-100 dark:border-gray-700 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-black text-gray-800 dark:text-white",children:"取引を記録"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ve,{})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex bg-gray-100 dark:bg-gray-700 p-1 rounded-xl",children:["buy","sell","deposit","withdraw"].map(t=>e.jsx("button",{onClick:()=>k({...x,type:t}),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${x.type===t?t==="buy"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-400 shadow":t==="sell"?"bg-white dark:bg-gray-600 text-red-600 dark:text-red-400 shadow":"bg-white dark:bg-gray-600 text-gray-800 dark:text-white shadow":"text-gray-500 dark:text-gray-400"}`,children:t==="buy"?"買付":t==="sell"?"売却":t==="deposit"?"入金":"出金"},t))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"日付"}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-indigo-500 outline-none",value:x.date,onChange:t=>k({...x,date:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"銘柄コード"}),e.jsx("input",{type:"text",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"7203",value:x.ticker,onChange:t=>k({...x,ticker:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"銘柄名 / 項目名"}),e.jsx("input",{type:"text",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"トヨタ自動車",value:x.name,onChange:t=>k({...x,name:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"約定価格"}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono font-bold focus:ring-2 focus:ring-indigo-500 outline-none",value:x.price,onChange:t=>k({...x,price:Number(t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"株数"}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono font-bold focus:ring-2 focus:ring-indigo-500 outline-none",value:x.quantity,onChange:t=>k({...x,quantity:Number(t.target.value)})})]})]}),x.type==="sell"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-xl border border-gray-100 dark:border-gray-700",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"確定損益 (円)"}),e.jsx("input",{type:"number",className:`w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 font-mono text-xl font-black focus:ring-2 focus:ring-indigo-500 outline-none ${Number(x.pnl)>=0?"text-red-500":"text-emerald-500"}`,placeholder:"例: 10000 or -5000",value:x.pnl,onChange:t=>k({...x,pnl:Number(t.target.value)})}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1 text-right",children:"※マイナスの場合は「-」をつけてください"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"戦略・タグ"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Pt.map(t=>e.jsx("button",{type:"button",onClick:()=>k({...x,strategy:t}),className:`px-3 py-1 rounded-full text-xs font-bold border transition-all ${x.strategy===t?"bg-indigo-100 dark:bg-indigo-900/50 border-indigo-500 text-indigo-700 dark:text-indigo-300":"border-gray-200 dark:border-gray-600 text-gray-500 dark:text-gray-400"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"感情コンディション"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-1",children:$t.map(t=>e.jsx("button",{type:"button",onClick:()=>k({...x,emotion:t.id}),className:`flex-1 min-w-[60px] py-1.5 rounded text-xs font-bold transition-all ${x.emotion===t.id?t.color+" shadow-sm ring-1 ring-inset ring-current":"bg-gray-100 dark:bg-gray-700 text-gray-400"}`,children:t.label},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"メモ"}),e.jsx("textarea",{className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm h-20 resize-none focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"エントリー根拠や反省点...",value:x.comment,onChange:t=>k({...x,comment:t.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-3 text-gray-500 dark:text-gray-400 text-sm font-bold hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",children:"キャンセル"}),e.jsx("button",{onClick:Me,className:"flex-1 py-3 bg-indigo-600 text-white text-sm font-bold rounded-xl hover:bg-indigo-700 shadow-xl shadow-indigo-200 dark:shadow-none transition-colors",children:"保存する"})]})]})}),!a&&e.jsx(Je,{})]})};export{Gt as default};
