import{c as W,R as j,r as f,j as e,S as it,X as me,a as Ee,C as lt}from"./index-ChtNSINi.js";import{T as he}from"./toolsData-CVxmn-rM.js";import{L as ot}from"./lock-DWljCr1s.js";import{L as Te}from"./loader-circle-Dl9XKQLb.js";import{G as ct}from"./globe-Dsvh14G_.js";import{C as dt}from"./cpu-CxFBXHdH.js";import{A as pt}from"./activity-DperSlWK.js";import{M as ze,S as xt}from"./send-B-9PZ0wl.js";import{f as ee,L as ie,m as de,i as ae,C as fe,A as ut,a as te,b as De,c as mt,d as Ie,e as Ue,h as ht,g as ft,u as bt,j as ge,G as gt,k as Re,l as $e,D as yt,n as vt,o as kt,R as jt,T as Nt}from"./generateCategoricalChart-DrG2-fIg.js";import{X as Xe,Y as He}from"./YAxis-BzI_gDGn.js";import{C as wt}from"./CartesianGrid-CgHRTqMX.js";import{C as _t}from"./chevron-right-DUPIDzZR.js";import{R as be}from"./refresh-cw-D7znC5LZ.js";import{S as At}from"./search-edFA_hk-.js";import{C as St}from"./clock-BXL1bWat.js";import{C as Ct}from"./circle-x-D5PpKp8y.js";import{T as Pt,a as Ot}from"./toggle-right-CK5NH_3T.js";import{K as Lt}from"./key-round-DhJTeTro.js";import{T as Mt}from"./triangle-alert-CM5bMjJV.js";import{S as Et}from"./settings-BzyB7WBv.js";import{D as Tt}from"./database-BVzuFX6T.js";import{D as zt}from"./download-CBzZf8ng.js";import{U as Dt}from"./upload-Bq8MLOZ8.js";import{L as It}from"./link-2-CNpkm3jH.js";import{T as Rt}from"./trash-2-3C2SbfDH.js";import"./trending-up-CXvOtZ6j.js";import"./layers-DW4gGn1i.js";import"./share-2-Dq7MIO_o.js";import"./monitor-BluIlTI8.js";import"./align-left-C28me_1b.js";import"./bath-UGb1ZVdf.js";import"./pipette-k0BT5_E9.js";import"./wallet-BRUx40Sg.js";import"./image-CpMdE97W.js";import"./file-type-CsvdzLKS.js";import"./network-DnQcSzm6.js";import"./binary-DA4wqyhu.js";import"./timer-DP15pNIN.js";import"./calculator-kobozUv8.js";import"./scale-BL4XZ6J6.js";import"./dices-B3lnko0N.js";import"./square-dashed-D3d5uPla.js";import"./fingerprint-BP7qYhRK.js";import"./type-1xqf6fQm.js";import"./disc-BAeUdmzf.js";import"./arrow-right-left-CT-8h-C6.js";import"./hash-BJYjQ1Fe.js";import"./list-todo-Byi38g2n.js";import"./code-Dn8PhhdT.js";import"./calendar-days-DrhKmBqg.js";import"./palette-DmUUV32e.js";import"./file-json-DKKoI6jo.js";import"./stamp-DlvJ6BtA.js";import"./image-off-D-tSES64.js";import"./file-diff-DdBfgWqN.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=W("AppWindow",[["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}],["path",{d:"M10 4v4",key:"pp8u80"}],["path",{d:"M2 8h20",key:"d11cs7"}],["path",{d:"M6 4v4",key:"1svtjw"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=W("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=W("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=W("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=W("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=W("Microchip",[["path",{d:"M18 12h2",key:"quuxs7"}],["path",{d:"M18 16h2",key:"zsn3lv"}],["path",{d:"M18 20h2",key:"9x5y9y"}],["path",{d:"M18 4h2",key:"1luxfb"}],["path",{d:"M18 8h2",key:"nxqzg"}],["path",{d:"M4 12h2",key:"1ltxp0"}],["path",{d:"M4 16h2",key:"8a5zha"}],["path",{d:"M4 20h2",key:"27dk57"}],["path",{d:"M4 4h2",key:"10groj"}],["path",{d:"M4 8h2",key:"18vq6w"}],["path",{d:"M8 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-1.5c-.276 0-.494.227-.562.495a2 2 0 0 1-3.876 0C9.994 2.227 9.776 2 9.5 2z",key:"1681fp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=W("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=W("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=W("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=W("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var Jt=["layout","type","stroke","connectNulls","isRange","ref"],Yt=["key"],Ke;function re(a){"@babel/helpers - typeof";return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},re(a)}function qe(a,r){if(a==null)return{};var s=Gt(a,r),n,l;if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(a);for(l=0;l<p.length;l++)n=p[l],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(a,n)&&(s[n]=a[n])}return s}function Gt(a,r){if(a==null)return{};var s={};for(var n in a)if(Object.prototype.hasOwnProperty.call(a,n)){if(r.indexOf(n)>=0)continue;s[n]=a[n]}return s}function G(){return G=Object.assign?Object.assign.bind():function(a){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(a[n]=s[n])}return a},G.apply(this,arguments)}function Be(a,r){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);r&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(a,l).enumerable})),s.push.apply(s,n)}return s}function K(a){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Be(Object(s),!0).forEach(function(n){V(a,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):Be(Object(s)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(s,n))})}return a}function Zt(a,r){if(!(a instanceof r))throw new TypeError("Cannot call a class as a function")}function Ve(a,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,Ye(n.key),n)}}function Qt(a,r,s){return r&&Ve(a.prototype,r),s&&Ve(a,s),Object.defineProperty(a,"prototype",{writable:!1}),a}function ea(a,r,s){return r=pe(r),ta(a,Je()?Reflect.construct(r,s||[],pe(a).constructor):r.apply(a,s))}function ta(a,r){if(r&&(re(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aa(a)}function aa(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Je(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Je=function(){return!!a})()}function pe(a){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},pe(a)}function ra(a,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(r&&r.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),r&&ye(a,r)}function ye(a,r){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,l){return n.__proto__=l,n},ye(a,r)}function V(a,r,s){return r=Ye(r),r in a?Object.defineProperty(a,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[r]=s,a}function Ye(a){var r=sa(a,"string");return re(r)=="symbol"?r:r+""}function sa(a,r){if(re(a)!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var n=s.call(a,r);if(re(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}var q=function(a){function r(){var s;Zt(this,r);for(var n=arguments.length,l=new Array(n),p=0;p<n;p++)l[p]=arguments[p];return s=ea(this,r,[].concat(l)),V(s,"state",{isAnimationFinished:!0}),V(s,"id",bt("recharts-area-")),V(s,"handleAnimationEnd",function(){var d=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),ge(d)&&d()}),V(s,"handleAnimationStart",function(){var d=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),ge(d)&&d()}),s}return ra(r,a),Qt(r,[{key:"renderDots",value:function(n,l,p){var d=this.props.isAnimationActive,u=this.state.isAnimationFinished;if(d&&!u)return null;var b=this.props,h=b.dot,m=b.points,g=b.dataKey,x=ee(this.props,!1),O=ee(h,!0),S=m.map(function(N,T){var P=K(K(K({key:"dot-".concat(T),r:3},x),O),{},{index:T,cx:N.x,cy:N.y,dataKey:g,value:N.value,payload:N.payload,points:m});return r.renderDotItem(h,P)}),L={clipPath:n?"url(#clipPath-".concat(l?"":"dots-").concat(p,")"):null};return j.createElement(ie,G({className:"recharts-area-dots"},L),S)}},{key:"renderHorizontalRect",value:function(n){var l=this.props,p=l.baseLine,d=l.points,u=l.strokeWidth,b=d[0].x,h=d[d.length-1].x,m=n*Math.abs(b-h),g=de(d.map(function(x){return x.y||0}));return ae(p)&&typeof p=="number"?g=Math.max(p,g):p&&Array.isArray(p)&&p.length&&(g=Math.max(de(p.map(function(x){return x.y||0})),g)),ae(g)?j.createElement("rect",{x:b<h?b:b-m,y:0,width:m,height:Math.floor(g+(u?parseInt("".concat(u),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var l=this.props,p=l.baseLine,d=l.points,u=l.strokeWidth,b=d[0].y,h=d[d.length-1].y,m=n*Math.abs(b-h),g=de(d.map(function(x){return x.x||0}));return ae(p)&&typeof p=="number"?g=Math.max(p,g):p&&Array.isArray(p)&&p.length&&(g=Math.max(de(p.map(function(x){return x.x||0})),g)),ae(g)?j.createElement("rect",{x:0,y:b<h?b:b-m,width:g+(u?parseInt("".concat(u),10):1),height:Math.floor(m)}):null}},{key:"renderClipRect",value:function(n){var l=this.props.layout;return l==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,l,p,d){var u=this.props,b=u.layout,h=u.type,m=u.stroke,g=u.connectNulls,x=u.isRange;u.ref;var O=qe(u,Jt);return j.createElement(ie,{clipPath:p?"url(#clipPath-".concat(d,")"):null},j.createElement(fe,G({},ee(O,!0),{points:n,connectNulls:g,type:h,baseLine:l,layout:b,stroke:"none",className:"recharts-area-area"})),m!=="none"&&j.createElement(fe,G({},ee(this.props,!1),{className:"recharts-area-curve",layout:b,type:h,connectNulls:g,fill:"none",points:n})),m!=="none"&&x&&j.createElement(fe,G({},ee(this.props,!1),{className:"recharts-area-curve",layout:b,type:h,connectNulls:g,fill:"none",points:l})))}},{key:"renderAreaWithAnimation",value:function(n,l){var p=this,d=this.props,u=d.points,b=d.baseLine,h=d.isAnimationActive,m=d.animationBegin,g=d.animationDuration,x=d.animationEasing,O=d.animationId,S=this.state,L=S.prevPoints,N=S.prevBaseLine;return j.createElement(ut,{begin:m,duration:g,isActive:h,easing:x,from:{t:0},to:{t:1},key:"area-".concat(O),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(T){var P=T.t;if(L){var M=L.length/u.length,v=u.map(function(C,z){var I=Math.floor(z*M);if(L[I]){var R=L[I],X=te(R.x,C.x),$=te(R.y,C.y);return K(K({},C),{},{x:X(P),y:$(P)})}return C}),k;if(ae(b)&&typeof b=="number"){var w=te(N,b);k=w(P)}else if(De(b)||mt(b)){var _=te(N,0);k=_(P)}else k=b.map(function(C,z){var I=Math.floor(z*M);if(N[I]){var R=N[I],X=te(R.x,C.x),$=te(R.y,C.y);return K(K({},C),{},{x:X(P),y:$(P)})}return C});return p.renderAreaStatically(v,k,n,l)}return j.createElement(ie,null,j.createElement("defs",null,j.createElement("clipPath",{id:"animationClipPath-".concat(l)},p.renderClipRect(P))),j.createElement(ie,{clipPath:"url(#animationClipPath-".concat(l,")")},p.renderAreaStatically(u,b,n,l)))})}},{key:"renderArea",value:function(n,l){var p=this.props,d=p.points,u=p.baseLine,b=p.isAnimationActive,h=this.state,m=h.prevPoints,g=h.prevBaseLine,x=h.totalLength;return b&&d&&d.length&&(!m&&x>0||!Ie(m,d)||!Ie(g,u))?this.renderAreaWithAnimation(n,l):this.renderAreaStatically(d,u,n,l)}},{key:"render",value:function(){var n,l=this.props,p=l.hide,d=l.dot,u=l.points,b=l.className,h=l.top,m=l.left,g=l.xAxis,x=l.yAxis,O=l.width,S=l.height,L=l.isAnimationActive,N=l.id;if(p||!u||!u.length)return null;var T=this.state.isAnimationFinished,P=u.length===1,M=Ue("recharts-area",b),v=g&&g.allowDataOverflow,k=x&&x.allowDataOverflow,w=v||k,_=De(N)?this.id:N,C=(n=ee(d,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},z=C.r,I=z===void 0?3:z,R=C.strokeWidth,X=R===void 0?2:R,$=ht(d)?d:{},Z=$.clipDot,F=Z===void 0?!0:Z,U=I*2+X;return j.createElement(ie,{className:M},v||k?j.createElement("defs",null,j.createElement("clipPath",{id:"clipPath-".concat(_)},j.createElement("rect",{x:v?m:m-O/2,y:k?h:h-S/2,width:v?O:O*2,height:k?S:S*2})),!F&&j.createElement("clipPath",{id:"clipPath-dots-".concat(_)},j.createElement("rect",{x:m-U/2,y:h-U/2,width:O+U,height:S+U}))):null,P?null:this.renderArea(w,_),(d||P)&&this.renderDots(w,F,_),(!L||T)&&ft.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(n,l){return n.animationId!==l.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:l.curPoints,prevBaseLine:l.curBaseLine}:n.points!==l.curPoints||n.baseLine!==l.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(f.PureComponent);Ke=q;V(q,"displayName","Area");V(q,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!gt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});V(q,"getBaseValue",function(a,r,s,n){var l=a.layout,p=a.baseValue,d=r.props.baseValue,u=d??p;if(ae(u)&&typeof u=="number")return u;var b=l==="horizontal"?n:s,h=b.scale.domain();if(b.type==="number"){var m=Math.max(h[0],h[1]),g=Math.min(h[0],h[1]);return u==="dataMin"?g:u==="dataMax"||m<0?m:Math.max(Math.min(h[0],h[1]),0)}return u==="dataMin"?h[0]:u==="dataMax"?h[1]:h[0]});V(q,"getComposedData",function(a){var r=a.props,s=a.item,n=a.xAxis,l=a.yAxis,p=a.xAxisTicks,d=a.yAxisTicks,u=a.bandSize,b=a.dataKey,h=a.stackedData,m=a.dataStartIndex,g=a.displayedData,x=a.offset,O=r.layout,S=h&&h.length,L=Ke.getBaseValue(r,s,n,l),N=O==="horizontal",T=!1,P=g.map(function(v,k){var w;S?w=h[m+k]:(w=Re(v,b),Array.isArray(w)?T=!0:w=[L,w]);var _=w[1]==null||S&&Re(v,b)==null;return N?{x:$e({axis:n,ticks:p,bandSize:u,entry:v,index:k}),y:_?null:l.scale(w[1]),value:w,payload:v}:{x:_?null:n.scale(w[1]),y:$e({axis:l,ticks:d,bandSize:u,entry:v,index:k}),value:w,payload:v}}),M;return S||T?M=P.map(function(v){var k=Array.isArray(v.value)?v.value[0]:null;return N?{x:v.x,y:k!=null&&v.y!=null?l.scale(k):null}:{x:k!=null?n.scale(k):null,y:v.y}}):M=N?l.scale(L):n.scale(L),K({points:P,baseLine:M,layout:O,isRange:T},x)});V(q,"renderDotItem",function(a,r){var s;if(j.isValidElement(a))s=j.cloneElement(a,r);else if(ge(a))s=a(r);else{var n=Ue("recharts-area-dot",typeof a!="boolean"?a.className:""),l=r.key,p=qe(r,Yt);s=j.createElement(yt,G({},p,{key:l,className:n}))}return s});var na=vt({chartName:"AreaChart",GraphicalChild:q,axisComponents:[{axisType:"xAxis",AxisComp:Xe},{axisType:"yAxis",AxisComp:He}],formatAxisMap:kt});const le="/secure-panel-7x9v2",We=[35.6895,139.6917],Fe=()=>new Promise(a=>{if(window.L){a(window.L);return}const r=document.createElement("link");r.rel="stylesheet",r.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(r);const s=document.createElement("script");s.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",s.onload=()=>a(window.L),document.head.appendChild(s)}),lr=()=>{const[a,r]=f.useState(sessionStorage.getItem("admin_token")),[s,n]=f.useState("dashboard"),[l,p]=f.useState(""),[d,u]=f.useState(""),[b,h]=f.useState(!1),[m,g]=f.useState({total_pv:0,today_pv:0,recent_logs:[]}),[x,O]=f.useState(null),[S,L]=f.useState([]),[N,T]=f.useState({}),[P,M]=f.useState(!1),[v,k]=f.useState(!1),w=f.useRef(null),_=f.useRef(null),C=f.useRef([]),z=f.useRef([]),[I,R]=f.useState({}),X=f.useRef(new Set),[$,Z]=f.useState(""),[F,U]=f.useState(""),[oe,xe]=f.useState(""),[J,ve]=f.useState(()=>{const t=localStorage.getItem("admin_monitored_apps");return t?JSON.parse(t):["qrcode","kakeibo","bath"]}),[ke,Ge]=f.useState([]);f.useEffect(()=>{localStorage.setItem("admin_monitored_apps",JSON.stringify(J))},[J]);const[y,D]=f.useState({smtp_host:"",smtp_port:587,smtp_user:"",smtp_pass:"",alert_email:"",dos_patterns:[{count:30,seconds:30,block_minutes:15}],dos_notify_enabled:!0}),[je,se]=f.useState(""),[ne,E]=f.useState(!1),[Q,Ne]=f.useState(""),[we,_e]=f.useState(""),[Ae,Se]=f.useState(!1),Ce=f.useRef(null);f.useEffect(()=>{let t=!0;return(async()=>{if(s!=="dashboard"||!w.current)return;const o=await Fe();if(t&&(await new Promise(c=>setTimeout(c,100)),!!w.current)){_.current&&(_.current.remove(),_.current=null,C.current=[],z.current=[]);try{const c=o.map(w.current,{scrollWheelZoom:!0,attributionControl:!1,zoomControl:!0}).setView([36,138],2);o.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{maxZoom:19,noWrap:!0}).addTo(c);const A=o.divIcon({className:"server-icon",html:'<div style="background-color: #ef4444; width: 14px; height: 14px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 15px #ef4444;"></div>',iconSize:[14,14],iconAnchor:[7,7]});o.marker(We,{icon:A,zIndexOffset:1e3}).addTo(c).bindPopup('<div class="font-bold text-center">OMNITOOLS SERVER<br><span class="text-xs text-gray-400">Tokyo, JP</span></div>'),_.current=c}catch(c){console.error("Map init failed",c)}}})(),()=>{t=!1,_.current&&(_.current.remove(),_.current=null,C.current=[],z.current=[])}},[s]),f.useEffect(()=>{if(!m.recent_logs.length)return;Array.from(new Set(m.recent_logs.map(i=>i.ip))).slice(0,30).forEach(i=>{i.startsWith("192.168.")||i.startsWith("127.")||i.startsWith("10.")||i==="::1"||!I[i]&&!X.current.has(i)&&(X.current.add(i),setTimeout(()=>{fetch(`https://ipwho.is/${i}`).then(o=>o.json()).then(o=>{o.success&&R(c=>({...c,[i]:{lat:o.latitude,lon:o.longitude,city:o.city,country:o.country_code}}))}).catch(()=>{})},Math.random()*2e3))})},[m.recent_logs]),f.useEffect(()=>{s==="dashboard"&&(async()=>{const i=await Fe();if(!_.current||!i)return;C.current.forEach(c=>c.remove()),z.current.forEach(c=>c.remove()),C.current=[],z.current=[];const o=Array.from(new Set(m.recent_logs.map(c=>c.ip))).slice(0,30);for(const c of o){const A=I[c];if(A){const B=i.divIcon({className:"custom-div-icon",html:'<div style="background-color: #3b82f6; width: 8px; height: 8px; border-radius: 50%; border: 1px solid white; box-shadow: 0 0 8px #3b82f6;"></div>',iconSize:[8,8],iconAnchor:[4,4]}),H=i.marker([A.lat,A.lon],{icon:B}).addTo(_.current);H.bindPopup(`<b>${c}</b><br>${A.city}, ${A.country}`),C.current.push(H);const st=[[A.lat,A.lon],We],nt=i.polyline(st,{color:"#3b82f6",weight:1,opacity:.4,className:"access-line"}).addTo(_.current);z.current.push(nt)}}})()},[I,m.recent_logs,s]);const Ze=f.useMemo(()=>{const t={},i=new Date;for(let o=23;o>=0;o--){const c=new Date(i.getTime()-o*36e5);t[`${c.getHours()}:00`]=0}return m.recent_logs.forEach(o=>{const c=new Date(o.timestamp*1e3);if(isNaN(c.getTime()))return;const A=`${c.getHours()}:00`;t[A]!==void 0&&t[A]++}),Object.entries(t).map(([o,c])=>({name:o,pv:c}))},[m.recent_logs]),Pe=f.useMemo(()=>{const t={};return m.recent_logs.forEach(i=>{const o=he.find(c=>c.path===i.path);o&&(t[o.id]=(t[o.id]||0)+1)}),t},[m.recent_logs]),Oe=f.useMemo(()=>m.recent_logs.filter(t=>{const i=!$||t.ip.includes($),o=!F||t.path.toLowerCase().includes(F.toLowerCase()),c=!oe||t.date.includes(oe);return i&&o&&c}),[m.recent_logs,$,F,oe]),Y=async(t=!1)=>{if(a){t&&M(!0),t||k(!0);try{const i=await fetch("./backend/admin_api.php?action=fetch_dashboard",{headers:{"X-Admin-Token":a}});if(i.ok){const o=await i.json();g(o.stats||{total_pv:0,today_pv:0,recent_logs:[]}),L(o.messages||[]),T(o.blocked_ips||{}),O(o.server_resources||null),t&&o.config&&(D(c=>({...c,...o.config,smtp_pass:"",dos_patterns:o.config.dos_patterns||[{count:30,seconds:30,block_minutes:15}]})),E(!1))}else i.status===403&&Me()}catch(i){console.error(i)}finally{M(!1),k(!1)}}},ue=async()=>{if(a){M(!0);try{const i=await(await fetch("./backend/admin_api.php?action=fetch_url_bundles",{headers:{"X-Admin-Token":a}})).json();i.status==="ok"&&Ge(i.data)}catch(t){console.error(t)}finally{M(!1)}}};f.useEffect(()=>{s==="apps"&&ue()},[s]);const Qe=async t=>{if(confirm("このまとめURLを削除しますか？"))try{await fetch("./backend/admin_api.php?action=delete_url_bundle",{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Token":a||""},body:JSON.stringify({id:t})}),ue()}catch{alert("削除失敗")}},Le=async t=>{if(a){if(Q&&Q!==we){alert("新しいパスワードが一致しません。");return}se("保存中...");try{(await fetch("./backend/admin_api.php?action=update_settings",{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Token":a},body:JSON.stringify({...y,new_password:Q||void 0})})).ok?(se("設定を保存しました。"),E(!1),Ne(""),_e(""),setTimeout(()=>se(""),3e3),Y(!1)):se("保存に失敗しました。")}catch{se("エラーが発生しました。")}}},et=async()=>{if(a){Se(!0);try{const i=await(await fetch("./backend/admin_api.php?action=test_email",{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Token":a},body:JSON.stringify(y)})).json();alert(i.status==="成功"?"テストメールを送信しました。":`失敗: ${i.error}`)}catch{alert("通信エラー")}finally{Se(!1)}}},tt=async t=>{if(confirm(`${t} の遮断を解除しますか？`))try{(await fetch("./backend/admin_api.php?action=unblock_ip",{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Token":a||""},body:JSON.stringify({ip:t})})).ok&&Y(!1)}catch{alert("解除失敗")}},at=async t=>{t.preventDefault(),h(!0),u("");try{const i=await fetch("./backend/admin_api.php?action=login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:l})});if(i.ok){const o=await i.json();r(o.token),sessionStorage.setItem("admin_token",o.token)}else{const o=await i.json();u(o.error||"ログイン失敗")}}catch{u("通信エラー")}finally{h(!1)}},Me=()=>{r(null),sessionStorage.removeItem("admin_token")},rt=t=>{U(t),Z(""),xe(""),n("logs")},ce=t=>{if(t===0)return"0 B";const i=1024,o=["B","KB","MB","GB","TB"],c=Math.log(t)/Math.log(i);if(isNaN(c)||!isFinite(c))return"0 B";const A=Math.floor(c);return parseFloat((t/Math.pow(i,A)).toFixed(1))+" "+o[A]};return f.useEffect(()=>{if(a){Y(!0);const t=setInterval(()=>Y(!1),3e3);return()=>clearInterval(t)}},[a]),a?e.jsxs("div",{className:"min-h-screen bg-[#f8f9fc] dark:bg-dark text-slate-800 dark:text-gray-100 flex flex-col fixed inset-0 z-[150] overflow-hidden",children:[e.jsxs("header",{className:"bg-slate-900 text-white border-b border-white/10 h-16 flex items-center justify-between px-6 shrink-0 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-red-600 p-1.5 rounded-lg",children:e.jsx(Kt,{size:20})}),e.jsxs("h1",{className:"text-lg font-black tracking-tight",children:["管理コンソール ",e.jsx("span",{className:"text-[10px] bg-white/20 px-2 py-0.5 rounded-full font-mono",children:"v2.8.0"})]})]}),e.jsx("div",{className:"flex bg-white/10 backdrop-blur-md p-1 rounded-xl overflow-x-auto no-scrollbar",children:[{id:"dashboard",label:"統計"},{id:"logs",label:"ログ"},{id:"messages",label:"受信箱"},{id:"security",label:"IP・DOS制限"},{id:"settings",label:"設定・メンテ"},{id:"apps",label:"アプリ管理"}].map(t=>e.jsx("button",{onClick:()=>n(t.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all whitespace-nowrap ${s===t.id?"bg-white text-slate-900 shadow-lg":"text-gray-400 hover:text-white"}`,children:t.label},t.id))}),e.jsx("button",{onClick:Me,className:"p-2 text-gray-400 hover:text-red-400 transition-colors",children:e.jsx(Ft,{size:20})})]}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 sm:p-6 md:p-10 space-y-8 no-scrollbar bg-slate-50 dark:bg-dark",children:[s==="dashboard"&&e.jsxs("div",{className:"space-y-10 animate-fade-in max-w-7xl mx-auto w-full pb-20",children:[e.jsxs("div",{className:"bg-slate-900 rounded-[2.5rem] shadow-xl border border-slate-700 overflow-hidden relative group",children:[e.jsxs("div",{className:"absolute top-6 left-6 z-10 bg-slate-800/80 backdrop-blur px-4 py-2 rounded-xl border border-white/10",children:[e.jsxs("h3",{className:"text-white font-black text-sm flex items-center gap-2",children:[e.jsx(ct,{size:16,className:"text-blue-400"})," アクセスMAP"]}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold",children:"直近のアクセス元を表示"})]}),e.jsx("div",{ref:w,className:"w-full h-[350px] bg-[#0a1128] z-0"}),e.jsx("style",{children:`
                    .leaflet-container { background: #0a1128 !important; } 
                    .leaflet-popup-content-wrapper { background: rgba(15, 23, 42, 0.9); color: white; border-radius: 8px; font-size: 10px; } 
                    .leaflet-popup-tip { background: rgba(15, 23, 42, 0.9); }
                    .leaflet-control-zoom-in, .leaflet-control-zoom-out {
                      background-color: rgba(15, 23, 42, 0.8) !important;
                      color: white !important;
                      border: 1px solid rgba(255, 255, 255, 0.2) !important;
                    }
                    @keyframes dash {
                      to { stroke-dashoffset: -20; }
                    }
                    .access-line {
                      stroke-dasharray: 5, 10;
                      animation: dash 1s linear infinite;
                    }
                 `})]}),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-black",children:"サーバー状態"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 px-2 py-0.5 rounded-full",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),"REAL-TIME"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{label:"CPU負荷",val:(x==null?void 0:x.cpu)??0,icon:dt,color:"text-amber-500",sub:"直近1分間",percent:Math.min(Math.round((x==null?void 0:x.cpu)??0),100)},{label:"メモリ使用率",val:(x==null?void 0:x.mem.percent)??0,icon:Ut,color:"text-blue-500",sub:x?`${ce(x.mem.used)} / ${ce(x.mem.total)}`:"--",percent:(x==null?void 0:x.mem.percent)??0},{label:"ディスク使用率",val:(x==null?void 0:x.disk.percent)??0,icon:Wt,color:"text-purple-500",sub:x?`${ce(x.disk.used)} / ${ce(x.disk.total)}`:"--",percent:(x==null?void 0:x.disk.percent)??0}].map((t,i)=>e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`${t.color} bg-gray-50 dark:bg-gray-800 p-2 rounded-xl`,children:e.jsx(t.icon,{size:20})}),e.jsxs("span",{className:"text-2xl font-black font-mono tabular-nums",children:[t.percent,"%"]})]}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 tracking-widest uppercase mb-1",children:t.label}),e.jsx("p",{className:"text-[10px] font-bold text-gray-500 truncate mb-4",children:t.sub}),e.jsx("div",{className:"h-2 w-full bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${t.percent>90?"bg-red-500":t.percent>70?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${t.percent}%`}})})]},i))})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[{label:"本日PV",val:m.today_pv,color:"text-blue-600",icon:pt},{label:"累計アクセス",val:m.total_pv,color:"text-indigo-600",icon:Bt},{label:"受信メッセージ",val:S.length,color:"text-pink-600",icon:ze},{label:"遮断中のIP",val:Object.keys(N).length,color:"text-red-600",icon:it}].map((t,i)=>e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-800",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 tracking-widest uppercase mb-4",children:t.label}),e.jsx("p",{className:`text-3xl font-black ${t.color} font-mono tabular-nums`,children:t.val.toLocaleString()})]},i))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-dark-lighter p-8 rounded-[2.5rem] border border-gray-100 dark:border-gray-800 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h3",{className:"font-black text-lg uppercase tracking-tight",children:"トラフィック推移 (LIVE)"}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-blue-500 bg-blue-50 dark:bg-blue-900/30 px-3 py-1 rounded-full",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-ping"}),"3s UPDATE"]})]}),e.jsx("div",{className:"h-72",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(na,{data:Ze,children:[e.jsx(wt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(Xe,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:"bold"}}),e.jsx(He,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:"bold"}}),e.jsx(Nt,{contentStyle:{borderRadius:"16px",border:"none",boxShadow:"0 10px 25px rgba(0,0,0,0.1)",fontWeight:"bold"}}),e.jsx(q,{type:"monotone",dataKey:"pv",stroke:"#3b82f6",strokeWidth:4,fill:"#3b82f6",fillOpacity:.1,animationDuration:500})]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-8 rounded-[2.5rem] border border-gray-100 dark:border-gray-800 shadow-sm flex flex-col",children:[e.jsx("h3",{className:"font-black text-lg mb-6 uppercase tracking-tight",children:"リアルタイム・ログ"}),e.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto no-scrollbar",children:m.recent_logs.slice(0,15).map((t,i)=>e.jsxs("div",{className:`flex justify-between items-center text-[10px] p-2 rounded-xl border-b dark:border-gray-800 last:border-0 ${t.path===le?"bg-red-50 dark:bg-red-900/10":""}`,children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:`font-black truncate ${t.path===le?"text-red-600":"text-blue-600"}`,children:t.path}),e.jsx("p",{className:"text-gray-400 font-mono",children:t.ip})]}),e.jsx("p",{className:"text-gray-500 font-bold ml-4 whitespace-nowrap",children:t.date.split(" ")[1]})]},i))})]})]}),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[e.jsx("h3",{className:"text-xl font-black",children:"アプリ別トラフィック"}),e.jsxs("select",{className:"bg-slate-900 text-white px-4 py-2 rounded-xl text-xs font-black",onChange:t=>{t.target.value&&!J.includes(t.target.value)&&ve([...J,t.target.value]),t.target.value=""},children:[e.jsx("option",{value:"",children:"監視対象を追加..."}),he.filter(t=>!J.includes(t.id)).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:J.map(t=>{const i=he.find(B=>B.id===t);if(!i)return null;const o=Pe[t]||0,c=Object.values(Pe).reduce((B,H)=>B+H,0),A=c>0?(o/c*100).toFixed(1):"0";return e.jsxs("div",{onClick:()=>rt(i.path),className:"bg-white dark:bg-dark-lighter p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 relative group animate-scale-up cursor-pointer hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-xl transition-all",children:[e.jsx("button",{onClick:B=>{B.stopPropagation(),ve(J.filter(H=>H!==t))},className:"absolute top-4 right-4 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(me,{size:16})}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`p-3 rounded-2xl ${i.lightBg} ${i.color}`,children:e.jsx(i.icon,{size:20})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"font-black text-sm truncate",children:i.name}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:i.path})]})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase mb-1 tracking-tighter",children:"RECENT PV"}),e.jsx("p",{className:"text-3xl font-black font-mono",children:o})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-[10px] font-black text-blue-500 mb-1 flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:["LOGS ",e.jsx(_t,{size:10})]}),e.jsxs("p",{className:"text-xl font-black font-mono text-emerald-600",children:[A,"%"]})]})]})]},t)})})]})]}),s==="logs"&&e.jsx("div",{className:"animate-fade-in max-w-7xl mx-auto w-full space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-[2.5rem] shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b dark:border-gray-800 bg-slate-50 dark:bg-slate-800/30 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-black text-xl flex items-center gap-2",children:[e.jsx(Vt,{className:"text-blue-500"})," ログフィルタリング"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[F&&e.jsxs("button",{onClick:()=>U(""),className:"text-[10px] bg-blue-100 text-blue-600 px-3 py-1 rounded-full font-black flex items-center gap-1",children:["Path: ",F," ",e.jsx(me,{size:12})]}),e.jsx("button",{onClick:()=>{Z(""),U(""),xe("")},className:"text-[10px] text-gray-400 font-black hover:text-red-500 transition-colors",children:"リセット"}),e.jsx("button",{onClick:()=>Y(!1),className:"p-2 text-gray-400 hover:text-blue-500",children:e.jsx(be,{size:20,className:v?"animate-spin":""})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"IPアドレス...",value:$,onChange:t=>Z(t.target.value),className:"w-full pl-9 pr-3 py-3 rounded-xl border dark:border-gray-700 dark:bg-gray-900 text-xs font-bold"})]}),e.jsxs("div",{className:"relative",children:[e.jsx($t,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"パス (例: /bath)",value:F,onChange:t=>U(t.target.value),className:"w-full pl-9 pr-3 py-3 rounded-xl border dark:border-gray-700 dark:bg-gray-900 text-xs font-bold"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(St,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"日付 (YYYY-MM-DD)",value:oe,onChange:t=>xe(t.target.value),className:"w-full pl-9 pr-3 py-3 rounded-xl border dark:border-gray-700 dark:bg-gray-900 text-xs font-bold"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-900 text-white text-[10px] uppercase font-black tracking-widest",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-5",children:"日時"}),e.jsx("th",{className:"px-8 py-5",children:"パス"}),e.jsx("th",{className:"px-8 py-5",children:"クライアントIP"}),e.jsx("th",{className:"px-8 py-5",children:"応答"}),e.jsx("th",{className:"px-8 py-5 text-right",children:"状態"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:Oe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-20 text-center text-gray-400 font-bold",children:"該当するログはありません"})}):Oe.map((t,i)=>e.jsxs("tr",{className:`transition-colors ${t.path===le?"bg-red-50 dark:bg-red-900/10 hover:bg-red-100":"hover:bg-slate-50 dark:hover:bg-slate-800/40"}`,children:[e.jsx("td",{className:"px-8 py-4 font-mono text-[11px] text-gray-500 whitespace-nowrap",children:t.date}),e.jsx("td",{className:"px-8 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-black truncate max-w-[200px] ${t.path===le?"text-red-600":"text-blue-600 dark:text-blue-400"}`,children:t.path}),t.path===le&&e.jsx("span",{className:"text-[8px] bg-red-600 text-white px-1.5 py-0.5 rounded-full font-black uppercase",children:"Admin Access"})]})}),e.jsx("td",{className:"px-8 py-4 font-mono text-[11px] text-gray-400",children:t.ip}),e.jsx("td",{className:"px-8 py-4 font-mono text-[11px] font-black",children:t.duration?`${t.duration}ms`:"--"}),e.jsx("td",{className:"px-8 py-4 text-right",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-black ${t.status&&Number(t.status)>=400?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:t.status||200})})]},i))})]})})]})}),s==="security"&&e.jsx("div",{className:"animate-fade-in max-w-7xl mx-auto w-full space-y-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-dark-lighter rounded-[2.5rem] shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b flex justify-between items-center bg-slate-50 dark:bg-slate-800/30",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-black text-xl flex items-center gap-2",children:[e.jsx(Ct,{className:"text-red-500"})," 遮断中のIP"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"過剰リクエストにより自動または手動で制限された端末"})]}),e.jsx("button",{onClick:()=>Y(!1),className:"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-sm hover:text-blue-500 transition-colors",children:e.jsx(be,{size:20,className:v?"animate-spin":""})})]}),e.jsx("div",{className:"overflow-x-auto min-h-[300px]",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] uppercase font-black text-gray-400 bg-gray-50 dark:bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-3",children:"IP"}),e.jsx("th",{className:"px-8 py-3",children:"検知理由"}),e.jsx("th",{className:"px-8 py-3",children:"期限"}),e.jsx("th",{className:"px-8 py-3 text-right",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:Object.entries(N).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-20 text-gray-400 font-bold",children:"遮断中のIPはありません"})}):Object.entries(N).map(([t,i])=>{const o=i,c=Number(o.expiry);return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-8 py-6 font-mono font-black text-red-600",children:t}),e.jsx("td",{className:"px-8 py-6",children:e.jsx("span",{className:"text-[10px] bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded font-black",children:o.reason||"手動"})}),e.jsx("td",{className:"px-8 py-6 text-xs font-bold text-gray-500",children:c>=2147483640?"永久":new Date(c*1e3).toLocaleString()}),e.jsx("td",{className:"px-8 py-6 text-right",children:e.jsx("button",{onClick:()=>tt(t),className:"px-6 py-2 bg-blue-600 text-white text-[10px] font-black rounded-xl hover:bg-blue-700 transition-all",children:"解除"})})]},t)})})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-8 rounded-[2.5rem] border border-gray-100 dark:border-gray-700 shadow-sm space-y-6 flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-black text-xl flex items-center gap-3",children:[e.jsx(Ee,{className:"text-emerald-500"})," DOS攻撃対策設定"]}),e.jsxs("button",{type:"button",onClick:()=>{D({...y,dos_notify_enabled:!y.dos_notify_enabled}),E(!0)},className:`w-full flex items-center justify-center gap-2 py-3 mt-6 rounded-xl text-xs font-black transition-all ${y.dos_notify_enabled?"bg-emerald-100 text-emerald-600":"bg-gray-100 text-gray-400"}`,children:[y.dos_notify_enabled?e.jsx(Pt,{size:20}):e.jsx(Ot,{size:20})," 検知時に通知"]}),e.jsxs("div",{className:"space-y-4 mt-6 max-h-[400px] overflow-y-auto no-scrollbar pr-2",children:[y.dos_patterns.map((t,i)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 relative group animate-scale-up",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[8px] font-black text-gray-400 uppercase",children:"期間(秒)"}),e.jsx("input",{type:"number",value:t.seconds,onChange:o=>{const c=[...y.dos_patterns];c[i]={...c[i],seconds:Number(o.target.value)},D({...y,dos_patterns:c}),E(!0)},className:"w-full p-2 border rounded-lg text-xs font-bold dark:bg-slate-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[8px] font-black text-gray-400 uppercase",children:"回数"}),e.jsx("input",{type:"number",value:t.count,onChange:o=>{const c=[...y.dos_patterns];c[i]={...c[i],count:Number(o.target.value)},D({...y,dos_patterns:c}),E(!0)},className:"w-full p-2 border rounded-lg text-xs font-bold dark:bg-slate-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[8px] font-black text-gray-400 uppercase",children:"遮断(分)"}),e.jsx("input",{type:"number",value:t.block_minutes,onChange:o=>{const c=[...y.dos_patterns];c[i]={...c[i],block_minutes:Number(o.target.value)},D({...y,dos_patterns:c}),E(!0)},className:"w-full p-2 border rounded-lg text-xs font-bold dark:bg-slate-900"})]})]}),e.jsx("button",{type:"button",onClick:()=>{const o=[...y.dos_patterns];o.splice(i,1),D({...y,dos_patterns:o}),E(!0)},className:"absolute -top-2 -right-2 p-1.5 bg-white dark:bg-gray-700 border dark:border-gray-600 rounded-full text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(me,{size:12})})]},i)),e.jsx("button",{type:"button",onClick:()=>{D({...y,dos_patterns:[...y.dos_patterns,{count:50,seconds:60,block_minutes:60}]}),E(!0)},className:"w-full py-2 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-xl text-gray-400 font-black text-[10px] hover:border-emerald-500 hover:text-emerald-500 transition-all",children:"+ 監視ルールを追加"})]})]}),e.jsxs("button",{onClick:()=>Le(),disabled:!ne,className:`w-full py-4 rounded-xl text-xs font-black shadow-xl transition-all flex items-center justify-center gap-2 ${ne?"bg-emerald-600 text-white hover:bg-emerald-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(Ee,{size:18})," ",ne?"変更を保存して適用":"変更なし"]})]})]})}),s==="messages"&&e.jsx("div",{className:"space-y-4 animate-fade-in max-w-5xl mx-auto w-full pb-20",children:S.length===0?e.jsx("div",{className:"text-center py-24 bg-white dark:bg-dark-lighter rounded-[2.5rem] border-2 border-dashed border-gray-200 dark:border-gray-800 text-gray-400 font-black uppercase tracking-widest",children:"受信メッセージはありません"}):S.map(t=>e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-6 sm:p-8 rounded-[2rem] shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between mb-6 gap-2",children:[e.jsxs("span",{className:"font-black text-blue-600 flex items-center gap-3",children:[e.jsx("div",{className:"bg-slate-100 dark:bg-slate-800 p-2 rounded-full text-gray-400",children:e.jsx(qt,{size:20})}),t.name," ",e.jsxs("span",{className:"text-[10px] font-normal text-gray-400",children:["(",t.contact||"連絡先なし",")"]})]}),e.jsxs("span",{className:"text-[10px] text-gray-400 font-mono bg-slate-50 dark:bg-slate-800 px-3 py-1.5 rounded-full border dark:border-gray-700",children:[t.timestamp," (IP: ",t.ip,")"]})]}),e.jsx("p",{className:"bg-slate-50 dark:bg-slate-900/50 p-6 rounded-2xl whitespace-pre-wrap leading-relaxed text-sm text-gray-700 dark:text-gray-300 font-medium border dark:border-gray-800",children:t.message})]},t.id))}),s==="settings"&&e.jsxs("div",{className:"animate-fade-in max-w-7xl mx-auto w-full space-y-10 pb-20",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-8 rounded-[2.5rem] border border-gray-100 dark:border-gray-700 shadow-sm space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-black text-xl flex items-center gap-3",children:[e.jsx(ze,{className:"text-pink-500"})," 通知用 SMTP 設定"]}),e.jsxs("button",{onClick:et,disabled:Ae,className:"px-4 py-2 bg-pink-50 dark:bg-pink-900/30 text-pink-600 rounded-xl text-xs font-black hover:bg-pink-100 transition-colors flex items-center gap-2",children:[Ae?e.jsx(Te,{size:14,className:"animate-spin"}):e.jsx(xt,{size:14})," 接続テスト"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"ホスト名"}),e.jsx("input",{type:"text",value:y.smtp_host,onChange:t=>{D({...y,smtp_host:t.target.value}),E(!0)},className:"w-full p-3 border rounded-xl font-bold dark:bg-slate-900"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"ポート"}),e.jsx("input",{type:"number",value:y.smtp_port,onChange:t=>{D({...y,smtp_port:Number(t.target.value)}),E(!0)},className:"w-full p-3 border rounded-xl font-bold dark:bg-slate-900"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"ユーザー (ログインID)"}),e.jsx("input",{type:"text",value:y.smtp_user,onChange:t=>{D({...y,smtp_user:t.target.value}),E(!0)},className:"w-full p-3 border rounded-xl font-bold dark:bg-slate-900"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"パスワード"}),e.jsx("input",{type:"password",value:y.smtp_pass,onChange:t=>{D({...y,smtp_pass:t.target.value}),E(!0)},className:"w-full p-3 border rounded-xl font-bold dark:bg-slate-900",placeholder:"変更しない場合は空欄"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"通知用メールアドレス"}),e.jsx("input",{type:"email",value:y.alert_email,onChange:t=>{D({...y,alert_email:t.target.value}),E(!0)},className:"w-full p-3 border rounded-xl font-bold dark:bg-slate-900"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-8 rounded-[2.5rem] border border-gray-100 dark:border-gray-700 shadow-sm space-y-6",children:[e.jsxs("h3",{className:"font-black text-xl flex items-center gap-3",children:[e.jsx(Lt,{className:"text-blue-500"})," 管理者パスワードの更新"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase",children:"新しいパスワード"}),e.jsx("input",{type:"password",value:Q,onChange:t=>Ne(t.target.value),className:"w-full p-3 border rounded-xl font-bold dark:bg-slate-900 focus:border-blue-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase",children:"確認のため再入力"}),e.jsx("input",{type:"password",value:we,onChange:t=>_e(t.target.value),className:"w-full p-3 border rounded-xl font-bold dark:bg-slate-900 focus:border-blue-500 transition-colors"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(Mt,{className:"text-blue-600 shrink-0 mt-0.5",size:16}),e.jsx("p",{className:"text-[10px] text-blue-800 dark:text-blue-300 font-bold leading-relaxed",children:"強力なパスワードを設定してください。変更後は即座に適用されます。"})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("button",{onClick:()=>Le(),disabled:!ne&&!Q,className:`w-full py-5 rounded-[1.5rem] text-sm font-black shadow-2xl transition-all flex items-center justify-center gap-3 active:scale-95 tracking-widest uppercase ${ne||Q?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 hover:opacity-90":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[je?e.jsx(lt,{size:24}):e.jsx(Et,{size:24}),je||"システム設定をすべて保存する"]})})]}),e.jsxs("div",{className:"bg-indigo-600 p-8 sm:p-10 rounded-[2.5rem] text-white shadow-2xl space-y-8 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl",children:e.jsx(Tt,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-xl mb-1 uppercase",children:"システムバックアップ"}),e.jsx("p",{className:"text-xs opacity-70 font-bold",children:"全ログとメッセージデータのJSONエクスポート・復元"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>{const t={messages:S,logs:m.recent_logs},i=document.createElement("a");i.href=URL.createObjectURL(new Blob([JSON.stringify(t,null,2)],{type:"application/json"})),i.download=`OMNITOOLS_ADMIN_BACKUP_${new Date().toISOString().split("T")[0]}.json`,i.click()},className:"py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-black text-[10px] uppercase tracking-widest flex items-center justify-center gap-2 transition-all border border-white/20",children:[e.jsx(zt,{size:16})," 出力"]}),e.jsxs("button",{onClick:()=>{var t;return(t=Ce.current)==null?void 0:t.click()},className:"py-4 bg-white text-indigo-600 rounded-2xl font-black text-[10px] uppercase tracking-widest flex items-center justify-center gap-2 shadow-lg hover:opacity-90 transition-all",children:[e.jsx(Dt,{size:16})," 復元"]}),e.jsx("input",{type:"file",accept:".json",ref:Ce,onChange:async t=>{var c;const i=(c=t.target.files)==null?void 0:c[0];if(!i||!confirm("既存のデータは上書きされます。続行しますか？"))return;const o=new FileReader;o.onload=async A=>{var B;try{(await fetch("./backend/admin_api.php?action=import_data",{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Token":a||""},body:(B=A.target)==null?void 0:B.result})).ok&&(alert("復元成功"),Y(!0))}catch{alert("復元エラー")}},o.readAsText(i)},className:"hidden"})]})]})]}),s==="apps"&&e.jsx("div",{className:"animate-fade-in max-w-7xl mx-auto w-full space-y-8 pb-20",children:e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-[2.5rem] shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b dark:border-gray-800 bg-slate-50 dark:bg-slate-800/30 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-black text-xl flex items-center gap-2",children:[e.jsx(Ht,{className:"text-cyan-500"})," アプリ管理: URLまとめ"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"発行済みのURLまとめリストの管理・削除"})]}),e.jsx("button",{onClick:ue,className:"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-sm hover:text-cyan-500 transition-colors",children:e.jsx(be,{size:20,className:P?"animate-spin":""})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] uppercase font-black text-gray-400 bg-gray-50 dark:bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-3",children:"ID"}),e.jsx("th",{className:"px-8 py-3",children:"タイトル"}),e.jsx("th",{className:"px-8 py-3",children:"URL数"}),e.jsx("th",{className:"px-8 py-3",children:"作成日時"}),e.jsx("th",{className:"px-8 py-3",children:"有効期限"}),e.jsx("th",{className:"px-8 py-3 text-right",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:ke.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-20 text-gray-400 font-bold",children:"データがありません"})}):ke.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-8 py-4 font-mono font-bold text-gray-600 dark:text-gray-400",children:t.id}),e.jsx("td",{className:"px-8 py-4 font-bold text-gray-800 dark:text-white max-w-[200px] truncate",title:t.title,children:t.title}),e.jsx("td",{className:"px-8 py-4 font-mono",children:t.count}),e.jsx("td",{className:"px-8 py-4 text-xs text-gray-500",children:t.created_at}),e.jsx("td",{className:"px-8 py-4 text-xs text-gray-500",children:t.expires_at}),e.jsxs("td",{className:"px-8 py-4 text-right flex justify-end gap-2",children:[e.jsx("a",{href:`#/bundle?id=${t.id}`,target:"_blank",rel:"noreferrer",className:"p-2 bg-slate-100 dark:bg-slate-700 text-slate-500 rounded-lg hover:text-cyan-500 transition-colors",children:e.jsx(It,{size:16})}),e.jsx("button",{onClick:()=>Qe(t.id),className:"p-2 bg-red-50 dark:bg-red-900/20 text-red-500 rounded-lg hover:bg-red-100 transition-colors",children:e.jsx(Rt,{size:16})})]})]},t.id))})]})})]})})]}),e.jsxs("footer",{className:"bg-white dark:bg-slate-900 border-t dark:border-gray-800 h-10 px-6 flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"LIVE CONNECTION ACTIVE"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xt,{size:10,className:"text-gray-400"}),e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"DRILL-DOWN ENABLED"})]})]}),e.jsxs("div",{className:"text-[9px] font-black text-gray-300 uppercase tracking-widest",children:["Last Sync: ",new Date().toLocaleTimeString()]})]})]}):e.jsx("div",{className:"fixed inset-0 z-[200] bg-slate-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-10 text-center animate-scale-up",children:[e.jsx("div",{className:"inline-flex p-4 bg-red-50 text-red-600 rounded-full mb-6",children:e.jsx(ot,{size:32})}),e.jsx("h2",{className:"text-2xl font-black mb-2 dark:text-white",children:"管理者認証"}),e.jsxs("form",{onSubmit:at,className:"space-y-4",children:[e.jsx("input",{type:"password",value:l,onChange:t=>p(t.target.value),placeholder:"パスワードを入力",className:"w-full p-4 rounded-2xl border-2 dark:bg-gray-900 dark:text-white outline-none focus:border-red-500 transition-all",autoFocus:!0}),d&&e.jsx("p",{className:"text-red-500 text-sm font-bold",children:d}),e.jsx("button",{type:"submit",disabled:b,className:"w-full py-4 bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-black rounded-2xl flex items-center justify-center gap-2 hover:opacity-90 active:scale-95 transition-all",children:b?e.jsx(Te,{className:"animate-spin"}):"認証する"})]})]})})};export{lr as default};
