import{j as e}from"./index-D4reVrDU.js";import{r as c}from"./vendor-react-Dy8mW7IA.js";import{W as ke}from"./WorkspaceContext-gpeJemtb.js";import{A as we}from"./AdBanner-DUdjXfK6.js";import{a4 as G,bo as Ne,G as ve,aI as H,aL as V,aK as Y,R as z,bp as Se,w as A,x as R,Y as E,T as F,bq as $e,aE as X,aF as Q,aG as Z,j as ee,a2 as Ce,b1 as De,P as Te,X as te,U as Le,J as Oe,aJ as qe,z as Ie}from"./vendor-ui-gkh9ij8_.js";import"./vendor-utils-V9s-2EHj.js";const Me=["順張り","逆張り","材料/決算","デイトレ","スイング","長期/配当","優待","IPO","その他"],ze=[{id:"calm",label:"冷静",color:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300"},{id:"excited",label:"興奮",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300"},{id:"anxious",label:"不安",color:"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300"},{id:"angry",label:"怒り",color:"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"},{id:"fear",label:"恐怖",color:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}],Ae=({symbol:g})=>{const m=c.useRef(null);return c.useEffect(()=>{if(!m.current)return;m.current.innerHTML="";const j=document.createElement("div");j.className="tradingview-widget-container__widget",j.style.height="100%",j.style.width="100%",m.current.appendChild(j);const n=document.createElement("script");n.src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js",n.type="text/javascript",n.async=!0,n.innerHTML=JSON.stringify({autosize:!0,symbol:g,interval:"D",timezone:"Asia/Tokyo",theme:document.documentElement.classList.contains("dark")?"dark":"light",style:"1",locale:"ja",enable_publishing:!1,allow_symbol_change:!0,calendar:!1,support_host:"https://www.tradingview.com"}),m.current.appendChild(n)},[g]),e.jsx("div",{className:"tradingview-widget-container h-full w-full rounded-2xl overflow-hidden shadow-sm border border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900",ref:m,style:{height:"100%"}})},Ke=()=>{const g=c.useContext(ke),[m,j]=c.useState("dashboard"),[n,y]=c.useState([]),[h,N]=c.useState(1e6),[v,ae]=c.useState(!1),[_,Re]=c.useState("TSE:7203"),[re,S]=c.useState(!1),[se,$]=c.useState(!1),L=c.useRef(null),[d,b]=c.useState({date:new Date().toISOString().split("T")[0],type:"sell",emotion:"calm",strategy:"順張り",quantity:100,pnl:0});c.useEffect(()=>{const t=localStorage.getItem("stock_trades"),r=localStorage.getItem("stock_initial_asset");if(t)try{const a=JSON.parse(t);if(Array.isArray(a)){const s=a.map(o=>({...o,price:Number(o.price)||0,quantity:Number(o.quantity)||0,pnl:Number(o.pnl)||0,date:o.date||new Date().toISOString().split("T")[0]}));y(s)}else y([])}catch(a){console.error("Failed to parse trades",a),y([])}else y([{id:"1",date:"2023-10-01",ticker:"7203",name:"トヨタ",type:"buy",price:2e3,quantity:100,pnl:0,comment:"エントリー",strategy:"順張り",emotion:"calm"},{id:"2",date:"2023-10-05",ticker:"7203",name:"トヨタ",type:"sell",price:2150,quantity:100,pnl:15e3,comment:"利確",strategy:"順張り",emotion:"excited"}]);r&&!isNaN(Number(r))&&N(Number(r)),ae(!0)},[]),c.useEffect(()=>{v&&localStorage.setItem("stock_trades",JSON.stringify(n))},[n,v]),c.useEffect(()=>{v&&localStorage.setItem("stock_initial_asset",h.toString())},[h,v]);const O=new Date().toISOString().slice(0,7),le=n.reduce((t,r)=>t+(Number(r.pnl)||0),0),de=h+le,P=c.useMemo(()=>n.filter(t=>t.date&&t.date.startsWith(O)).reduce((t,r)=>t+(Number(r.pnl)||0),0),[n,O]),C=n.filter(t=>t.type==="sell"&&t.pnl!==0),k=C.filter(t=>t.pnl>0),U=C.filter(t=>t.pnl<0),ne=C.length>0?k.length/C.length*100:0,q=k.reduce((t,r)=>t+r.pnl,0),J=Math.abs(U.reduce((t,r)=>t+r.pnl,0)),oe=J===0?q>0?99.99:0:q/J,ie=k.length>0?q/k.length:0,K=c.useMemo(()=>{const t=new Map,r=[...n].sort((a,s)=>new Date(a.date).getTime()-new Date(s.date).getTime());for(const a of r){if(!a.ticker)continue;const s=t.get(a.ticker)||{name:a.name||a.ticker,quantity:0,totalCost:0};if(a.type==="buy")s.quantity+=a.quantity,s.totalCost+=a.price*a.quantity;else if(a.type==="sell"){const o=s.quantity>0?s.totalCost/s.quantity:0;s.quantity-=a.quantity,s.totalCost-=o*a.quantity}s.quantity<1e-4?t.delete(a.ticker):t.set(a.ticker,s)}return Array.from(t.entries()).map(([a,s])=>({...s,ticker:a,avgPrice:s.quantity>0?s.totalCost/s.quantity:0}))},[n]),ce=c.useMemo(()=>{const t=[...n].sort((l,i)=>new Date(l.date).getTime()-new Date(i.date).getTime()),r=new Map,a=new Date().toISOString().split("T")[0];let s=h;if(t.length===0)r.set(a,h);else{const l=t[0].date;if(l){const i=new Date(l);isNaN(i.getTime())||(i.setDate(i.getDate()-1),r.set(i.toISOString().split("T")[0],h))}}for(const l of t)l.date&&(s+=Number(l.pnl)||0,r.set(l.date,s));const o=Array.from(r.entries()).sort((l,i)=>new Date(l[0]).getTime()-new Date(i[0]).getTime()).map(([l,i])=>({date:l,asset:i})).filter(l=>!isNaN(l.asset));return o.length>0?o:[{date:a,asset:h}]},[n,h]),D=c.useMemo(()=>{const t={};n.forEach(a=>{if(!a.date)return;const s=a.date.slice(0,7);t[s]=(t[s]||0)+(Number(a.pnl)||0)});const r=Object.entries(t).sort().map(([a,s])=>({date:a,pnl:s}));return r.length>0?r:[{date:O,pnl:0}]},[n]),W=c.useMemo(()=>{const t={};return n.forEach(r=>{const a=r.strategy||"その他";t[a]=(t[a]||0)+(Number(r.pnl)||0)}),Object.entries(t).sort((r,a)=>a[1]-r[1]).map(([r,a])=>({name:r,value:a}))},[n]),xe=()=>{const t=`ID,日付,銘柄コード,銘柄名,売買区分,価格,株数,損益,戦略,感情,コメント
`,r=n.map(l=>`"${l.id}","${l.date}","${l.ticker}","${l.name}","${l.type}",${l.price},${l.quantity},${l.pnl},"${l.strategy}","${l.emotion}","${l.comment}"`).join(`
`),a=new Blob([new Uint8Array([239,187,191]),t+r],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=`trade_history_${new Date().toISOString().split("T")[0]}.csv`,o.click(),URL.revokeObjectURL(s)},ge=()=>{confirm("全ての取引データを削除しますか？この操作は取り消せません。")&&(y([]),N(1e6),alert("データを初期化しました。"))},me=()=>{const t={initialAsset:h,trades:n},r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=`stock_tracker_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)},be=t=>{var s;const r=(s=t.target.files)==null?void 0:s[0];if(!r)return;const a=new FileReader;a.onload=o=>{var l;try{const i=JSON.parse((l=o.target)==null?void 0:l.result);i.trades&&Array.isArray(i.trades)?confirm("現在のデータを上書きして復元しますか？")&&(y(i.trades),typeof i.initialAsset=="number"&&N(i.initialAsset),alert("復元が完了しました。"),$(!1)):alert("無効なデータ形式です。")}catch{alert("ファイルの読み込みに失敗しました。")}L.current&&(L.current.value="")},a.readAsText(r)},he=()=>{if(!d.date){alert("日付は必須です");return}const t={id:Date.now().toString(),date:d.date,ticker:d.ticker||"",name:d.name||d.ticker||"取引",type:d.type||"sell",price:Number(d.price)||0,quantity:Number(d.quantity)||0,pnl:Number(d.pnl)||0,comment:d.comment||"",strategy:d.strategy||"その他",emotion:d.emotion||"calm"};y(r=>[...r,t]),S(!1),b({date:new Date().toISOString().split("T")[0],type:"sell",emotion:"calm",strategy:"順張り",quantity:100,pnl:0,name:"",ticker:"",comment:"",price:0})},ye=t=>{confirm("この記録を削除しますか？")&&y(n.filter(r=>r.id!==t))},T=({title:t,value:r,sub:a,colorClass:s})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase",children:t}),e.jsx("div",{className:`text-2xl font-black mt-1 ${s||"text-gray-800 dark:text-white"}`,children:r}),a&&e.jsx("span",{className:"text-[10px] text-gray-400 mt-1",children:a})]}),pe=()=>{const t=new Date,r=[];for(let a=89;a>=0;a--){const s=new Date;s.setDate(t.getDate()-a),r.push(s.toISOString().split("T")[0])}return e.jsx("div",{className:"flex flex-wrap gap-1",children:r.map(a=>{const o=n.filter(i=>i.date===a&&i.pnl!==0).reduce((i,I)=>i+I.pnl,0);let l="bg-gray-100 dark:bg-gray-700";return o>5e4?l="bg-red-500":o>1e4?l="bg-red-400":o>0?l="bg-red-300":o<-5e4?l="bg-emerald-600":o<-1e4?l="bg-emerald-500":o<0&&(l="bg-emerald-400"),e.jsx("div",{className:`w-3 h-3 rounded-sm ${l}`,title:`${a}: ${o.toLocaleString()}円`},a)})})},ue=()=>{const[t,r]=c.useState(new Date),a=t.getFullYear(),s=t.getMonth(),o=new Date(a,s,1).getDay(),l=new Date(a,s+1,0).getDate(),i=[];for(let x=0;x<o;x++)i.push(null);for(let x=1;x<=l;x++)i.push(x);const I=`${a}-${String(s+1).padStart(2,"0")}`,M=n.filter(x=>x.date&&x.date.startsWith(I)).reduce((x,p)=>x+Number(p.pnl),0);return e.jsxs("div",{className:"animate-fade-in bg-white dark:bg-gray-800 p-4 md:p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"font-bold text-lg md:text-xl text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(V,{className:"text-indigo-500"}),a,"年",s+1,"月",e.jsxs("span",{className:`text-sm ml-2 font-mono ${M>=0?"text-red-500":"text-emerald-500"}`,children:["(",M>0?"+":"",M.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r(new Date(a,s-1,1)),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300",children:e.jsx(qe,{size:20})}),e.jsx("button",{onClick:()=>r(new Date),className:"text-xs font-bold px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300",children:"今月"}),e.jsx("button",{onClick:()=>r(new Date(a,s+1,1)),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300",children:e.jsx(Ie,{size:20})})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 md:gap-2",children:[["日","月","火","水","木","金","土"].map((x,p)=>e.jsx("div",{className:`text-center text-xs font-bold py-2 ${p===0?"text-red-400":p===6?"text-blue-400":"text-gray-400"}`,children:x},x)),i.map((x,p)=>{if(!x)return e.jsx("div",{className:"h-16 md:h-24 bg-transparent"},p);const B=`${a}-${String(s+1).padStart(2,"0")}-${String(x).padStart(2,"0")}`,w=n.filter(f=>f.date===B),u=w.reduce((f,je)=>f+je.pnl,0),fe=new Date().toISOString().slice(0,10)===B;return e.jsxs("div",{className:`h-16 md:h-24 p-1 md:p-2 border rounded-xl flex flex-col justify-between transition-all hover:shadow-md ${w.length>0?"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600":"bg-transparent border-transparent"} ${fe?"ring-2 ring-indigo-500":""}`,children:[e.jsx("span",{className:"text-[10px] md:text-xs font-bold text-gray-500 dark:text-gray-400",children:x}),w.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-right font-black text-[10px] md:text-sm ${u>0?"text-red-500":u<0?"text-emerald-500":"text-gray-400"}`,children:u!==0&&(u>0?"+":"")+(Math.abs(u)>=1e6?(u/1e4).toFixed(0)+"万":u.toLocaleString())}),e.jsxs("div",{className:"flex justify-end gap-0.5 md:gap-1 mt-1",children:[w.some(f=>f.type==="buy")&&e.jsx("div",{className:"w-1 md:w-1.5 h-1 md:h-1.5 rounded-full bg-blue-400"}),w.some(f=>f.type==="sell")&&e.jsx("div",{className:"w-1 md:w-1.5 h-1 md:h-1.5 rounded-full bg-red-400"})]})]})]},p)})]})]})};return e.jsxs("div",{className:`${g?"mx-auto h-full flex flex-col w-full p-2":"mx-auto max-w-6xl space-y-6 pb-20"}`,children:[!g&&e.jsxs("div",{className:"flex justify-between items-center shrink-0",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(G,{className:"text-indigo-500"})," 株トレード記録"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>$(!0),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:"設定"})})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl overflow-x-auto no-scrollbar shrink-0",children:[{id:"dashboard",icon:Ne,label:"ホーム"},{id:"market",icon:ve,label:"マーケット"},{id:"history",icon:H,label:"履歴"},{id:"calendar",icon:V,label:"カレンダー"},{id:"analytics",icon:Y,label:"分析"}].map(t=>e.jsxs("button",{onClick:()=>j(t.id),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-xs sm:text-sm font-bold transition-all whitespace-nowrap ${m===t.id?"bg-white dark:bg-gray-700 text-indigo-600 dark:text-indigo-400 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[e.jsx(t.icon,{size:16}),t.label]},t.id))}),e.jsxs("div",{className:g?"flex-1 overflow-y-auto no-scrollbar":"",children:[m==="dashboard"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(T,{title:"総資産評価額",value:`¥${de.toLocaleString()}`,colorClass:"text-indigo-600 dark:text-indigo-400"}),e.jsx(T,{title:"今月の損益",value:`¥${(P||0).toLocaleString()}`,colorClass:(P||0)>=0?"text-red-500":"text-emerald-500"}),e.jsx(T,{title:"勝率",value:`${ne.toFixed(1)}%`,sub:`${k.length}勝 ${U.length}敗`}),e.jsx(T,{title:"PF / リスクリワード",value:oe.toFixed(2),sub:`Avg Win: ¥${Math.round(ie).toLocaleString()}`})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(G,{size:18})," 資産推移"]}),e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(Se,{data:ce,children:[e.jsx(A,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(R,{dataKey:"date",tick:{fontSize:10},tickFormatter:t=>typeof t=="string"&&t.length>=5?t.slice(5):"",stroke:"#9ca3af"}),e.jsx(E,{tick:{fontSize:10},tickFormatter:t=>`${t/1e4}万`,width:40,domain:["auto","auto"],stroke:"#9ca3af"}),e.jsx(F,{formatter:t=>`¥${t.toLocaleString()}`,contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)",backgroundColor:"rgba(255,255,255,0.9)",color:"#333"}}),e.jsx($e,{type:"monotone",dataKey:"asset",stroke:"#4f46e5",strokeWidth:3,dot:!1,activeDot:{r:6}})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(Y,{size:18})," 月次損益"]}),e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(X,{data:D,children:[e.jsx(A,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(R,{dataKey:"date",tick:{fontSize:10},tickFormatter:t=>typeof t=="string"&&t.length>=5?t.slice(5):"",stroke:"#9ca3af"}),e.jsx(E,{tickFormatter:t=>`${t/1e4}万`,width:40,stroke:"#9ca3af"}),e.jsx(F,{formatter:t=>`¥${t.toLocaleString()}`,cursor:{fill:"transparent"},contentStyle:{backgroundColor:"rgba(255,255,255,0.9)",borderRadius:"8px",color:"#333"}}),e.jsx(Q,{dataKey:"pnl",children:D.map((t,r)=>e.jsx(Z,{fill:t.pnl>=0?"#ef4444":"#10b981"},`cell-${r}`))})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(H,{size:18})," アクティビティ"]}),e.jsx("div",{className:"mb-4",children:e.jsx(pe,{})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase",children:"直近の取引"}),n.slice(-5).reverse().map(t=>e.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-gray-100 dark:border-gray-700 pb-2 last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs font-bold px-1.5 py-0.5 rounded mr-2 ${t.type==="buy"?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"}`,children:t.type==="buy"?"買":t.type==="sell"?"売":t.type}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:t.name})]}),e.jsx("div",{className:`font-bold ${t.pnl>0?"text-red-500":t.pnl<0?"text-emerald-500":"text-gray-400"}`,children:t.pnl!==0?(t.pnl>0?"+":"")+t.pnl.toLocaleString():"-"})]},t.id))]})]})]})]}),m==="market"&&e.jsx("div",{className:`flex flex-col animate-fade-in space-y-4 ${g?"h-full":"h-[80vh] min-h-[500px]"}`,children:e.jsx("div",{className:"flex-1 bg-white dark:bg-gray-800 rounded-3xl overflow-hidden shadow-sm border border-gray-100 dark:border-gray-700 relative",children:e.jsx(Ae,{symbol:_},_)})}),m==="history"&&e.jsxs("div",{className:`animate-fade-in bg-white dark:bg-gray-800 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col ${g?"h-full":"min-h-[500px]"}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-300",children:"取引履歴一覧"}),e.jsxs("button",{onClick:xe,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs font-bold text-gray-600 dark:text-gray-300 transition-colors",children:[e.jsx(ee,{size:14})," CSV出力"]})]}),e.jsx("div",{className:`overflow-x-auto ${g?"flex-1":""}`,children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400 font-bold sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 whitespace-nowrap",children:"日付"}),e.jsx("th",{className:"p-4 whitespace-nowrap",children:"銘柄"}),e.jsx("th",{className:"p-4 whitespace-nowrap",children:"売買"}),e.jsx("th",{className:"p-4 whitespace-nowrap text-right",children:"価格(円)"}),e.jsx("th",{className:"p-4 whitespace-nowrap text-right",children:"株数"}),e.jsx("th",{className:"p-4 whitespace-nowrap text-right",children:"損益"}),e.jsx("th",{className:"p-4 whitespace-nowrap",children:"戦略/感情"}),e.jsx("th",{className:"p-4 w-10"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[[...n].sort((t,r)=>new Date(r.date).getTime()-new Date(t.date).getTime()).map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"p-4 font-mono text-gray-600 dark:text-gray-400",children:t.date}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-bold text-gray-800 dark:text-white",children:t.name}),e.jsx("div",{className:"text-xs text-gray-400 font-mono",children:t.ticker})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${t.type==="buy"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":t.type==="sell"?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"bg-gray-100 text-gray-600"}`,children:t.type==="buy"?"買付":t.type==="sell"?"売却":t.type})}),e.jsx("td",{className:"p-4 text-right font-mono text-gray-700 dark:text-gray-300",children:t.price.toLocaleString()}),e.jsx("td",{className:"p-4 text-right font-mono text-gray-700 dark:text-gray-300",children:t.quantity.toLocaleString()}),e.jsx("td",{className:`p-4 text-right font-mono font-bold ${t.pnl>0?"text-red-500":t.pnl<0?"text-emerald-500":"text-gray-400"}`,children:t.pnl!==0?(t.pnl>0?"+":"")+t.pnl.toLocaleString():"-"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 px-2 py-0.5 rounded w-fit",children:t.strategy}),t.emotion&&e.jsx("span",{className:"text-[10px] text-gray-400",children:t.emotion})]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>ye(t.id),className:"text-gray-400 hover:text-red-500 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(Ce,{size:16})})})]},t.id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"p-8 text-center text-gray-400",children:"取引データがありません"})})]})]})})]}),m==="calendar"&&e.jsx(ue,{}),m==="analytics"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4",children:"月別損益推移"}),e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(X,{data:D,children:[e.jsx(A,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(R,{dataKey:"date",tick:{fontSize:10},tickFormatter:t=>typeof t=="string"&&t.length>=5?t.slice(5):"",stroke:"#9ca3af"}),e.jsx(E,{tickFormatter:t=>`${t/1e4}万`,width:40,stroke:"#9ca3af"}),e.jsx(F,{formatter:t=>`¥${t.toLocaleString()}`,cursor:{fill:"transparent"},contentStyle:{backgroundColor:"rgba(255,255,255,0.9)",borderRadius:"8px",color:"#333"}}),e.jsx(Q,{dataKey:"pnl",children:D.map((t,r)=>e.jsx(Z,{fill:t.pnl>=0?"#ef4444":"#10b981"},`cell-${r}`))})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 h-80",children:[e.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4",children:"戦略別パフォーマンス"}),e.jsx("div",{className:"h-full overflow-y-auto no-scrollbar pb-6",children:W.length>0?e.jsx("div",{className:"space-y-3",children:W.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 text-xs font-bold text-gray-600 dark:text-gray-400 truncate",children:t.name}),e.jsx("div",{className:"flex-1 h-2 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden flex",children:t.value>0?e.jsx("div",{className:"h-full bg-red-500",style:{width:`${Math.min(Math.abs(t.value)/5e4*100,100)}%`}}):e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${Math.min(Math.abs(t.value)/5e4*100,100)}%`}})}),e.jsxs("div",{className:`w-20 text-right text-xs font-bold ${t.value>=0?"text-red-500":"text-emerald-500"}`,children:[t.value>0?"+":"",t.value.toLocaleString()]})]},r))}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-sm",children:"データがありません"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[e.jsx(De,{size:18})," 現在の保有銘柄 (履歴から推定)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400 font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"銘柄"}),e.jsx("th",{className:"p-3 text-right",children:"保有数"}),e.jsx("th",{className:"p-3 text-right",children:"平均取得単価"}),e.jsx("th",{className:"p-3 text-right",children:"推定投資額"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:K.length>0?K.map((t,r)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30",children:[e.jsxs("td",{className:"p-3 font-medium text-gray-800 dark:text-gray-200",children:[t.name," ",e.jsx("span",{className:"text-xs text-gray-400 ml-1",children:t.ticker})]}),e.jsx("td",{className:"p-3 text-right font-mono text-gray-700 dark:text-gray-300",children:t.quantity.toLocaleString()}),e.jsxs("td",{className:"p-3 text-right font-mono text-gray-700 dark:text-gray-300",children:["¥",Math.round(t.avgPrice).toLocaleString()]}),e.jsxs("td",{className:"p-3 text-right font-mono font-bold text-gray-800 dark:text-white",children:["¥",Math.round(t.avgPrice*t.quantity).toLocaleString()]})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-6 text-center text-gray-400",children:"保有なし"})})})]})})]})]})]}),e.jsx("button",{onClick:()=>S(!0),className:`${g?"absolute bottom-4 right-4 p-3 shadow-lg":"fixed bottom-8 right-8 p-5 shadow-2xl"} bg-indigo-600 text-white rounded-full hover:bg-indigo-700 hover:scale-105 transition-all z-20 flex items-center justify-center active:scale-95`,children:e.jsx(Te,{size:g?20:32})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-3xl w-full max-w-sm shadow-2xl border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white",children:"設定"}),e.jsx("button",{onClick:()=>$(!1),children:e.jsx(te,{className:"text-gray-400"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-2",children:"初期資産 (円)"}),e.jsx("input",{type:"number",value:h,onChange:t=>N(Number(t.target.value)),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono font-bold focus:ring-2 focus:ring-indigo-500"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:"※ここに入力した金額をスタート地点として損益を加算します。"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsxs("button",{onClick:me,className:"py-2 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 text-xs font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(ee,{size:14})," バックアップ"]}),e.jsxs("label",{className:"py-2 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 text-xs font-bold rounded-lg transition-colors flex items-center justify-center gap-2 cursor-pointer",children:[e.jsx(Le,{size:14})," 復元 (読込)",e.jsx("input",{type:"file",accept:".json",onChange:be,className:"hidden",ref:L})]})]}),e.jsx("div",{className:"pt-2",children:e.jsxs("button",{onClick:ge,className:"w-full py-2 text-red-500 text-xs font-bold hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Oe,{size:14})," 全データを初期化"]})}),e.jsx("button",{onClick:()=>$(!1),className:"w-full py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-colors",children:"完了"})]})]})}),re&&e.jsx("div",{className:`z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in ${g?"absolute inset-0":"fixed inset-0 bg-black/60"}`,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl w-full max-w-md p-6 shadow-2xl border border-gray-100 dark:border-gray-700 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-black text-gray-800 dark:text-white",children:"取引を記録"}),e.jsx("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex bg-gray-100 dark:bg-gray-700 p-1 rounded-xl",children:["buy","sell","deposit","withdraw"].map(t=>e.jsx("button",{onClick:()=>b({...d,type:t}),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${d.type===t?t==="buy"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-400 shadow":t==="sell"?"bg-white dark:bg-gray-600 text-red-600 dark:text-red-400 shadow":"bg-white dark:bg-gray-600 text-gray-800 dark:text-white shadow":"text-gray-500 dark:text-gray-400"}`,children:t==="buy"?"買付":t==="sell"?"売却":t==="deposit"?"入金":"出金"},t))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"日付"}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-indigo-500 outline-none",value:d.date,onChange:t=>b({...d,date:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"銘柄コード"}),e.jsx("input",{type:"text",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"7203",value:d.ticker,onChange:t=>b({...d,ticker:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"銘柄名 / 項目名"}),e.jsx("input",{type:"text",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"トヨタ自動車",value:d.name,onChange:t=>b({...d,name:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"約定価格"}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono font-bold focus:ring-2 focus:ring-indigo-500 outline-none",value:d.price,onChange:t=>b({...d,price:Number(t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"株数"}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono font-bold focus:ring-2 focus:ring-indigo-500 outline-none",value:d.quantity,onChange:t=>b({...d,quantity:Number(t.target.value)})})]})]}),d.type==="sell"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-xl border border-gray-100 dark:border-gray-700",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"確定損益 (円)"}),e.jsx("input",{type:"number",className:`w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 font-mono text-xl font-black focus:ring-2 focus:ring-indigo-500 outline-none ${Number(d.pnl)>=0?"text-red-500":"text-emerald-500"}`,placeholder:"例: 10000 or -5000",value:d.pnl,onChange:t=>b({...d,pnl:Number(t.target.value)})}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1 text-right",children:"※マイナスの場合は「-」をつけてください"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"戦略・タグ"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Me.map(t=>e.jsx("button",{type:"button",onClick:()=>b({...d,strategy:t}),className:`px-3 py-1 rounded-full text-xs font-bold border transition-all ${d.strategy===t?"bg-indigo-100 dark:bg-indigo-900/50 border-indigo-500 text-indigo-700 dark:text-indigo-300":"border-gray-200 dark:border-gray-600 text-gray-500 dark:text-gray-400"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"感情コンディション"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-1",children:ze.map(t=>e.jsx("button",{type:"button",onClick:()=>b({...d,emotion:t.id}),className:`flex-1 min-w-[60px] py-1.5 rounded text-xs font-bold transition-all ${d.emotion===t.id?t.color+" shadow-sm ring-1 ring-inset ring-current":"bg-gray-100 dark:bg-gray-700 text-gray-400"}`,children:t.label},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 mb-1",children:"メモ"}),e.jsx("textarea",{className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm h-20 resize-none focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"エントリー根拠や反省点...",value:d.comment,onChange:t=>b({...d,comment:t.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{onClick:()=>S(!1),className:"flex-1 py-3 text-gray-500 dark:text-gray-400 text-sm font-bold hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",children:"キャンセル"}),e.jsx("button",{onClick:he,className:"flex-1 py-3 bg-indigo-600 text-white text-sm font-bold rounded-xl hover:bg-indigo-700 shadow-xl shadow-indigo-200 dark:shadow-none transition-colors",children:"保存する"})]})]})}),!g&&e.jsx(we,{})]})};export{Ke as default};
