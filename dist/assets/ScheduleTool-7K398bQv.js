import{c as U,r as x,a3 as De,j as e,m as _e,a4 as Oe,f as Me,X as u,P as ae,a as re,a6 as Ae,Z as Le,g as Ue}from"./index-Bes1oHgt.js";import{W as Re}from"./WorkspaceContext-Bw2h-Ftq.js";import{S as se}from"./settings-ET5w0IJy.js";import{F as Je}from"./filter-MNX-Y_9j.js";import{a as Be,C as Fe}from"./chevron-left-BoUI_3d7.js";import{C as le}from"./circle-BhDPby4a.js";import{I as de}from"./info-M1zJfw7K.js";import{L as We}from"./link-Ddicw9Sh.js";import{L as He}from"./lock-k7MerPM2.js";import{T as Ye}from"./trash-2-D_UMpk2z.js";import{C as ne}from"./chevron-right-BBYnI8cB.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=U("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=U("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=U("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]),dt=()=>{const $=x.useContext(Re),[R]=De(),h=R.get("id"),v=R.get("token"),[T,xe]=x.useState(""),[J,ge]=x.useState(""),[B,be]=x.useState(""),[F,me]=x.useState(""),[m,k]=x.useState([{id:"p1",type:"date",title:"日程候補",candidates:[]}]),[W,H]=x.useState(new Date),[p,Y]=x.useState({start:"19:00",end:"21:00"}),[N,he]=x.useState(!0),[o,q]=x.useState(null),[P,y]=x.useState(!1),[qe,pe]=x.useState(""),[j,E]=x.useState("all"),[C,Z]=x.useState(v),[ye,D]=x.useState(!1),[G,K]=x.useState(""),[ue,w]=x.useState(!1),[i,b]=x.useState(null),[fe,_]=x.useState(!1),[f,O]=x.useState({name:"",comment:""}),[S,M]=x.useState({}),[Ze,Ge]=x.useState(""),[ke,V]=x.useState(!1);x.useEffect(()=>{h?A():q(null)},[h]),x.useEffect(()=>{v&&Z(v)},[v]);const A=async()=>{y(!0);try{const r=await fetch(`./backend/schedule_api.php?action=get&id=${h}`);if(!r.ok)throw new Error("イベントが見つかりません");const s=await r.json();s.polls&&(s.polls=s.polls.map(t=>({...t,candidates:t.candidates.map(a=>typeof a=="string"?{name:a,note:""}:a)}))),q(s)}catch(r){pe(r.message)}finally{y(!1)}},z=(r,s,t="",a=k,l=m)=>{const n=[...l];n[r].candidates.some(d=>d.name===s)||(n[r].candidates.push({name:s,note:t}),n[r].type==="date"&&n[r].candidates.sort((d,c)=>new Date(d.name.split(" ")[0]).getTime()-new Date(c.name.split(" ")[0]).getTime()),a(n))},X=(r,s,t=k,a=m)=>{const l=[...a];l[r].candidates.splice(s,1),t(l)},je=(r,s,t,a)=>{const l=`${r.getFullYear()}/${r.getMonth()+1}/${r.getDate()} (${["日","月","火","水","木","金","土"][r.getDay()]})`,n=N?`${l} ${p.start}〜${p.end}`:l;z(s,n,"",t,a)},we=async()=>{if(!T.trim()){alert("イベント名を入力してください");return}if(m[0].candidates.length===0){alert("日程候補を少なくとも1つ選択してください");return}y(!0);try{const s=await(await fetch("./backend/schedule_api.php?action=create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:T,description:J,deadline:B,polls:m,password:F})})).json();if(s.status==="success"){const t=window.location.href.split("?")[0];window.location.href=`${t}?id=${s.id}&token=${s.admin_token}`}}catch{alert("作成に失敗しました")}finally{y(!1)}},ve=async()=>{if(o){if(C){w(!0),b(JSON.parse(JSON.stringify(o)));return}if(!o.has_password){Q("");return}D(!0)}},Q=async r=>{try{const t=await(await fetch("./backend/schedule_api.php?action=auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,password:r})})).json();t.status==="success"?(Z(t.admin_token),D(!1),K(""),w(!0),b(JSON.parse(JSON.stringify(o)))):alert(t.error||"認証に失敗しました")}catch{alert("通信エラーが発生しました")}},Ne=(r,s)=>{if(!i)return;const t=[...i.polls],a=`${r.getFullYear()}/${r.getMonth()+1}/${r.getDate()} (${["日","月","火","水","木","金","土"][r.getDay()]})`,l=N?`${a} ${p.start}〜${p.end}`:a;t[s].candidates.some(n=>n.name===l)||(t[s].candidates.push({name:l,note:""}),t[s].candidates.sort((n,d)=>new Date(n.name.split(" ")[0]).getTime()-new Date(d.name.split(" ")[0]).getTime()),b({...i,polls:t}))},I=(r,s)=>{if(!i)return;const t=[...i.polls];t[r].candidates.splice(s,1),b({...i,polls:t})},Ce=async()=>{if(!(!i||!C)){if(!i.title.trim()){alert("タイトルは必須です");return}y(!0);try{(await fetch("./backend/schedule_api.php?action=update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,token:C,title:i.title,description:i.description,deadline:i.deadline,polls:i.polls})})).ok?(alert("イベントを更新しました"),w(!1),A()):alert("更新に失敗しました")}catch{alert("通信エラー")}finally{y(!1)}}},Se=async()=>{if(confirm(`本当にこのイベントを削除しますか？
この操作は取り消せません。`))try{await fetch("./backend/schedule_api.php?action=delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,token:C})});const r=window.location.href.split("?")[0];window.location.href=r}catch{alert("削除失敗")}},ze=()=>{if(!o)return;const r={};o.polls.forEach(s=>{r[s.id]=s.candidates.map(()=>({status:2,comment:""}))}),M(r),O({name:"",comment:""}),_(!0)},$e=async()=>{if(!f.name.trim()){alert("名前を入力してください");return}y(!0);try{(await fetch("./backend/schedule_api.php?action=answer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:h,name:f.name,comment:f.comment,selections:S})})).ok?(_(!1),A()):alert("保存に失敗しました")}catch{alert("通信エラー")}finally{y(!1)}},Te=(r,s)=>{const t=r.candidates[s];try{const a=t.name.split(" ")[0],l=t.name.match(/(\d{1,2}:\d{2})/g);let n=a.replace(/\//g,"")+"T000000",d=a.replace(/\//g,"")+"T235959";if(l&&l.length>=1)if(n=a.replace(/\//g,"")+"T"+l[0].replace(":","")+"00",l.length>=2)d=a.replace(/\//g,"")+"T"+l[1].replace(":","")+"00";else{const g=new Date(a+" "+l[0]);g.setHours(g.getHours()+1),d=g.getFullYear()+String(g.getMonth()+1).padStart(2,"0")+String(g.getDate()).padStart(2,"0")+"T"+String(g.getHours()).padStart(2,"0")+String(g.getMinutes()).padStart(2,"0")+"00"}const c=`https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent((o==null?void 0:o.title)||"予定")}&dates=${n}/${d}&details=${encodeURIComponent((o==null?void 0:o.description)||"")}`;window.open(c,"_blank")}catch{alert("日時形式の解析に失敗しました")}},Pe=r=>r.startsWith("http://")||r.startsWith("https://"),Ee=(r,s)=>{if(!o)return{o:0,tri:0,x:0,isPerfect:!1};let t=0,a=0,l=0;o.answers.forEach(d=>{var g,te;const c=(te=(g=d.selections[r.id])==null?void 0:g[s])==null?void 0:te.status;c===2?t++:c===1?a++:l++});const n=o.answers.length>0&&l===0&&t>0;return{o:t,tri:a,x:l,isPerfect:n}},L=r=>r.candidates.map((s,t)=>({...s,originalIndex:t,stats:Ee(r,t)})).filter(s=>j==="perfect"?s.stats.isPerfect:j==="possible"?s.stats.x===0&&o.answers.length>0:!0),ee=({onSelect:r})=>{const s=W.getFullYear(),t=W.getMonth(),a=new Date(s,t,1).getDay(),l=new Date(s,t+1,0).getDate(),n=[];for(let d=0;d<a;d++)n.push(null);for(let d=1;d<=l;d++)n.push(new Date(s,t,d));return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("button",{onClick:()=>H(new Date(s,t-1,1)),className:"p-1 text-gray-600 dark:text-gray-300",children:e.jsx(Fe,{size:20})}),e.jsxs("span",{className:"font-bold text-sm text-gray-800 dark:text-white",children:[s,"年 ",t+1,"月"]}),e.jsx("button",{onClick:()=>H(new Date(s,t+1,1)),className:"p-1 text-gray-600 dark:text-gray-300",children:e.jsx(ne,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center mb-1 text-[10px] font-bold text-gray-500",children:[e.jsx("div",{className:"text-red-500",children:"日"}),e.jsx("div",{children:"月"}),e.jsx("div",{children:"火"}),e.jsx("div",{children:"水"}),e.jsx("div",{children:"木"}),e.jsx("div",{children:"金"}),e.jsx("div",{className:"text-blue-500",children:"土"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:n.map((d,c)=>e.jsx("button",{disabled:!d,onClick:()=>d&&(r==null?void 0:r(d)),className:`aspect-square rounded-md flex items-center justify-center text-xs font-bold transition-all ${d?"bg-white dark:bg-gray-700 hover:bg-teal-100 dark:hover:bg-teal-900/50 shadow-sm text-gray-700 dark:text-gray-200":"invisible"}`,children:d==null?void 0:d.getDate()},c))}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold mb-2 cursor-pointer text-gray-600 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:d=>he(d.target.checked),className:"rounded text-teal-600 focus:ring-teal-500"}),"時間を指定"]}),N&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"time",value:p.start,onChange:d=>Y({...p,start:d.target.value}),className:"p-1.5 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full"}),e.jsx("span",{className:"text-gray-400",children:"~"}),e.jsx("input",{type:"time",value:p.end,onChange:d=>Y({...p,end:d.target.value}),className:"p-1.5 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full"})]})]})]})};if(h){if(P&&!o)return e.jsxs("div",{className:"p-10 text-center",children:[e.jsx("div",{className:"animate-spin text-teal-500 text-4xl mx-auto mb-4",children:"C"}),"読み込み中..."]});if(!o)return e.jsx("div",{className:"p-10 text-center text-red-500",children:"イベントが見つかりません"});const r=o.polls[0],s=L(r);return e.jsxs("div",{className:`mx-auto max-w-5xl pb-20 ${$?"p-2":"space-y-6"}`,children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-10 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-black text-gray-800 dark:text-white mb-2",children:o.title}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs md:text-sm whitespace-pre-wrap",children:o.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>{const t=window.location.href.split("&token")[0];navigator.clipboard.writeText(t),V(!0),setTimeout(()=>V(!1),2e3)},className:"flex items-center gap-2 px-4 py-2 bg-teal-100 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300 rounded-xl font-bold text-xs hover:bg-teal-200 transition-colors",children:[ke?e.jsx(_e,{size:14}):e.jsx(Oe,{size:14})," URLコピー"]}),e.jsxs("button",{onClick:ve,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-xl font-bold text-xs hover:bg-gray-200 transition-colors",children:[e.jsx(se,{size:14})," 幹事メニュー"]})]})]}),o.deadline&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-full text-[10px] font-bold mb-6",children:[e.jsx(Me,{size:12})," 期限: ",o.deadline.replace("T"," ")]}),e.jsxs("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-1 no-scrollbar",children:[e.jsx("button",{onClick:()=>E("all"),className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${j==="all"?"bg-teal-600 text-white shadow-md":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:"全表示"}),e.jsxs("button",{onClick:()=>E("perfect"),className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${j==="perfect"?"bg-orange-500 text-white shadow-md":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:[e.jsx(ie,{size:12,fill:"currentColor"})," 全員〇"]}),e.jsxs("button",{onClick:()=>E("possible"),className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${j==="possible"?"bg-blue-500 text-white shadow-md":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:[e.jsx(Je,{size:12})," 〇/△のみ"]})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-2xl relative max-h-[60vh] bg-white dark:bg-dark-lighter",children:e.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[e.jsxs("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0 z-30 shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 min-w-[120px] border-b border-r dark:border-gray-700 sticky left-0 bg-gray-50 dark:bg-gray-800 z-40 font-bold text-xs shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"参加者 / 候補"}),s.map(t=>e.jsxs("th",{className:`p-2 min-w-[100px] border-b border-r dark:border-gray-700 font-bold text-center relative group text-xs whitespace-normal ${t.stats.isPerfect?"bg-orange-50 dark:bg-orange-900/20":""}`,children:[t.stats.isPerfect&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-orange-400"}),e.jsx("div",{className:"text-gray-800 dark:text-white px-1",children:t.name}),t.note&&e.jsx("div",{className:"text-[10px] text-gray-500 font-normal mt-1 truncate",children:t.note}),e.jsx("button",{onClick:()=>Te(r,t.originalIndex),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 text-gray-400 hover:text-blue-500 p-1",children:e.jsx(Be,{size:12})})]},t.originalIndex))]}),e.jsxs("tr",{className:"bg-teal-50 dark:bg-teal-900/20 sticky top-[calc(100%-2rem)] z-30",children:[e.jsx("th",{className:"p-2 border-b border-r border-teal-100 dark:border-teal-900 sticky left-0 bg-teal-50 dark:bg-teal-900/20 z-40 text-teal-800 dark:text-teal-200 font-bold text-right text-xs shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"回答"}),s.map(t=>e.jsxs("td",{className:`p-2 border-b border-r border-teal-100 dark:border-teal-900 text-center font-bold text-teal-700 dark:text-teal-300 text-xs ${t.stats.isPerfect?"bg-orange-100/50 dark:bg-orange-900/40":""}`,children:["〇",t.stats.o," / △",t.stats.tri]},t.originalIndex))]})]}),e.jsx("tbody",{children:o.answers.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:s.length+1,className:"p-8 text-center text-gray-400 text-xs",children:"まだ回答がありません"})}):o.answers.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsxs("td",{className:"p-3 border-b border-r dark:border-gray-700 sticky left-0 bg-white dark:bg-dark-lighter z-20 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:[e.jsx("div",{className:"font-bold text-gray-800 dark:text-gray-200 text-xs",children:t.name}),t.comment&&e.jsxs("div",{className:"text-[10px] text-gray-500 mt-0.5 flex items-center gap-1",children:[e.jsx(oe,{size:8})," ",t.comment]})]}),s.map(a=>{var c;const l=(c=t.selections[r.id])==null?void 0:c[a.originalIndex],n=l==null?void 0:l.status,d=l==null?void 0:l.comment;return e.jsx("td",{className:`p-2 border-b border-r dark:border-gray-700 text-center relative group ${a.stats.isPerfect?"bg-orange-50/30 dark:bg-orange-900/10":""}`,children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[n===2?e.jsx(le,{className:"text-red-500 fill-red-50 dark:fill-red-900/30",size:18}):n===1?e.jsx(ce,{className:"text-yellow-500 fill-yellow-50 dark:fill-yellow-900/30",size:18}):e.jsx(u,{className:"text-gray-300",size:18}),d&&e.jsx("div",{className:"absolute bottom-0 right-0 text-gray-400",children:e.jsx(oe,{size:10,className:"text-blue-400"})}),d&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-32 bg-gray-900 text-white text-[10px] rounded p-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50",children:d})]})},a.originalIndex)})]},t.id))})]})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("button",{onClick:ze,className:"bg-teal-600 text-white px-8 py-3 rounded-full font-black text-sm md:text-base shadow-xl hover:bg-teal-700 hover:scale-105 transition-all flex items-center justify-center gap-2 mx-auto",children:[e.jsx(ae,{strokeWidth:3,size:18})," 出欠を入力する"]})})]}),o.polls.length>1&&o.polls.slice(1).map(t=>e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(de,{className:"text-blue-500",size:18})," ",t.title]}),e.jsxs("div",{className:"space-y-3",children:[L(t).map(a=>e.jsxs("div",{className:`flex flex-col md:flex-row md:items-center justify-between p-3 rounded-xl border border-gray-200 dark:border-gray-700 gap-2 ${a.stats.isPerfect?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800":"bg-gray-50 dark:bg-gray-800"}`,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.stats.isPerfect&&e.jsx(ie,{size:14,className:"text-orange-500 fill-orange-500"}),e.jsx("span",{className:"font-bold text-sm text-gray-700 dark:text-gray-200",children:a.name})]}),a.note&&(Pe(a.note)?e.jsxs("a",{href:a.note,target:"_blank",rel:"noreferrer",className:"text-[10px] text-blue-500 hover:underline break-all flex items-center gap-1 mt-1",children:[e.jsx(We,{size:10})," ",a.note]}):e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1",children:a.note}))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500",children:"回答:"}),e.jsxs("span",{className:"text-sm font-black text-teal-600 dark:text-teal-400",children:["〇",a.stats.o," / △",a.stats.tri]})]})]},a.originalIndex)),L(t).length===0&&e.jsx("div",{className:"text-center text-xs text-gray-400 p-4",children:"該当する候補がありません"})]})]},t.id)),fe&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-2xl max-h-[90vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white",children:"出欠を入力"}),e.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(u,{size:20})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto flex-1 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500",children:["お名前 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:f.name,onChange:t=>O({...f,name:t.target.value}),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-bold text-base focus:border-teal-500 outline-none",placeholder:"山田 太郎"})]}),o.polls.map(t=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-bold text-sm text-gray-700 dark:text-gray-300 border-l-4 border-teal-500 pl-2",children:t.title}),e.jsx("div",{className:"space-y-2",children:t.candidates.map((a,l)=>{var d;const n=((d=S[t.id])==null?void 0:d[l])||{status:1,comment:""};return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 p-2 rounded-xl bg-gray-50 dark:bg-gray-700/50 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-xs text-gray-800 dark:text-white",children:a.name}),a.note&&e.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[200px]",children:a.note})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex bg-white dark:bg-gray-800 rounded-lg p-1 border dark:border-gray-600 shadow-sm shrink-0",children:[{val:2,icon:le,color:"text-red-500"},{val:1,icon:ce,color:"text-yellow-500"},{val:0,icon:u,color:"text-gray-400"}].map(c=>e.jsx("button",{onClick:()=>{const g={...S};g[t.id][l]={...n,status:c.val},M(g)},className:`p-1.5 rounded-md transition-all ${n.status===c.val?"bg-gray-100 dark:bg-gray-600 "+c.color:"text-gray-300"}`,children:e.jsx(c.icon,{size:18,fill:n.status===c.val?"currentColor":"none",fillOpacity:.2})},c.val))}),e.jsx("input",{type:"text",placeholder:"コメント",value:n.comment,onChange:c=>{const g={...S};g[t.id][l]={...n,comment:c.target.value},M(g)},className:"flex-1 sm:w-32 p-2 rounded-lg border dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-xs"})]})]},l)})})]},t.id)),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"全体コメント"}),e.jsx("textarea",{value:f.comment,onChange:t=>O({...f,comment:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm h-20",placeholder:"遅れる可能性があります、等"})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900",children:e.jsx("button",{onClick:$e,className:"w-full py-3 bg-teal-600 text-white font-black rounded-xl shadow-lg hover:bg-teal-700 transition-all text-sm",children:"回答を保存する"})})]})}),ye&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-sm rounded-3xl shadow-2xl p-6 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white mb-4",children:"幹事ログイン"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"このイベントにはパスワードが設定されています。"}),e.jsx("input",{type:"password",value:G,onChange:t=>K(t.target.value),className:"w-full p-3 mb-4 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"パスワード"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-2 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-xl font-bold text-sm",children:"キャンセル"}),e.jsx("button",{onClick:()=>Q(G),className:"flex-1 py-2 bg-teal-600 text-white rounded-xl font-bold text-sm",children:"認証"})]})]})}),ue&&i&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-2xl max-h-[90vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900",children:[e.jsxs("h3",{className:"font-bold text-lg text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(se,{size:18})," 幹事用メニュー"]}),e.jsx("button",{onClick:()=>w(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(u,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"イベント名"}),e.jsx("input",{type:"text",value:i.title,onChange:t=>b({...i,title:t.target.value}),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"詳細 / メモ"}),e.jsx("textarea",{value:i.description,onChange:t=>b({...i,description:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm h-20 resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"回答期限"}),e.jsx("input",{type:"datetime-local",value:i.deadline||"",onChange:t=>b({...i,deadline:t.target.value}),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"})]})]}),e.jsx("hr",{className:"border-gray-100 dark:border-gray-800"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-bold text-base text-gray-700 dark:text-gray-300",children:"アンケート項目の編集"}),i.polls.map((t,a)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-xl border border-gray-100 dark:border-gray-700",children:[e.jsx("input",{type:"text",value:t.title,onChange:l=>{const n=[...i.polls];n[a].title=l.target.value,b({...i,polls:n})},className:"w-full bg-transparent border-b border-gray-300 dark:border-gray-600 py-1 font-bold text-base focus:border-teal-500 outline-none text-gray-800 dark:text-white mb-3"}),t.type==="date"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 p-2 rounded-xl border border-gray-200 dark:border-gray-600",children:e.jsx(ee,{onSelect:l=>Ne(l,a)})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase mb-2 block",children:"現在の候補"}),e.jsxs("div",{className:"space-y-1.5 max-h-40 overflow-y-auto pr-1 custom-scrollbar",children:[t.candidates.map((l,n)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsx("span",{className:"font-mono font-bold text-sm text-gray-700 dark:text-gray-200",children:l.name}),e.jsx("button",{onClick:()=>I(a,n),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(u,{size:14})})]},n)),t.candidates.length===0&&e.jsx("div",{className:"text-gray-400 text-xs p-2 text-center",children:"カレンダーの日付をクリックして追加"})]})]})]}):e.jsxs("div",{className:"space-y-2",children:[t.candidates.map((l,n)=>e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 bg-white dark:bg-gray-700 p-2 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsx("input",{type:"text",value:l.name,onChange:d=>{const c=[...i.polls];c[a].candidates[n].name=d.target.value,b({...i,polls:c})},className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"候補名"}),e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsx("input",{type:"text",value:l.note,onChange:d=>{const c=[...i.polls];c[a].candidates[n].note=d.target.value,b({...i,polls:c})},className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"備考・URL"}),e.jsx("button",{onClick:()=>I(a,n),className:"text-gray-400 hover:text-red-500 p-2",children:e.jsx(u,{size:16})})]})]},n)),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-2 bg-white dark:bg-gray-700 p-2 rounded-lg border border-dashed border-gray-300 dark:border-gray-600",children:[e.jsx("input",{type:"text",id:`new-cand-name-${a}`,className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"新しい候補名"}),e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsx("input",{type:"text",id:`new-cand-note-${a}`,className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"備考・URL"}),e.jsx("button",{onClick:()=>{const l=document.getElementById(`new-cand-name-${a}`),n=document.getElementById(`new-cand-note-${a}`);if(l.value){const d=[...i.polls];d[a].candidates.push({name:l.value,note:n.value}),b({...i,polls:d}),l.value="",n.value=""}},className:"px-3 bg-teal-600 text-white rounded text-xs font-bold whitespace-nowrap",children:"追加"})]})]})]})]},t.id))]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-red-500 font-bold mb-2",children:"危険な操作"}),e.jsx("button",{onClick:Se,className:"w-full py-3 bg-red-50 dark:bg-red-900/20 text-red-600 border border-red-200 dark:border-red-800 rounded-xl font-bold text-sm hover:bg-red-100 transition-colors",children:"イベントを削除する"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900 flex gap-4",children:[e.jsx("button",{onClick:()=>w(!1),className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors",children:"キャンセル"}),e.jsx("button",{onClick:Ce,className:"flex-1 py-3 bg-teal-600 text-white font-black rounded-xl shadow-lg hover:bg-teal-700 transition-all text-sm",children:"変更を保存"})]})]})}),!$&&e.jsx(re,{})]})}return e.jsxs("div",{className:"max-w-4xl mx-auto pb-20 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-black text-gray-800 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx(Ae,{className:"text-teal-600"}),"新規イベント作成"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:["イベント名 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:T,onChange:r=>xe(r.target.value),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-bold text-base focus:border-teal-500 outline-none",placeholder:"例: 開発部 歓迎会"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"詳細 / メモ"}),e.jsx("textarea",{value:J,onChange:r=>ge(r.target.value),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm h-20 resize-none",placeholder:"場所や予算など..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"回答期限 (任意)"}),e.jsx("input",{type:"datetime-local",value:B,onChange:r=>be(r.target.value),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"幹事用パスワード (任意)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{size:16,className:"text-gray-400"}),e.jsx("input",{type:"password",value:F,onChange:r=>me(r.target.value),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",placeholder:"編集・削除時に必要"})]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"設定しない場合、URLを知っている全員が編集可能になります。"})]})]}),e.jsx("hr",{className:"border-gray-100 dark:border-gray-800"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-base md:text-lg flex items-center gap-2",children:"アンケート設定"}),m.map((r,s)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-2xl border border-gray-100 dark:border-gray-700 relative",children:[s>0&&e.jsx("button",{onClick:()=>{const t=[...m];t.splice(s,1),k(t)},className:"absolute top-3 right-3 text-gray-400 hover:text-red-500",children:e.jsx(Ye,{size:16})}),e.jsxs("div",{className:"mb-4 pr-6",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"質問タイトル"}),e.jsx("input",{type:"text",value:r.title,onChange:t=>{const a=[...m];a[s].title=t.target.value,k(a)},className:"w-full bg-transparent border-b border-gray-300 dark:border-gray-600 py-1 font-bold text-base focus:border-teal-500 outline-none text-gray-800 dark:text-white"})]}),r.type==="date"?e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"shrink-0 w-full md:w-auto",children:e.jsx(ee,{onSelect:t=>je(t,s,k,m)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase mb-2",children:"選択された候補"}),e.jsxs("div",{className:"space-y-1.5 max-h-60 overflow-y-auto pr-1 custom-scrollbar",children:[r.candidates.map((t,a)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsx("span",{className:"font-mono font-bold text-sm text-gray-700 dark:text-gray-200",children:t.name}),e.jsx("button",{onClick:()=>X(s,a),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(u,{size:14})})]},a)),r.candidates.length===0&&e.jsx("div",{className:"text-gray-400 text-xs p-4 text-center border-2 border-dashed border-gray-200 rounded-xl",children:"カレンダーの日付をクリックして追加"})]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-2 bg-white dark:bg-gray-700 p-3 rounded-xl border border-gray-100 dark:border-gray-600",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",id:`cand-input-${s}`,className:"flex-1 p-2 rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",placeholder:"候補を入力 (例: イタリアン)",onKeyDown:t=>{if(t.key==="Enter"){const a=document.getElementById(`cand-note-${s}`);z(s,t.currentTarget.value,a.value),t.currentTarget.value="",a.value=""}}}),e.jsx("button",{onClick:()=>{const t=document.getElementById(`cand-input-${s}`),a=document.getElementById(`cand-note-${s}`);z(s,t.value,a.value),t.value="",a.value=""},className:"bg-teal-600 text-white px-3 py-1 rounded-lg font-bold text-xs",children:"追加"})]}),e.jsx("input",{type:"text",id:`cand-note-${s}`,className:"w-full p-2 rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-xs",placeholder:"備考・URL (任意)",onKeyDown:t=>{if(t.key==="Enter"){const a=document.getElementById(`cand-input-${s}`);z(s,a.value,t.currentTarget.value),a.value="",t.currentTarget.value=""}}})]}),e.jsx("div",{className:"space-y-1.5",children:r.candidates.map((t,a)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-bold text-sm text-gray-800 dark:text-gray-200 truncate",children:t.name}),t.note&&e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 truncate",children:t.note})]}),e.jsx("button",{onClick:()=>X(s,a),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(u,{size:14})})]},a))})]})]},r.id)),e.jsxs("button",{onClick:()=>k([...m,{id:`p${Date.now()}`,type:"text",title:"お店・場所など",candidates:[]}]),className:"w-full py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-500 font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center justify-center gap-2 text-sm",children:[e.jsx(ae,{size:16})," 別のアンケート項目を追加 (場所など)"]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:we,disabled:P,className:"w-full py-4 bg-teal-600 text-white font-black text-lg rounded-2xl shadow-xl hover:bg-teal-700 transition-all flex items-center justify-center gap-2",children:[P?"作成中...":"イベントを作成する"," ",e.jsx(ne,{size:20})]})})]})]}),e.jsxs("article",{className:"p-6 bg-white dark:bg-dark-lighter rounded-3xl border border-gray-100 dark:border-gray-700 prose dark:prose-invert max-w-none shadow-sm",children:[e.jsxs("h2",{className:"text-lg font-black flex items-center gap-2 mb-4",children:[e.jsx(de,{className:"text-teal-500",size:20}),"「まいつーる日程調整」の特長"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-xs leading-relaxed text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-2 flex items-center gap-2",children:[e.jsx(Le,{size:16,className:"text-teal-500"}),"ログイン不要で即作成"]}),e.jsx("p",{children:"面倒な会員登録は一切不要。思い立ったらすぐにイベントページを作成し、URLをLINEやSlackで共有するだけで調整がスタートします。回答もスマホからサクサク行えます。"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-2 flex items-center gap-2",children:[e.jsx(Ue,{size:16,className:"text-teal-500"}),"細かいニュアンスも伝わる"]}),e.jsx("p",{children:"単なる○✕だけでなく、日程ごとにコメントを残せるため、「19時以降なら○」「場所によっては△」といった細かい条件もスムーズに共有できます。"})]})]})]}),!$&&e.jsx(re,{})]})};export{dt as default};
