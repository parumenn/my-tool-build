import{c as x,r as g,j as t}from"./index-DZMj0xXg.js";import{T as Y}from"./trash-2-DL_Za1JS.js";import{C as ee}from"./chevron-right-BJrwil0Z.js";import{C as te}from"./code-DUM1rRme.js";import{L as re}from"./link-CNiWdR5d.js";import{P as oe}from"./palette-SukFtMCn.js";import{E as ae}from"./eraser-CLB29-ZS.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=x("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=x("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=x("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=x("Heading",[["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M6 20V4",key:"1w1bmo"}],["path",{d:"M18 20V4",key:"o2hl4u"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=x("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=x("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=x("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=x("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),ue=[{color:"#000000",label:"黒"},{color:"#4B5563",label:"グレー"},{color:"#EF4444",label:"赤"},{color:"#F59E0B",label:"オレンジ"},{color:"#10B981",label:"緑"},{color:"#3B82F6",label:"青"},{color:"#8B5CF6",label:"紫"}],ke=()=>{var V;const[h,k]=g.useState(()=>{const e=localStorage.getItem("maitool_notes");return e?JSON.parse(e):[{id:"1",title:"Welcome Note",content:`<div><b>ようこそ！</b></div><div>高機能なオンラインメモ帳へ。</div><ul><li>リッチテキスト対応</li><li>Tabキーでインデント</li></ul><pre><code>// コードブロックの例
console.log("Hello World");</code></pre><details open><summary>トグルの例</summary><div><ul><li>Enter連打で脱出可能</li><li>空の状態でBackspaceで削除</li></ul></div></details>`,updated:new Date().toLocaleString()}]}),[b,j]=g.useState(((V=h[0])==null?void 0:V.id)||""),[S,D]=g.useState(!1),[I,C]=g.useState(!1),[L,N]=g.useState(""),[v,R]=g.useState(""),w=g.useRef(null),l=g.useRef(null),T=g.useRef(null),y=g.useRef(null);g.useEffect(()=>{localStorage.setItem("maitool_notes",JSON.stringify(h))},[h]),g.useEffect(()=>{if(l.current){const e=h.find(o=>o.id===b);e?l.current.innerHTML!==e.content&&(l.current.innerHTML=e.content,requestAnimationFrame(()=>z(!0))):l.current.innerHTML=""}},[b]),g.useEffect(()=>(y.current&&clearTimeout(y.current),y.current=window.setTimeout(()=>{z(!1)},1500),()=>{y.current&&clearTimeout(y.current)}),[h]);const E=h.find(e=>e.id===b),F=e=>{k(o=>o.map(r=>r.id===b?{...r,title:e,updated:new Date().toLocaleString()}:r))},d=()=>{if(l.current){const e=l.current.innerHTML;T.current&&clearTimeout(T.current),T.current=window.setTimeout(()=>{k(o=>o.map(r=>r.id===b?{...r,content:e,updated:new Date().toLocaleString()}:r))},1e3)}},H=e=>{for(;e&&e!==l.current;){if(e.nodeType===1&&["DIV","P","LI","H1","H2","H3","BLOCKQUOTE"].includes(e.tagName))return e;e=e.parentNode}return null},P=e=>{var o;if(e.key==="Tab"){e.preventDefault();const r=window.getSelection();if(!(r!=null&&r.rangeCount))return;const a=r.anchorNode,n=(a==null?void 0:a.nodeType)===1?a:a==null?void 0:a.parentElement;(n==null?void 0:n.closest("pre"))?document.execCommand("insertText",!1,"  "):document.execCommand(e.shiftKey?"outdent":"indent"),d();return}if(e.key==="Enter"){const r=window.getSelection();if(!(r!=null&&r.rangeCount))return;const a=r.anchorNode,n=(a==null?void 0:a.nodeType)===1?a:a==null?void 0:a.parentElement,s=n==null?void 0:n.closest("details");if(s){if(n==null?void 0:n.closest("summary")){e.preventDefault(),s.open||(s.open=!0);let p=Array.from(s.children).find(X=>X.tagName==="DIV");p||(p=document.createElement("div"),p.innerHTML="<div><br></div>",s.appendChild(p));const f=document.createRange();f.selectNodeContents(p),f.collapse(!0),r.removeAllRanges(),r.addRange(f);return}const i=H(a);if(i&&i.innerText.trim()===""&&!i.querySelector("img")){e.preventDefault(),i.remove();const p=document.createElement("div");p.innerHTML="<br>",s.insertAdjacentElement("afterend",p);const f=document.createRange();f.setStart(p,0),f.collapse(!0),r.removeAllRanges(),r.addRange(f),d();return}}}if(e.key==="Backspace"){const r=window.getSelection();if(r!=null&&r.isCollapsed){const a=r.anchorNode,n=(a==null?void 0:a.nodeType)===1?a:a==null?void 0:a.parentElement,s=n==null?void 0:n.closest("summary");if(s&&((o=s.textContent)==null?void 0:o.trim())===""){e.preventDefault();const c=s.parentElement,i=document.createElement("div");i.innerHTML="<br>",c==null||c.replaceWith(i);const m=document.createRange();m.setStart(i,0),m.collapse(!0),r.removeAllRanges(),r.addRange(m),d();return}}}},z=(e=!1)=>{if(l.current&&window.hljs){const o=l.current.querySelectorAll("pre code"),r=window.getSelection();o.forEach(a=>{var c;const n=a;let s=!1;if(!e&&r&&r.anchorNode&&((c=l.current)!=null&&c.contains(r.anchorNode))&&(s=a.contains(r.anchorNode)),!s){const i=n.innerText,m=n.getAttribute("data-len");(e||m!==String(i.length)||!n.hasAttribute("data-highlighted"))&&(n.textContent=i,n.removeAttribute("data-highlighted"),window.hljs.highlightElement(n),n.setAttribute("data-highlighted","yes"),n.setAttribute("data-len",String(i.length)))}})}},O=e=>{const o=e.clipboardData.getData("text/plain");/^(http|https):\/\/[^ "]+$/.test(o)&&(e.preventDefault(),document.execCommand("insertHTML",!1,`<a href="${o}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${o}</a>`),d())},U=()=>{const e=Date.now().toString(),o={id:e,title:"無題のメモ",content:"<div></div>",updated:new Date().toLocaleString()};k([o,...h]),j(e)},$=(e,o)=>{if(o.stopPropagation(),confirm("このメモを削除しますか？")){const r=h.filter(a=>a.id!==e);k(r),b===e&&r.length>0&&j(r[0].id)}},M=(e,o=void 0)=>{var r;document.execCommand(e,!1,o),(r=l.current)==null||r.focus(),d()},B=e=>{var a,n,s;const o=window.getSelection();if(!o||o.rangeCount===0)return;((n=(a=o.anchorNode)==null?void 0:a.parentElement)==null?void 0:n.closest(e))?document.execCommand("formatBlock",!1,"DIV"):document.execCommand("formatBlock",!1,e),(s=l.current)==null||s.focus(),d()},K=()=>{var n;const e=window.getSelection();if(!e||e.rangeCount===0)return;const o=e.anchorNode,r=(o==null?void 0:o.nodeType)===1?o:o==null?void 0:o.parentElement;(r==null?void 0:r.closest("blockquote"))?document.execCommand("formatBlock",!1,"DIV"):document.execCommand("formatBlock",!1,"BLOCKQUOTE"),(n=l.current)==null||n.focus(),d()},Q=()=>{const e=window.getSelection();e&&e.rangeCount>0?(w.current=e.getRangeAt(0).cloneRange(),N(e.toString())):(w.current=null,N("")),R("https://"),C(!0)},_=()=>{if(l.current){l.current.focus();const e=window.getSelection();e&&(e.removeAllRanges(),w.current&&e.addRange(w.current))}if(v){const o=`<a href="${v}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${L||v}</a>`;document.execCommand("insertHTML",!1,o),d()}C(!1)},W=()=>{var s;const e=window.getSelection();if(!e||!e.rangeCount)return;if(e.isCollapsed){const c=e.anchorNode,i=H(c);if(i){const m=document.createRange();m.selectNode(i),e.removeAllRanges(),e.addRange(m)}else if(c&&c.parentNode===l.current&&c.nodeType===3){const m=document.createRange();m.selectNode(c),e.removeAllRanges(),e.addRange(m)}}const n=`<pre><code class="language-javascript">${(((s=window.getSelection())==null?void 0:s.toString())||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")||"// コードを入力"}</code></pre><p><br/></p>`;document.execCommand("insertHTML",!1,n),d()},J=()=>{document.execCommand("insertHTML",!1,"<details><summary>トグル見出し</summary><div>詳細内容をここに記述</div></details><p><br/></p>"),d()},Z=()=>{document.execCommand("insertHTML",!1,'<div><input type="checkbox" style="margin-right: 5px;"> TODOアイテム</div>'),d()},G=()=>{document.execCommand("removeFormat"),document.execCommand("formatBlock",!1,"DIV"),d()},A=e=>{M("foreColor",e),D(!1)},u=e=>{e.preventDefault()};return t.jsxs("div",{className:"h-[calc(100vh-140px)] flex flex-col md:flex-row gap-6 relative",children:[I&&t.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm rounded-2xl",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 w-80 animate-fade-in",children:[t.jsx("h3",{className:"font-bold text-gray-800 dark:text-white mb-4",children:"リンクを挿入"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"表示テキスト"}),t.jsx("input",{type:"text",value:L,onChange:e=>N(e.target.value),className:"w-full p-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",placeholder:"リンクのタイトル"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"URL"}),t.jsx("input",{type:"text",value:v,onChange:e=>R(e.target.value),className:"w-full p-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",placeholder:"https://example.com"})]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsx("button",{onClick:()=>C(!1),className:"flex-1 py-2 text-sm font-bold text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"キャンセル"}),t.jsx("button",{onClick:_,className:"flex-1 py-2 text-sm font-bold bg-blue-600 text-white hover:bg-blue-700 rounded-lg shadow",children:"挿入"})]})]})]})}),t.jsxs("div",{className:"w-full md:w-64 bg-white dark:bg-dark-lighter rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col overflow-hidden shrink-0",children:[t.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[t.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-200",children:"メモ一覧"}),t.jsx("button",{onClick:U,className:"text-lime-600 hover:bg-lime-50 dark:hover:bg-lime-900/30 p-2 rounded-lg transition-colors",title:"新規メモ作成",children:t.jsx(le,{size:20})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:h.map(e=>t.jsxs("div",{onClick:()=>j(e.id),className:`p-3 rounded-xl cursor-pointer transition-colors group relative ${b===e.id?"bg-lime-50 dark:bg-lime-900/20 border border-lime-200 dark:border-lime-800":"hover:bg-gray-50 dark:hover:bg-gray-800 border border-transparent"}`,children:[t.jsx("div",{className:"font-bold text-gray-800 dark:text-gray-200 truncate pr-6",children:e.title||"無題"}),t.jsx("div",{className:"text-xs text-gray-400 mt-1",children:e.updated}),t.jsx("button",{onClick:o=>$(e.id,o),className:"absolute right-2 top-3 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsx(Y,{size:14})})]},e.id))})]}),t.jsx("div",{className:"flex-1 bg-white dark:bg-dark-lighter rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col overflow-hidden",children:E?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex flex-col gap-2",children:[t.jsx("input",{type:"text",value:E.title,onChange:e=>F(e.target.value),className:"w-full text-2xl font-bold bg-transparent border-none focus:ring-0 text-gray-800 dark:text-white placeholder-gray-300 outline-none",placeholder:"タイトルを入力"}),t.jsxs("div",{className:"flex flex-wrap gap-1 items-center bg-gray-50 dark:bg-gray-800 p-1.5 rounded-lg transition-all",children:[t.jsx("button",{onMouseDown:u,onClick:()=>M("bold"),className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300",title:"太字",children:t.jsx(ne,{size:16})}),t.jsx("div",{className:"w-px h-4 bg-gray-300 dark:bg-gray-600 mx-1"}),t.jsxs("button",{onMouseDown:u,onClick:()=>B("H2"),className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300 flex items-center gap-1",title:"大見出し (H2)",children:[t.jsx(q,{size:16}),t.jsx("span",{className:"text-xs font-bold",children:"L"})]}),t.jsxs("button",{onMouseDown:u,onClick:()=>B("H3"),className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300 flex items-center gap-1",title:"小見出し (H3)",children:[t.jsx(q,{size:14}),t.jsx("span",{className:"text-[10px] font-bold",children:"S"})]}),t.jsx("div",{className:"w-px h-4 bg-gray-300 dark:bg-gray-600 mx-1"}),t.jsx("button",{onMouseDown:u,onClick:()=>M("insertUnorderedList"),className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300",title:"箇条書き",children:t.jsx(ie,{size:16})}),t.jsx("button",{onMouseDown:u,onClick:Z,className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300",title:"ToDoリスト",children:t.jsx(ge,{size:16})}),t.jsx("button",{onMouseDown:u,onClick:J,className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300",title:"トグル (詳細)",children:t.jsx(ee,{size:16})}),t.jsx("div",{className:"w-px h-4 bg-gray-300 dark:bg-gray-600 mx-1"}),t.jsx("button",{onMouseDown:u,onClick:K,className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300",title:"引用",children:t.jsx(de,{size:16})}),t.jsx("button",{onMouseDown:u,onClick:W,className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300",title:"コードブロック挿入 (選択範囲を適用)",children:t.jsx(te,{size:16})}),t.jsx("button",{onMouseDown:u,onClick:Q,className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300",title:"リンク挿入",children:t.jsx(re,{size:16})}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onMouseDown:u,onClick:()=>D(!S),className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-600 dark:text-gray-300 flex items-center gap-1",title:"文字色",children:[t.jsx(oe,{size:16}),t.jsx(se,{size:10})]}),S&&t.jsxs("div",{className:"absolute top-full left-0 mt-1 p-2 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-100 dark:border-gray-700 z-50 grid grid-cols-4 gap-2 w-48 animate-fade-in",children:[ue.map(e=>t.jsx("button",{onMouseDown:u,onClick:()=>A(e.color),className:"w-8 h-8 rounded-full border border-gray-200 dark:border-gray-600 hover:scale-110 transition-transform",style:{backgroundColor:e.color},title:e.label},e.color)),t.jsx("div",{className:"relative w-8 h-8 rounded-full overflow-hidden border border-gray-200 dark:border-gray-600 hover:scale-110 transition-transform cursor-pointer bg-gradient-to-br from-pink-500 via-red-500 to-yellow-500",children:t.jsx("input",{type:"color",onChange:e=>A(e.target.value),className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full",title:"カスタム"})})]})]}),t.jsx("button",{onMouseDown:u,onClick:G,className:"p-1.5 hover:bg-white dark:hover:bg-gray-700 rounded text-gray-400 hover:text-red-500 ml-auto",title:"書式クリア",children:t.jsx(ae,{size:16})})]})]}),t.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[t.jsx("style",{children:`
                    .prose b, .prose strong { font-weight: bold !important; }
                    .prose details { 
                        border: 1px solid #e5e7eb; 
                        border-radius: 0.5rem; 
                        padding: 0.5rem; 
                        margin-bottom: 0.5rem; 
                        background-color: #f9fafb;
                    }
                    .dark .prose details { 
                        border-color: #374151; 
                        background-color: #1f2937;
                    }
                    .prose details > div {
                        margin-top: 0.5rem;
                        padding-left: 1rem;
                        border-left: 2px solid #e5e7eb;
                    }
                    .dark .prose details > div {
                        border-left-color: #4b5563;
                    }
                    .prose details:focus, .prose summary:focus { outline: none !important; }
                    .prose summary { cursor: pointer; font-weight: bold; list-style: none; }
                    .prose summary::-webkit-details-marker { display: none; }
                    .prose summary::before { content: '▶'; display: inline-block; margin-right: 0.5rem; transition: transform 0.2s; font-size: 0.8em; }
                    .prose details[open] summary::before { transform: rotate(90deg); }
                    .prose pre { padding: 1em; background: #1e1e1e; color: #d4d4d4; border-radius: 0.5rem; font-family: monospace; }
                    .prose code { color: inherit; background: transparent; font-family: monospace; }
                  `}),t.jsx("div",{ref:l,contentEditable:!0,onInput:d,onPaste:O,onKeyDown:P,className:"w-full h-full p-6 outline-none overflow-y-auto text-gray-800 dark:text-gray-200 prose dark:prose-invert max-w-none",style:{minHeight:"100%"},spellCheck:!1}),t.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-300 pointer-events-none flex items-center gap-1 bg-white/80 dark:bg-black/50 px-2 py-1 rounded",children:[t.jsx(ce,{size:12})," 自動保存済み"]})]})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:"メモを選択または作成してください"})})]})};export{ke as default};
