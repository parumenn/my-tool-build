import{c as re,r as i,a3 as Ne,j as e,m as Ce,a4 as Se,f as ze,X as j,P as K,a as V,a6 as Te,Z as Ee,g as $e}from"./index-DEUUqHcG.js";import{W as _e}from"./WorkspaceContext-n2IGn0iP.js";import{S as X}from"./settings-MLTJnz6c.js";import{a as De,C as Oe}from"./chevron-left-CBK-emJH.js";import{C as Q}from"./circle-DJYTgA8v.js";import{I}from"./info-CXQ6-mlj.js";import{L as Pe}from"./link-1aTLhnZh.js";import{L as Ae}from"./lock-r0K_ap43.js";import{T as Me}from"./trash-2-CnampOsv.js";import{C as ee}from"./chevron-right-BU1HvyMc.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=re("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=re("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]),Ve=()=>{const S=i.useContext(_e),[A]=Ne(),m=A.get("id"),w=A.get("token"),[z,se]=i.useState(""),[M,le]=i.useState(""),[L,de]=i.useState(""),[U,ne]=i.useState(""),[b,u]=i.useState([{id:"p1",type:"date",title:"日程候補",candidates:[]}]),[R,J]=i.useState(new Date),[f,B]=i.useState({start:"19:00",end:"21:00"}),[T,oe]=i.useState(!0),[n,W]=i.useState(null),[E,h]=i.useState(!1),[Le,ie]=i.useState(""),[v,H]=i.useState(w),[ce,$]=i.useState(!1),[q,F]=i.useState(""),[xe,k]=i.useState(!1),[c,p]=i.useState(null),[ge,_]=i.useState(!1),[y,D]=i.useState({name:"",comment:""}),[N,O]=i.useState({}),[Ue,Re]=i.useState(""),[be,Y]=i.useState(!1);i.useEffect(()=>{m?P():W(null)},[m]),i.useEffect(()=>{w&&H(w)},[w]);const P=async()=>{h(!0);try{const t=await fetch(`./backend/schedule_api.php?action=get&id=${m}`);if(!t.ok)throw new Error("イベントが見つかりません");const r=await t.json();r.polls&&(r.polls=r.polls.map(a=>({...a,candidates:a.candidates.map(s=>typeof s=="string"?{name:s,note:""}:s)}))),W(r)}catch(t){ie(t.message)}finally{h(!1)}},C=(t,r,a="",s=u,o=b)=>{const d=[...o];d[t].candidates.some(l=>l.name===r)||(d[t].candidates.push({name:r,note:a}),d[t].type==="date"&&d[t].candidates.sort((l,x)=>new Date(l.name.split(" ")[0]).getTime()-new Date(x.name.split(" ")[0]).getTime()),s(d))},Z=(t,r,a=u,s=b)=>{const o=[...s];o[t].candidates.splice(r,1),a(o)},me=(t,r,a,s)=>{const o=`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} (${["日","月","火","水","木","金","土"][t.getDay()]})`,d=T?`${o} ${f.start}〜${f.end}`:o;C(r,d,"",a,s)},he=async()=>{if(!z.trim()){alert("イベント名を入力してください");return}if(b[0].candidates.length===0){alert("日程候補を少なくとも1つ選択してください");return}h(!0);try{const r=await(await fetch("./backend/schedule_api.php?action=create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:z,description:M,deadline:L,polls:b,password:U})})).json();if(r.status==="success"){const a=window.location.href.split("?")[0];window.location.href=`${a}?id=${r.id}&token=${r.admin_token}`}}catch{alert("作成に失敗しました")}finally{h(!1)}},pe=async()=>{if(n){if(v){k(!0),p(JSON.parse(JSON.stringify(n)));return}if(!n.has_password){G("");return}$(!0)}},G=async t=>{try{const a=await(await fetch("./backend/schedule_api.php?action=auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:m,password:t})})).json();a.status==="success"?(H(a.admin_token),$(!1),F(""),k(!0),p(JSON.parse(JSON.stringify(n)))):alert(a.error||"認証に失敗しました")}catch{alert("通信エラーが発生しました")}},ye=async()=>{if(!(!c||!v)){if(!c.title.trim()){alert("タイトルは必須です");return}h(!0);try{(await fetch("./backend/schedule_api.php?action=update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:m,token:v,title:c.title,description:c.description,deadline:c.deadline,polls:c.polls})})).ok?(alert("イベントを更新しました"),k(!1),P()):alert("更新に失敗しました")}catch{alert("通信エラー")}finally{h(!1)}}},ue=async()=>{if(confirm(`本当にこのイベントを削除しますか？
この操作は取り消せません。`))try{await fetch("./backend/schedule_api.php?action=delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:m,token:v})});const t=window.location.href.split("?")[0];window.location.href=t}catch{alert("削除失敗")}},fe=()=>{if(!n)return;const t={};n.polls.forEach(r=>{t[r.id]=r.candidates.map(()=>({status:2,comment:""}))}),O(t),D({name:"",comment:""}),_(!0)},je=async()=>{if(!y.name.trim()){alert("名前を入力してください");return}h(!0);try{(await fetch("./backend/schedule_api.php?action=answer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:m,name:y.name,comment:y.comment,selections:N})})).ok?(_(!1),P()):alert("保存に失敗しました")}catch{alert("通信エラー")}finally{h(!1)}},ke=(t,r)=>{const a=t.candidates[r];try{const s=a.name.split(" ")[0],o=a.name.match(/(\d{1,2}:\d{2})/g);let d=s.replace(/\//g,"")+"T000000",l=s.replace(/\//g,"")+"T235959";if(o&&o.length>=1)if(d=s.replace(/\//g,"")+"T"+o[0].replace(":","")+"00",o.length>=2)l=s.replace(/\//g,"")+"T"+o[1].replace(":","")+"00";else{const g=new Date(s+" "+o[0]);g.setHours(g.getHours()+1),l=g.getFullYear()+String(g.getMonth()+1).padStart(2,"0")+String(g.getDate()).padStart(2,"0")+"T"+String(g.getHours()).padStart(2,"0")+String(g.getMinutes()).padStart(2,"0")+"00"}const x=`https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent((n==null?void 0:n.title)||"予定")}&dates=${d}/${l}&details=${encodeURIComponent((n==null?void 0:n.description)||"")}`;window.open(x,"_blank")}catch{alert("日時形式の解析に失敗しました")}},we=t=>t.startsWith("http://")||t.startsWith("https://"),ve=({onSelect:t})=>{const r=R.getFullYear(),a=R.getMonth(),s=new Date(r,a,1).getDay(),o=new Date(r,a+1,0).getDate(),d=[];for(let l=0;l<s;l++)d.push(null);for(let l=1;l<=o;l++)d.push(new Date(r,a,l));return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("button",{onClick:()=>J(new Date(r,a-1,1)),className:"p-1 text-gray-600 dark:text-gray-300",children:e.jsx(Oe,{size:20})}),e.jsxs("span",{className:"font-bold text-sm text-gray-800 dark:text-white",children:[r,"年 ",a+1,"月"]}),e.jsx("button",{onClick:()=>J(new Date(r,a+1,1)),className:"p-1 text-gray-600 dark:text-gray-300",children:e.jsx(ee,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center mb-1 text-[10px] font-bold text-gray-500",children:[e.jsx("div",{className:"text-red-500",children:"日"}),e.jsx("div",{children:"月"}),e.jsx("div",{children:"火"}),e.jsx("div",{children:"水"}),e.jsx("div",{children:"木"}),e.jsx("div",{children:"金"}),e.jsx("div",{className:"text-blue-500",children:"土"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:d.map((l,x)=>e.jsx("button",{disabled:!l,onClick:()=>l&&(t==null?void 0:t(l)),className:`aspect-square rounded-md flex items-center justify-center text-xs font-bold transition-all ${l?"bg-white dark:bg-gray-700 hover:bg-teal-100 dark:hover:bg-teal-900/50 shadow-sm text-gray-700 dark:text-gray-200":"invisible"}`,children:l==null?void 0:l.getDate()},x))}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold mb-2 cursor-pointer text-gray-600 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:l=>oe(l.target.checked),className:"rounded text-teal-600 focus:ring-teal-500"}),"時間を指定"]}),T&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"time",value:f.start,onChange:l=>B({...f,start:l.target.value}),className:"p-1.5 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full"}),e.jsx("span",{className:"text-gray-400",children:"~"}),e.jsx("input",{type:"time",value:f.end,onChange:l=>B({...f,end:l.target.value}),className:"p-1.5 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full"})]})]})]})};return m?E&&!n?e.jsxs("div",{className:"p-10 text-center",children:[e.jsx("div",{className:"animate-spin text-teal-500 text-4xl mx-auto mb-4",children:"C"}),"読み込み中..."]}):n?e.jsxs("div",{className:`mx-auto max-w-5xl pb-20 ${S?"p-2":"space-y-6"}`,children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-10 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-black text-gray-800 dark:text-white mb-2",children:n.title}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs md:text-sm whitespace-pre-wrap",children:n.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>{const t=window.location.href.split("&token")[0];navigator.clipboard.writeText(t),Y(!0),setTimeout(()=>Y(!1),2e3)},className:"flex items-center gap-2 px-4 py-2 bg-teal-100 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300 rounded-xl font-bold text-xs hover:bg-teal-200 transition-colors",children:[be?e.jsx(Ce,{size:14}):e.jsx(Se,{size:14})," URLコピー"]}),e.jsxs("button",{onClick:pe,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-xl font-bold text-xs hover:bg-gray-200 transition-colors",children:[e.jsx(X,{size:14})," 幹事メニュー"]})]})]}),n.deadline&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-full text-[10px] font-bold mb-6",children:[e.jsx(ze,{size:12})," 期限: ",n.deadline.replace("T"," ")]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-2xl relative max-h-[60vh]",children:e.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[e.jsxs("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0 z-20 shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 min-w-[120px] border-b border-r dark:border-gray-700 sticky left-0 bg-gray-50 dark:bg-gray-800 z-30 font-bold text-xs shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"参加者 / 候補"}),n.polls[0].candidates.map((t,r)=>e.jsxs("th",{className:"p-2 min-w-[100px] border-b border-r dark:border-gray-700 font-bold text-center relative group text-xs whitespace-normal",children:[e.jsx("div",{className:"text-gray-800 dark:text-white px-1",children:t.name}),t.note&&e.jsx("div",{className:"text-[10px] text-gray-500 font-normal mt-1 truncate",children:t.note}),e.jsx("button",{onClick:()=>ke(n.polls[0],r),className:"absolute top-0 right-0 opacity-0 group-hover:opacity-100 text-gray-400 hover:text-blue-500 p-1",children:e.jsx(De,{size:12})})]},r))]}),e.jsxs("tr",{className:"bg-teal-50 dark:bg-teal-900/20",children:[e.jsx("th",{className:"p-2 border-b border-r border-teal-100 dark:border-teal-900 sticky left-0 bg-teal-50 dark:bg-teal-900/20 z-30 text-teal-800 dark:text-teal-200 font-bold text-right text-xs shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"回答"}),n.polls[0].candidates.map((t,r)=>{let a=0,s=0;return n.answers.forEach(o=>{var l,x;const d=(x=(l=o.selections[n.polls[0].id])==null?void 0:l[r])==null?void 0:x.status;d===2?a++:d===1&&s++}),e.jsxs("td",{className:"p-2 border-b border-r border-teal-100 dark:border-teal-900 text-center font-bold text-teal-700 dark:text-teal-300 text-xs",children:["〇",a," / △",s]},r)})]})]}),e.jsx("tbody",{children:n.answers.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:n.polls[0].candidates.length+1,className:"p-8 text-center text-gray-400 text-xs",children:"まだ回答がありません"})}):n.answers.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsxs("td",{className:"p-3 border-b border-r dark:border-gray-700 sticky left-0 bg-white dark:bg-dark-lighter z-10 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:[e.jsx("div",{className:"font-bold text-gray-800 dark:text-gray-200 text-xs",children:t.name}),t.comment&&e.jsxs("div",{className:"text-[10px] text-gray-500 mt-0.5 flex items-center gap-1",children:[e.jsx(te,{size:8})," ",t.comment]})]}),n.polls[0].candidates.map((r,a)=>{var l;const s=(l=t.selections[n.polls[0].id])==null?void 0:l[a],o=s==null?void 0:s.status,d=s==null?void 0:s.comment;return e.jsx("td",{className:"p-2 border-b border-r dark:border-gray-700 text-center relative group",children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[o===2?e.jsx(Q,{className:"text-red-500 fill-red-50 dark:fill-red-900/30",size:18}):o===1?e.jsx(ae,{className:"text-yellow-500 fill-yellow-50 dark:fill-yellow-900/30",size:18}):e.jsx(j,{className:"text-gray-300",size:18}),d&&e.jsx("div",{className:"absolute bottom-0 right-0 text-gray-400",children:e.jsx(te,{size:10,className:"text-blue-400"})}),d&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-32 bg-gray-900 text-white text-[10px] rounded p-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-40",children:d})]})},a)})]},t.id))})]})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("button",{onClick:fe,className:"bg-teal-600 text-white px-8 py-3 rounded-full font-black text-sm md:text-base shadow-xl hover:bg-teal-700 hover:scale-105 transition-all flex items-center justify-center gap-2 mx-auto",children:[e.jsx(K,{strokeWidth:3,size:18})," 出欠を入力する"]})})]}),n.polls.length>1&&n.polls.slice(1).map(t=>e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(I,{className:"text-blue-500",size:18})," ",t.title]}),e.jsx("div",{className:"space-y-3",children:t.candidates.map((r,a)=>{let s=0,o=0;return n.answers.forEach(d=>{var x,g;const l=(g=(x=d.selections[t.id])==null?void 0:x[a])==null?void 0:g.status;l===2?s++:l===1&&o++}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 gap-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm text-gray-700 dark:text-gray-200",children:r.name}),r.note&&(we(r.note)?e.jsxs("a",{href:r.note,target:"_blank",rel:"noreferrer",className:"text-[10px] text-blue-500 hover:underline break-all flex items-center gap-1 mt-1",children:[e.jsx(Pe,{size:10})," ",r.note]}):e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1",children:r.note}))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500",children:"回答:"}),e.jsxs("span",{className:"text-sm font-black text-teal-600 dark:text-teal-400",children:["〇",s," / △",o]})]})]},a)})})]},t.id)),ge&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-2xl max-h-[90vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white",children:"出欠を入力"}),e.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(j,{size:20})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto flex-1 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500",children:["お名前 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.name,onChange:t=>D({...y,name:t.target.value}),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-bold text-base focus:border-teal-500 outline-none",placeholder:"山田 太郎"})]}),n.polls.map(t=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-bold text-sm text-gray-700 dark:text-gray-300 border-l-4 border-teal-500 pl-2",children:t.title}),e.jsx("div",{className:"space-y-2",children:t.candidates.map((r,a)=>{var o;const s=((o=N[t.id])==null?void 0:o[a])||{status:1,comment:""};return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 p-2 rounded-xl bg-gray-50 dark:bg-gray-700/50 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-xs text-gray-800 dark:text-white",children:r.name}),r.note&&e.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[200px]",children:r.note})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex bg-white dark:bg-gray-800 rounded-lg p-1 border dark:border-gray-600 shadow-sm shrink-0",children:[{val:2,icon:Q,color:"text-red-500"},{val:1,icon:ae,color:"text-yellow-500"},{val:0,icon:j,color:"text-gray-400"}].map(d=>e.jsx("button",{onClick:()=>{const l={...N};l[t.id][a]={...s,status:d.val},O(l)},className:`p-1.5 rounded-md transition-all ${s.status===d.val?"bg-gray-100 dark:bg-gray-600 "+d.color:"text-gray-300"}`,children:e.jsx(d.icon,{size:18,fill:s.status===d.val?"currentColor":"none",fillOpacity:.2})},d.val))}),e.jsx("input",{type:"text",placeholder:"コメント",value:s.comment,onChange:d=>{const l={...N};l[t.id][a]={...s,comment:d.target.value},O(l)},className:"flex-1 sm:w-32 p-2 rounded-lg border dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-xs"})]})]},a)})})]},t.id)),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"全体コメント"}),e.jsx("textarea",{value:y.comment,onChange:t=>D({...y,comment:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm h-20",placeholder:"遅れる可能性があります、等"})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900",children:e.jsx("button",{onClick:je,className:"w-full py-3 bg-teal-600 text-white font-black rounded-xl shadow-lg hover:bg-teal-700 transition-all text-sm",children:"回答を保存する"})})]})}),ce&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-sm rounded-3xl shadow-2xl p-6 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white mb-4",children:"幹事ログイン"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"このイベントにはパスワードが設定されています。"}),e.jsx("input",{type:"password",value:q,onChange:t=>F(t.target.value),className:"w-full p-3 mb-4 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"パスワード"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(!1),className:"flex-1 py-2 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-xl font-bold text-sm",children:"キャンセル"}),e.jsx("button",{onClick:()=>G(q),className:"flex-1 py-2 bg-teal-600 text-white rounded-xl font-bold text-sm",children:"認証"})]})]})}),xe&&c&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-2xl max-h-[90vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900",children:[e.jsxs("h3",{className:"font-bold text-lg text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(X,{size:18})," 幹事用メニュー"]}),e.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(j,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"イベント名"}),e.jsx("input",{type:"text",value:c.title,onChange:t=>p({...c,title:t.target.value}),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"詳細 / メモ"}),e.jsx("textarea",{value:c.description,onChange:t=>p({...c,description:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm h-20 resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"回答期限"}),e.jsx("input",{type:"datetime-local",value:c.deadline||"",onChange:t=>p({...c,deadline:t.target.value}),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"})]})]}),e.jsx("hr",{className:"border-gray-100 dark:border-gray-800"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-bold text-base text-gray-700 dark:text-gray-300",children:"アンケート項目の編集"}),c.polls.map((t,r)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-xl border border-gray-100 dark:border-gray-700",children:[e.jsx("input",{type:"text",value:t.title,onChange:a=>{const s=[...c.polls];s[r].title=a.target.value,p({...c,polls:s})},className:"w-full bg-transparent border-b border-gray-300 dark:border-gray-600 py-1 font-bold text-base focus:border-teal-500 outline-none text-gray-800 dark:text-white mb-3"}),e.jsxs("div",{className:"space-y-2",children:[t.candidates.map((a,s)=>e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{type:"text",value:a.name,onChange:o=>{const d=[...c.polls];d[r].candidates[s].name=o.target.value,p({...c,polls:d})},className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm"})},s)),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{type:"text",id:`new-cand-name-${r}`,className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm",placeholder:"新しい候補名"}),e.jsx("button",{onClick:()=>{const a=document.getElementById(`new-cand-name-${r}`);if(a.value){const s=[...c.polls];s[r].candidates.push({name:a.value,note:""}),p({...c,polls:s}),a.value=""}},className:"px-3 bg-teal-600 text-white rounded text-xs font-bold",children:"追加"})]})]})]},t.id))]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-red-500 font-bold mb-2",children:"危険な操作"}),e.jsx("button",{onClick:ue,className:"w-full py-3 bg-red-50 dark:bg-red-900/20 text-red-600 border border-red-200 dark:border-red-800 rounded-xl font-bold text-sm hover:bg-red-100 transition-colors",children:"イベントを削除する"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900 flex gap-4",children:[e.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors",children:"キャンセル"}),e.jsx("button",{onClick:ye,className:"flex-1 py-3 bg-teal-600 text-white font-black rounded-xl shadow-lg hover:bg-teal-700 transition-all text-sm",children:"変更を保存"})]})]})}),!S&&e.jsx(V,{})]}):e.jsx("div",{className:"p-10 text-center text-red-500",children:"イベントが見つかりません"}):e.jsxs("div",{className:"max-w-4xl mx-auto pb-20 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-black text-gray-800 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx(Te,{className:"text-teal-600"}),"新規イベント作成"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:["イベント名 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:z,onChange:t=>se(t.target.value),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-bold text-base focus:border-teal-500 outline-none",placeholder:"例: 開発部 歓迎会"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"詳細 / メモ"}),e.jsx("textarea",{value:M,onChange:t=>le(t.target.value),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm h-20 resize-none",placeholder:"場所や予算など..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"回答期限 (任意)"}),e.jsx("input",{type:"datetime-local",value:L,onChange:t=>de(t.target.value),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"幹事用パスワード (任意)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{size:16,className:"text-gray-400"}),e.jsx("input",{type:"password",value:U,onChange:t=>ne(t.target.value),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",placeholder:"編集・削除時に必要"})]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"設定しない場合、URLを知っている全員が編集可能になります。"})]})]}),e.jsx("hr",{className:"border-gray-100 dark:border-gray-800"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-base md:text-lg flex items-center gap-2",children:"アンケート設定"}),b.map((t,r)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-2xl border border-gray-100 dark:border-gray-700 relative",children:[r>0&&e.jsx("button",{onClick:()=>{const a=[...b];a.splice(r,1),u(a)},className:"absolute top-3 right-3 text-gray-400 hover:text-red-500",children:e.jsx(Me,{size:16})}),e.jsxs("div",{className:"mb-4 pr-6",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"質問タイトル"}),e.jsx("input",{type:"text",value:t.title,onChange:a=>{const s=[...b];s[r].title=a.target.value,u(s)},className:"w-full bg-transparent border-b border-gray-300 dark:border-gray-600 py-1 font-bold text-base focus:border-teal-500 outline-none text-gray-800 dark:text-white"})]}),t.type==="date"?e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"shrink-0 w-full md:w-auto",children:e.jsx(ve,{onSelect:a=>me(a,r,u,b)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase mb-2",children:"選択された候補"}),e.jsxs("div",{className:"space-y-1.5 max-h-60 overflow-y-auto pr-1 custom-scrollbar",children:[t.candidates.map((a,s)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsx("span",{className:"font-mono font-bold text-sm text-gray-700 dark:text-gray-200",children:a.name}),e.jsx("button",{onClick:()=>Z(r,s),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(j,{size:14})})]},s)),t.candidates.length===0&&e.jsx("div",{className:"text-gray-400 text-xs p-4 text-center border-2 border-dashed border-gray-200 rounded-xl",children:"カレンダーの日付をクリックして追加"})]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-2 bg-white dark:bg-gray-700 p-3 rounded-xl border border-gray-100 dark:border-gray-600",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",id:`cand-input-${r}`,className:"flex-1 p-2 rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",placeholder:"候補を入力 (例: イタリアン)",onKeyDown:a=>{if(a.key==="Enter"){const s=document.getElementById(`cand-note-${r}`);C(r,a.currentTarget.value,s.value),a.currentTarget.value="",s.value=""}}}),e.jsx("button",{onClick:()=>{const a=document.getElementById(`cand-input-${r}`),s=document.getElementById(`cand-note-${r}`);C(r,a.value,s.value),a.value="",s.value=""},className:"bg-teal-600 text-white px-3 py-1 rounded-lg font-bold text-xs",children:"追加"})]}),e.jsx("input",{type:"text",id:`cand-note-${r}`,className:"w-full p-2 rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-xs",placeholder:"備考・URL (任意)",onKeyDown:a=>{if(a.key==="Enter"){const s=document.getElementById(`cand-input-${r}`);C(r,s.value,a.currentTarget.value),s.value="",a.currentTarget.value=""}}})]}),e.jsx("div",{className:"space-y-1.5",children:t.candidates.map((a,s)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-bold text-sm text-gray-800 dark:text-gray-200 truncate",children:a.name}),a.note&&e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 truncate",children:a.note})]}),e.jsx("button",{onClick:()=>Z(r,s),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(j,{size:14})})]},s))})]})]},t.id)),e.jsxs("button",{onClick:()=>u([...b,{id:`p${Date.now()}`,type:"text",title:"お店・場所など",candidates:[]}]),className:"w-full py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-500 font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center justify-center gap-2 text-sm",children:[e.jsx(K,{size:16})," 別のアンケート項目を追加 (場所など)"]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:he,disabled:E,className:"w-full py-4 bg-teal-600 text-white font-black text-lg rounded-2xl shadow-xl hover:bg-teal-700 transition-all flex items-center justify-center gap-2",children:[E?"作成中...":"イベントを作成する"," ",e.jsx(ee,{size:20})]})})]})]}),e.jsxs("article",{className:"p-6 bg-white dark:bg-dark-lighter rounded-3xl border border-gray-100 dark:border-gray-700 prose dark:prose-invert max-w-none shadow-sm",children:[e.jsxs("h2",{className:"text-lg font-black flex items-center gap-2 mb-4",children:[e.jsx(I,{className:"text-teal-500",size:20}),"「まいつーる日程調整」の特長"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-xs leading-relaxed text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-2 flex items-center gap-2",children:[e.jsx(Ee,{size:16,className:"text-teal-500"}),"ログイン不要で即作成"]}),e.jsx("p",{children:"面倒な会員登録は一切不要。思い立ったらすぐにイベントページを作成し、URLをLINEやSlackで共有するだけで調整がスタートします。回答もスマホからサクサク行えます。"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-2 flex items-center gap-2",children:[e.jsx($e,{size:16,className:"text-teal-500"}),"細かいニュアンスも伝わる"]}),e.jsx("p",{children:"単なる○✕だけでなく、日程ごとにコメントを残せるため、「19時以降なら○」「場所によっては△」といった細かい条件もスムーズに共有できます。"})]})]})]}),!S&&e.jsx(V,{})]})};export{Ve as default};
