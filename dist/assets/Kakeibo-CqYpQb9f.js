import{j as e}from"./index-D4reVrDU.js";import{r as d}from"./vendor-react-Dy8mW7IA.js";import{W as T}from"./WorkspaceContext-gpeJemtb.js";import{A as z}from"./AdBanner-DUdjXfK6.js";import{ab as M,aJ as I,z as D,aK as j,aL as E,aM as J,aN as R,R as _,aO as L,aP as P,aG as A,T as K,a4 as W,aQ as G,a2 as Y,I as F,S as B,D as Q,P as U}from"./vendor-ui-gkh9ij8_.js";import"./vendor-utils-V9s-2EHj.js";const w={expense:["食費","交通費","日用品","趣味","住居費","その他"],income:["給料","副業","臨時収入","その他"]},N=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"],se=()=>{const a=d.useContext(T),[p,v]=d.useState("dashboard"),[m,u]=d.useState(()=>JSON.parse(localStorage.getItem("kakeibo_transactions")||"[]")),[y,V]=d.useState(()=>JSON.parse(localStorage.getItem("kakeibo_subs")||"[]")),[f,q]=d.useState(()=>JSON.parse(localStorage.getItem("kakeibo_goals")||"[]")),[S,b]=d.useState(!1),[s,n]=d.useState({type:"expense",date:new Date().toISOString().split("T")[0],category:"食費"}),[o,k]=d.useState(new Date);d.useEffect(()=>localStorage.setItem("kakeibo_transactions",JSON.stringify(m)),[m]),d.useEffect(()=>localStorage.setItem("kakeibo_subs",JSON.stringify(y)),[y]),d.useEffect(()=>localStorage.setItem("kakeibo_goals",JSON.stringify(f)),[f]);const C=()=>{if(!s.amount||!s.date)return;const t={id:Date.now().toString(),date:s.date,amount:Number(s.amount),type:s.type,category:s.category||"その他",note:s.note||""};u(r=>[t,...r].sort((l,c)=>new Date(c.date).getTime()-new Date(l.date).getTime())),b(!1),n({type:"expense",date:new Date().toISOString().split("T")[0],category:"食費",amount:0,note:""})},$=t=>{u(r=>r.filter(l=>l.id!==t))},O=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`,i=m.filter(t=>t.date.startsWith(O)),x=d.useMemo(()=>{const t=i.filter(l=>l.type==="income").reduce((l,c)=>l+c.amount,0),r=i.filter(l=>l.type==="expense").reduce((l,c)=>l+c.amount,0);return{income:t,expense:r,balance:t-r}},[i]),h=d.useMemo(()=>{const t={};return i.filter(r=>r.type==="expense").forEach(r=>{t[r.category]=(t[r.category]||0)+r.amount}),Object.entries(t).map(([r,l])=>({name:r,value:l}))},[i]),g=t=>`¥${t.toLocaleString()}`;return e.jsxs("div",{className:`relative h-full flex flex-col ${a?"w-full p-2":"max-w-5xl mx-auto space-y-10 pb-20"}`,children:[e.jsxs("div",{className:`flex flex-col md:flex-row md:items-center justify-between gap-2 shrink-0 ${a?"mb-2":""}`,children:[!a&&e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(M,{className:"text-yellow-600"}),"まいつーる家計簿"]}),e.jsxs("div",{className:`flex items-center gap-2 bg-white dark:bg-dark-lighter p-1 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 ${a?"w-full justify-between":""}`,children:[e.jsx("button",{onClick:()=>k(new Date(o.setMonth(o.getMonth()-1))),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(I,{size:a?16:20})}),e.jsxs("span",{className:"font-bold px-2 text-center text-gray-800 dark:text-white text-xs sm:text-sm",children:[o.getFullYear(),"年 ",o.getMonth()+1,"月"]}),e.jsx("button",{onClick:()=>k(new Date(o.setMonth(o.getMonth()+1))),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(D,{size:a?16:20})})]})]}),e.jsx("div",{className:`flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl overflow-x-auto no-scrollbar shrink-0 ${a?"mb-2":""}`,children:[{id:"dashboard",icon:j,label:"ホーム"},{id:"calendar",icon:E,label:"カレンダー"},...a?[]:[{id:"subs",icon:J,label:"サブスク"},{id:"goals",icon:R,label:"目標"}]].map(t=>e.jsxs("button",{onClick:()=>v(t.id),className:`flex-1 flex items-center justify-center gap-1 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${p===t.id?"bg-white dark:bg-gray-700 text-yellow-700 dark:text-yellow-400 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[e.jsx(t.icon,{size:14}),t.label]},t.id))}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar pb-16",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`grid gap-2 ${a?"grid-cols-3":"grid-cols-1 md:grid-cols-3"}`,children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-2xl border border-blue-100 dark:border-blue-800",children:[e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold mb-1",children:"収入"}),e.jsx("p",{className:`${a?"text-sm sm:text-base md:text-lg":"text-3xl"} font-black text-slate-800 dark:text-white truncate`,children:g(x.income)})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-2xl border border-red-100 dark:border-red-800",children:[e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 font-bold mb-1",children:"支出"}),e.jsx("p",{className:`${a?"text-sm sm:text-base md:text-lg":"text-3xl"} font-black text-slate-800 dark:text-white truncate`,children:g(x.expense)})]}),e.jsxs("div",{className:`p-4 rounded-2xl border ${x.balance>=0?"bg-green-50 dark:bg-green-900/20 border-green-100 dark:border-green-800":"bg-gray-100 border-gray-200"}`,children:[e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 font-bold mb-1",children:"差引"}),e.jsx("p",{className:`${a?"text-sm sm:text-base md:text-lg":"text-3xl"} font-black text-slate-800 dark:text-white truncate`,children:g(x.balance)})]})]}),p==="dashboard"&&e.jsxs("div",{className:`grid gap-4 ${a?"grid-cols-1":"grid-cols-1 lg:grid-cols-2"}`,children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-5 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-700 dark:text-gray-200 mb-4 uppercase tracking-wider",children:"支出内訳"}),e.jsx("div",{className:`${a?"h-32 md:h-40":"h-64"}`,children:h.length>0?e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(L,{children:[e.jsx(P,{data:h,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:a?45:100,children:h.map((t,r)=>e.jsx(A,{fill:N[r%N.length]},`cell-${r}`))}),e.jsx(K,{formatter:t=>g(t)})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-[10px] text-gray-400",children:"データがありません"})})]}),e.jsxs("div",{className:"bg-white dark:bg-dark-lighter p-5 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col max-h-[300px] md:max-h-[400px]",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-700 dark:text-gray-200 mb-4 uppercase tracking-wider",children:"履歴"}),e.jsx("div",{className:"space-y-2 overflow-y-auto pr-1 flex-1 no-scrollbar",children:i.map(t=>e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${t.type==="income"?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"}`,children:t.type==="income"?e.jsx(W,{size:14}):e.jsx(G,{size:14})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-800 dark:text-gray-200 truncate",children:t.category}),e.jsxs("p",{className:"text-[9px] text-gray-500 truncate",children:[t.date," ",t.note]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs("span",{className:`text-xs font-black ${t.type==="income"?"text-blue-600":"text-red-600"}`,children:[t.type==="income"?"+":"-",t.amount.toLocaleString()]}),e.jsx("button",{onClick:()=>$(t.id),className:"text-gray-400 hover:text-red-500",children:e.jsx(Y,{size:12})})]})]},t.id))})]})]})]}),!a&&e.jsxs("article",{className:"mt-12 p-8 bg-white dark:bg-dark-lighter rounded-3xl border border-gray-100 dark:border-gray-700 shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 mb-6",children:[e.jsx(F,{className:"text-blue-500"}),"登録不要・無料家計簿ツールの使い方とメリット"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 font-bold",children:[e.jsx(B,{size:18})," ",e.jsx("span",{children:"プライバシー完全保護"})]}),e.jsx("p",{className:"text-xs leading-relaxed text-gray-500",children:"入力されたデータはすべてお使いのブラウザ内（LocalStorage）にのみ保存されます。サーバーへ送信されることは一切ないため、銀行口座やクレジットカードとの連携に不安がある方でも安心してご利用いただけます。"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 font-bold",children:[e.jsx(Q,{size:18})," ",e.jsx("span",{children:"バックアップ・復元対応"})]}),e.jsx("p",{className:"text-xs leading-relaxed text-gray-500",children:"ブラウザのキャッシュを消すとデータも消えてしまいますが、設定画面からJSONファイルとしてデータのバックアップ・復元が可能です。端末を変えてもデータを引き継ぐことができます。"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 font-bold",children:[e.jsx(j,{size:18})," ",e.jsx("span",{children:"自動グラフ分析"})]}),e.jsx("p",{className:"text-xs leading-relaxed text-gray-500",children:"入力した支出は自動でカテゴリごとに集計され、円グラフで可視化されます。「何に使いすぎているか」が一目でわかるため、効果的な節約をサポートします。"})]})]})]})]}),e.jsx("button",{onClick:()=>b(!0),className:`${a?"absolute bottom-4 right-4 p-3 shadow-lg":"fixed bottom-8 right-8 p-5 shadow-2xl"} bg-yellow-600 text-white rounded-full hover:bg-yellow-700 hover:scale-105 transition-all z-20 flex items-center justify-center active:scale-95`,children:e.jsx(U,{size:a?20:32})}),S&&e.jsx("div",{className:`z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in ${a?"absolute inset-0":"fixed inset-0 bg-black/60"}`,children:e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl w-full max-w-sm p-6 shadow-2xl border border-gray-100 dark:border-gray-700 max-h-full overflow-y-auto",children:[e.jsx("h3",{className:"text-xl font-black mb-6 text-gray-800 dark:text-white",children:"取引を追加"}),e.jsxs("div",{className:"flex gap-2 mb-6 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>n({...s,type:"expense"}),className:`flex-1 py-2 rounded-lg font-black text-sm transition-all ${s.type==="expense"?"bg-white dark:bg-gray-700 text-red-600 shadow":"text-gray-500"}`,children:"支出"}),e.jsx("button",{onClick:()=>n({...s,type:"income"}),className:`flex-1 py-2 rounded-lg font-black text-sm transition-all ${s.type==="income"?"bg-white dark:bg-gray-700 text-blue-600 shadow":"text-gray-500"}`,children:"収入"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"date",value:s.date,onChange:t=>n({...s,date:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white text-sm"}),e.jsx("input",{type:"number",placeholder:"金額",value:s.amount||"",onChange:t=>n({...s,amount:Number(t.target.value)}),className:"w-full p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white text-2xl font-black"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:(s.type==="expense"?w.expense:w.income).map(t=>e.jsx("button",{onClick:()=>n({...s,category:t}),className:`px-3 py-1.5 rounded-full text-[10px] font-bold border transition-all ${s.category===t?"bg-yellow-100 border-yellow-300 text-yellow-800":"border-gray-200 text-gray-500"}`,children:t},t))}),e.jsx("input",{type:"text",value:s.note,onChange:t=>n({...s,note:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-white text-sm",placeholder:"備考 (任意)"})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{onClick:()=>b(!1),className:"flex-1 py-3 text-gray-500 text-sm font-bold hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",children:"戻る"}),e.jsx("button",{onClick:C,className:"flex-1 py-3 bg-yellow-600 text-white text-sm font-bold rounded-xl hover:bg-yellow-700 shadow-xl shadow-yellow-100 dark:shadow-none",children:"保存する"})]})]})}),!a&&e.jsx(z,{})]})};export{se as default};
