<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ã¾ã„ã¤ãƒ¼ã‚‹WEBãƒœãƒ¼ãƒ‰</title>
    <!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³è¨­å®š -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect x='10' y='10' width='80' height='80' fill='%23fff740' stroke='%23d4c928' stroke-width='5' rx='10'/%3E%3Cline x1='25' y1='35' x2='75' y2='35' stroke='%23555' stroke-width='5' stroke-linecap='round'/%3E%3Cline x1='25' y1='55' x2='75' y2='55' stroke='%23555' stroke-width='5' stroke-linecap='round'/%3E%3Cline x1='25' y1='75' x2='55' y2='75' stroke='%23555' stroke-width='5' stroke-linecap='round'/%3E%3C/svg%3E" type="image/svg+xml">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=M+PLUS+Rounded+1c:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200');

        :root {
            --bg-color: #f0f2f5;
            --sidebar-bg: #e4e6eb;
            --sidebar-text: #333;
            --grid-color: #d0d0d0;
            --note-bg-default: #fff740;
            --text-color: #333;
            --icon-color: #444;
            --ui-bg: rgba(255, 255, 255, 0.95);
            --ui-shadow: 0 10px 30px rgba(0,0,0,0.15);
            --note-shadow: 0 10px 20px rgba(0,0,0,0.15), 0 3px 6px rgba(0,0,0,0.10);
            --accent-color: #222;
            --accent-text: #fff;
            --folder-hover: #d0d2d6;
            --active-item: #c0c2c6;
            --connector-color: #999;
            --highlight-color: rgba(50, 150, 255, 0.6);
            --highlight-stroke: rgba(50, 150, 255, 0.8);
            --drawing-color: rgba(255, 80, 80, 0.8);
            --label-bg: #333;
            --label-text: #fff;
            --danger-color: #dc3545;
            --input-bg: #fff;
            --input-border: #ccc;
        }

        .dark-mode {
            --bg-color: #1a1a1a;
            --sidebar-bg: #252525;
            --sidebar-text: #e0e0e0;
            --grid-color: #333;
            --note-bg-default: #d4c928;
            --text-color: #e0e0e0;
            --icon-color: #fff;
            --ui-bg: rgba(40, 40, 40, 0.95);
            --ui-shadow: 0 10px 30px rgba(0,0,0,0.5);
            --note-shadow: 0 10px 20px rgba(0,0,0,0.5);
            --accent-color: #eee;
            --accent-text: #222;
            --folder-hover: #333;
            --active-item: #444;
            --connector-color: #888;
            --highlight-color: rgba(100, 180, 255, 0.5);
            --highlight-stroke: rgba(100, 180, 255, 0.8);
            --drawing-color: rgba(255, 100, 100, 0.9);
            --label-bg: #eee;
            --label-text: #333;
            --danger-color: #ff6b6b;
            --input-bg: #333;
            --input-border: #555;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            
            /* è‹±æ•°å­—ã¯Segoe UI(Win)ã‚„Helvetica(Mac)ãªã©ã‚’å„ªå…ˆã€æ—¥æœ¬èªã¯Noto Sans JP */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", sans-serif;
            
            color: var(--text-color);
            background-color: var(--bg-color); transition: background-color 0.3s, color 0.3s;

            /* æ–‡å­—ã‚’æ»‘ã‚‰ã‹ã«ã™ã‚‹è¨­å®š */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }

        #app-container { display: flex; width: 100%; height: 100%; }

        #sidebar {
            width: 260px; background-color: var(--sidebar-bg); color: var(--sidebar-text);
            display: flex; flex-direction: column; border-right: 1px solid rgba(0,0,0,0.1);
            transition: 0.3s; z-index: 1000; flex-shrink: 0; user-select: none;
        }
        .sidebar-header {
            padding: 15px; font-weight: bold; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .sidebar-content { flex-grow: 1; overflow-y: auto; padding: 10px 0; }
        .tree-item {
            padding: 8px 15px; cursor: pointer; display: flex; align-items: center; gap: 8px;
            transition: background 0.1s; font-size: 14px;
        }
        .tree-item:hover { background-color: var(--folder-hover); }
        .tree-item.active { background-color: var(--active-item); font-weight: bold; border-left: 4px solid var(--accent-color); }
        .folder-title { display: flex; align-items: center; gap: 5px; font-weight: bold; color: var(--sidebar-text); opacity: 0.9; }
        .sheet-item { padding-left: 35px; }
        .folder-toggle { cursor: pointer; font-size: 12px; width: 20px; text-align: center;}

        #main-area {
            flex-grow: 1; position: relative; overflow: hidden;
            background-image: radial-gradient(var(--grid-color) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        #canvas-wrapper { width: 100%; height: 100%; position: relative; cursor: grab; overflow: hidden; }
        #canvas-wrapper:active { cursor: grabbing; }

        #board {
            width: 5000px; height: 5000px; position: absolute;
            transform-origin: 0 0; will-change: transform, left, top;
        }

        #svg-layer-back, #svg-layer-front {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; overflow: visible; 
        }
        #svg-layer-back { z-index: 0; }
        #svg-layer-front { z-index: 2000; }
        
        .connector-group { pointer-events: none; }
        .connector-path {
            fill: none; stroke: var(--connector-color); stroke-width: 2;
            transition: stroke 0.2s, stroke-width 0.2s, filter 0.2s; pointer-events: none;
        }
        .connector-hit-area {
            fill: none; stroke: transparent; stroke-width: 20; pointer-events: none;
        }
        body.connecting-mode .connector-hit-area, body.eraser-mode .connector-hit-area {
            pointer-events: stroke; cursor: pointer;
        }
        body.connecting-mode .connector-group:hover .connector-path,
        body.eraser-mode .connector-group:hover .connector-path {
            stroke: var(--danger-color) !important; stroke-width: 6; marker-end: url(#arrowhead-danger) !important;
        }
        .connector-group.route-highlight .connector-path {
            stroke: var(--highlight-stroke) !important; stroke-width: 4 !important;
            filter: drop-shadow(0 0 4px var(--highlight-color)); marker-end: url(#arrowhead-active) !important;
        }
        .connector-arrow { fill: var(--connector-color); transition: fill 0.2s; }
        .drawing-path {
            fill: none; stroke: var(--drawing-color); stroke-width: 4;
            stroke-linecap: round; stroke-linejoin: round; pointer-events: visibleStroke;
        }
        .drawing-path:hover { stroke-width: 8; opacity: 0.7; }

        body.drawing-mode #canvas-wrapper { cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="red" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>') 0 24, crosshair; }
        body.drawing-mode .note { pointer-events: none; }
        body.eraser-mode #canvas-wrapper { cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="black" d="M16.24 3.56l4.95 4.94c.78.79.78 2.05 0 2.84L12 20.53a4.008 4.008 0 0 1-5.66 0L2.81 17c-.78-.79-.78-2.05 0-2.84l10.6-10.6c.79-.78 2.05-.78 2.83 0zM4.22 15.58l3.54 3.53c.78.79 2.04.79 2.83 0l1.41-1.41-6.36-6.36-1.42 1.41c-.78.79-.78 2.05 0 2.83z"/></svg>') 0 24, cell; }
        body.eraser-mode .drawing-path { cursor: crosshair; }
        body.eraser-mode .note { pointer-events: none; }
        body.connecting-mode #canvas-wrapper { cursor: crosshair; }

        .mode-indicator {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0, 123, 255, 0.9); color: white;
            padding: 8px 20px; border-radius: 20px; font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 6000; pointer-events: none;
            opacity: 0; transition: opacity 0.3s;
        }
        body.connecting-mode .mode-indicator { opacity: 1; }

        .note {
            position: absolute; background-color: var(--note-bg-default); border-radius: 8px;
            box-shadow: var(--note-shadow); display: flex; flex-direction: column;
            overflow: hidden; resize: both; min-width: 200px; min-height: 150px;
            
            /* è‹±æ•°å­—ã¯æ¨™æº–ãƒ•ã‚©ãƒ³ãƒˆã€æ—¥æœ¬èªã¯ä¸¸ã‚´ã‚·ãƒƒã‚¯ */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "M PLUS Rounded 1c", sans-serif;
            
            color: #333;
            z-index: 10; transition: box-shadow 0.2s;
        }
        .note.route-active { box-shadow: 0 0 0 6px var(--highlight-color), var(--note-shadow); z-index: 100; }
        .note.dragging { box-shadow: 0 20px 40px rgba(0,0,0,0.3); z-index: 999999 !important; }
        .note.connect-source { box-shadow: 0 0 0 4px var(--highlight-stroke); cursor: crosshair; }

        .note-labels-container {
            position: absolute; top: 2px; left: 4px; width: auto; max-width: 100%;
            display: flex; gap: 4px; flex-wrap: wrap; pointer-events: none; z-index: 5;
        }
        .note-label-chip {
            background: var(--label-bg); color: var(--label-text); padding: 2px 8px; border-radius: 10px;
            font-size: 11px; font-weight: bold; box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            z-index: 20; max-width: 150px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }

        .stamp-area {
            position: absolute; bottom: 45px; right: 10px;
            display: flex; gap: 2px; flex-wrap: wrap; justify-content: flex-end;
            pointer-events: none; z-index: 15;
        }
        .stamp-item {
            background: #fff; border-radius: 50%; width: 24px; height: 24px;
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            cursor: pointer; pointer-events: auto; user-select: none; transition: transform 0.1s;
        }
        .stamp-item:hover { transform: scale(1.2); }

        .note-header {
            height: 24px; background: rgba(0,0,0,0.05); cursor: move;
            display: flex; justify-content: flex-end; align-items: center;
            padding: 0 5px; opacity: 0; transition: opacity 0.2s;
            border-top-left-radius: 8px; border-top-right-radius: 8px;
        }
        .note:hover .note-header { opacity: 1; }
        .delete-btn { cursor: pointer; padding: 0 5px; font-weight: bold; color: #555; }
        .delete-btn:hover { color: #f00; }

        .note-content {
            flex-grow: 1; padding: 15px; outline: none; overflow: auto;
            line-height: 1.5; white-space: pre-wrap; font-size: 16px;
            cursor: grab; 
            user-select: none; 
            margin-top: 10px;
        }
        .note-content[contenteditable="true"] {
            cursor: text; user-select: text; 
            background-color: rgba(255, 255, 255, 0.2);
            box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1);
        }
        .note-content input[type="checkbox"] { transform: scale(1.3); margin-right: 8px; }
        .note-content a { color: blue; text-decoration: underline; cursor: pointer; }
        
        /* ç”»åƒã‚¹ã‚¿ã‚¤ãƒ«: ãƒ›ãƒãƒ¼æ™‚ã«ãƒªã‚µã‚¤ã‚ºå¯èƒ½ãªã“ã¨ã‚’ç¤ºå”† */
        .note-content img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 5px 0;
            cursor: default;
            transition: box-shadow 0.2s;
        }
        .note-content img:hover {
            box-shadow: 0 0 0 2px rgba(0,0,0,0.3);
        }

        .note-tools {
            height: 40px; background: rgba(255,255,255,0.6);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 10px; opacity: 0; transition: opacity 0.2s;
            backdrop-filter: blur(4px); cursor: default;
            margin-bottom: 10px; margin-left: 5px; margin-right: 5px; border-radius: 20px;
        }
        .note:hover .note-tools { opacity: 1; }
        .note-tools .material-symbols-outlined { color: #333 !important; }

        .tool-group { display: flex; align-items: center; gap: 5px; }
        .color-dot { width: 16px; height: 16px; border-radius: 50%; cursor: pointer; border: 1px solid rgba(0,0,0,0.1); }
        .color-dot:hover { transform: scale(1.2); }
        .tool-btn {
            background: none; border: none; cursor: pointer; opacity: 0.8; padding: 2px;
            display: flex; align-items: center; justify-content: center;
        }
        .tool-btn:hover { opacity: 1; background: rgba(128,128,128,0.2); border-radius: 4px; }
        .material-symbols-outlined { font-size: 18px; color: var(--icon-color); vertical-align: middle; }
        
        .font-size-btn {
            font-weight: bold; font-family: sans-serif; font-size: 14px;
            width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;
            border: 1px solid #ccc; border-radius: 4px; cursor: pointer; background: #fff; color: #333;
        }
        .font-size-btn:hover { background: #eee; }

        #ui-layer {
            position: fixed; bottom: 30px; left: calc(50% + 130px);
            transform: translateX(-50%); display: flex; gap: 15px; z-index: 5000;
            background: var(--ui-bg); padding: 10px 25px; border-radius: 50px;
            box-shadow: var(--ui-shadow); backdrop-filter: blur(10px); align-items: center;
            user-select: none;
            -webkit-user-select: none;
        }
        .main-btn {
            background: var(--accent-color); color: var(--accent-text); border: none;
            padding: 10px 20px; border-radius: 30px; font-weight: bold; cursor: pointer;
            display: flex; align-items: center; gap: 8px; transition: 0.2s;
            white-space: nowrap; min-width: max-content;
        }
        .main-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .main-btn .material-symbols-outlined { color: var(--accent-text); }
        .main-btn.active { background: var(--highlight-stroke); color: #fff; box-shadow: inset 0 3px 5px rgba(0,0,0,0.2); }

        .sub-btn {
            background: #eee; color: #333; border: 1px solid #ccc; padding: 8px 15px;
            border-radius: 5px; cursor: pointer; display: flex; align-items: center; gap: 5px; font-size: 13px; transition: 0.2s;
        }
        .sub-btn:hover { background: #ddd; }
        .sub-btn .material-symbols-outlined { color: #333; font-size: 16px; }
        
        .danger-btn {
            background: var(--danger-color); color: #fff; border: none; padding: 8px 15px;
            border-radius: 5px; cursor: pointer; font-size: 13px; margin-top: 10px;
        }
        .danger-btn:hover { opacity: 0.9; }

        #context-menu, #stamp-menu, #label-menu {
            position: fixed; background: var(--ui-bg); border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); padding: 5px 0; z-index: 10000;
            display: none; backdrop-filter: blur(10px); min-width: 150px;
            color: var(--text-color);
        }
        .ctx-item {
            padding: 8px 15px; cursor: pointer; font-size: 14px; color: var(--text-color);
            display: flex; align-items: center; gap: 8px;
        }
        .ctx-item:hover { background: var(--folder-hover); }

        #stamp-menu {
            display: none; grid-template-columns: repeat(4, 1fr); padding: 10px; gap: 5px; width: 160px;
        }
        .stamp-option { font-size: 20px; cursor: pointer; text-align: center; padding: 5px; border-radius: 5px; }
        .stamp-option:hover { background: rgba(0,0,0,0.1); }

        #label-menu { width: 220px; padding: 10px; }
        .label-input { 
            width: 90%; padding: 5px; border: 1px solid var(--input-border); border-radius: 4px; margin-bottom: 5px; 
            background: var(--input-bg); color: var(--text-color);
        }
        .label-list { max-height: 120px; overflow-y: auto; margin-bottom:10px;}
        .label-option { padding: 5px; cursor: pointer; font-size: 13px; border-radius: 4px; display:flex; justify-content:space-between; color: var(--text-color); }
        .label-option:hover { background: var(--folder-hover); }
        .label-current { display:flex; flex-wrap:wrap; gap:4px; margin-bottom:8px; }
        .label-badge-removable {
            background: #666; color:#fff; font-size:11px; padding:2px 6px; border-radius:10px; cursor:pointer;
        }
        .label-badge-removable:hover { background:#ff4d4d; }

        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 99999; align-items: center; justify-content: center;
            backdrop-filter: blur(3px);
        }
        .modal-content {
            background: var(--ui-bg); padding: 30px; border-radius: 15px; width: 320px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); text-align: left; color: var(--text-color);
            max-height: 80vh; overflow-y:auto;
        }
        .modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px; }
        .modal-title { font-weight: bold; font-size: 18px; }
        .close-modal { cursor:pointer; font-size:20px; color:#666; }
        .section-title { font-size: 14px; font-weight: bold; margin-bottom: 10px; border-left: 3px solid var(--accent-color); padding-left: 8px; }
        .color-inputs { display: flex; justify-content: space-around; margin-bottom: 20px; }
        .color-input-wrapper input[type="color"] { width: 30px; height: 30px; border: none; cursor: pointer; background: none; padding: 0; }
        
        #search-modal .modal-content { width: 500px; }
        .search-results { margin-top: 15px; max-height: 300px; overflow-y: auto; }
        .search-result-item { padding: 10px; border-bottom: 1px solid rgba(0,0,0,0.1); cursor: pointer; }
        .search-result-item:hover { background: var(--folder-hover); }
        .result-sheet { font-size: 11px; color: var(--highlight-stroke); font-weight: bold; }
        .result-content { font-size: 13px; color: var(--text-color); white-space: pre-wrap; max-height:40px; overflow:hidden; }
        .result-labels { display: flex; gap: 4px; margin-top: 4px; }
        .search-controls { display:flex; gap:10px; margin-bottom:10px; }
        .search-input { 
            flex-grow:1; padding:8px; border-radius:4px; border:1px solid var(--input-border); 
            background: var(--input-bg); color: var(--text-color);
        }
        .filter-select { 
            padding:8px; border-radius:4px; border:1px solid var(--input-border); max-width:120px;
            background: var(--input-bg); color: var(--text-color);
        }

        .separator { width: 1px; height: 25px; background: #bbb; }
        .separator-horizontal { width: 100%; height: 1px; background: rgba(0,0,0,0.1); margin: 20px 0; }
        input[type=range] { width: 60px; }
        #zoom-slider { width: 120px; }

        .selection-lasso {
            position: absolute; border: 1px dashed #007bff; background-color: rgba(0, 123, 255, 0.1);
            pointer-events: none; z-index: 99999; display: none;
        }
        .note.selected-item { box-shadow: 0 0 0 3px #007bff, var(--note-shadow) !important; }
        .selected-svg-item { filter: drop-shadow(0 0 3px #007bff); }
        .selected-svg-item path, .selected-svg-item line { stroke: #007bff !important; }

        #selection-menu {
            position: fixed; background: var(--ui-bg); border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); padding: 5px 0; z-index: 10001;
            display: none; backdrop-filter: blur(10px); min-width: 160px; color: var(--text-color);
        }

        /* --- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ --- */
        #floating-text-menu {
            position: fixed; 
            display: flex;
            flex-direction: column; 
            background: var(--ui-bg); 
            padding: 5px; 
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
            z-index: 100002; 
            backdrop-filter: blur(5px);
            visibility: visible;
        }
        #floating-text-menu.hidden { 
            display: none !important; 
        }
        
        .floating-toolbar { display: flex; gap: 5px; align-items: center; }
        .float-btn {
            background: none; border: none; cursor: pointer; padding: 4px;
            border-radius: 4px; display: flex; align-items: center; justify-content: center;
            color: var(--text-color); font-size: 14px; font-weight: bold;
        }
        .float-btn:hover { background: rgba(128,128,128,0.2); }
        .float-btn .material-symbols-outlined { font-size: 18px; color: var(--text-color); }
        
        #floating-color-palette {
            margin-top: 5px; border-top: 1px solid rgba(0,0,0,0.1); padding-top: 5px; display: none;
        }
        #floating-color-palette.show { display: block; }
        .palette-row { display: flex; gap: 4px; flex-wrap: wrap; margin-bottom: 4px; }
        .palette-title { font-size: 10px; color: #888; margin-bottom: 2px; }
        .palette-swatch {
            width: 20px; height: 20px; border-radius: 4px; cursor: pointer; border: 1px solid rgba(0,0,0,0.1);
        }
        .palette-swatch:hover { transform: scale(1.1); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .custom-color-btn {
            font-size: 11px; padding: 2px 5px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; background: #eee; color: #333;
            display: flex; align-items: center; gap: 3px;
        }
        .color-picker-wrapper { position: relative; }
        .mini-color-picker {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;
        }
        .note-header, 
        .note-tools, 
        .note-label-chip,
        .font-size-btn,
        .color-dot,
        .stamp-item {
            user-select: none;
            -webkit-user-select: none;
        }
        #selection-menu,
        #context-menu,
        .ctx-item {
            user-select: none;
            -webkit-user-select: none;
            cursor: pointer;
        }
                /* æ—¢å­˜ã® #selection-menu ã« width auto ã‚’è¨±å¯ã—ã€paddingã‚’èª¿æ•´ */
        #selection-menu {
            /* æ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯ç¶­æŒã—ã¤ã¤ã€ä»¥ä¸‹ã‚’ç¢ºèªãƒ»èª¿æ•´ */
            min-width: 180px; 
            padding: 5px;
        }
        /* --- ã‚¿ã‚¹ã‚¯é€²æ—ãƒãƒ¼ --- */
        .progress-bar-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(0,0,0,0.1);
            pointer-events: none;
            display: none; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆéè¡¨ç¤º */
        }
        .progress-bar-fill {
            height: 100%;
            background: #28a745; /* ç·‘è‰² */
            width: 0%;
            transition: width 0.3s ease;
        }
                /* --- ãƒ¬ãƒ¼ã‚¶ãƒ¼ãƒã‚¤ãƒ³ã‚¿ãƒ¼ --- */
        .laser-trail {
            position: fixed;
            width: 14px; /* å°‘ã—å¤§ããã—ã¦è¦–èªæ€§ã‚¢ãƒƒãƒ— */
            height: 14px;
            background: rgba(255, 50, 50, 0.8); /* é€éåº¦èª¿æ•´ */
            border-radius: 50%;
            pointer-events: none;
            box-shadow: 0 0 10px red, 0 0 20px red; /* å…‰å½©åŠ¹æœ */
            z-index: 999999;
            animation: fadeOutTrail 0.4s forwards; /* å°‘ã—çŸ­ã */
        }
        @keyframes fadeOutTrail {
            to { opacity: 0; transform: scale(0.1); }
        }
        
        /* â˜…ä¿®æ­£: å…¨è¦ç´ ã«å¯¾ã—ã¦å¼·åˆ¶çš„ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’æ¶ˆã™ */
        body.laser-mode,
        body.laser-mode * {
            cursor: none !important;
        }
        body.laser-mode button, 
        body.laser-mode .tool-btn, 
        body.laser-mode .main-btn {
            cursor: pointer !important;
        }
        

        /* --- è¿½åŠ : æ•´åˆ—ãƒ„ãƒ¼ãƒ«ç”¨ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .selection-tools-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(128,128,128,0.2);
        }
        .align-btn {
            background: transparent;
            border: 1px solid transparent;
            border-radius: 4px;
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-color);
            transition: 0.2s;
        }
        .align-btn:hover {
            background: var(--folder-hover);
            border-color: rgba(128,128,128,0.3);
        }
        .align-btn .material-symbols-outlined {
            font-size: 18px;
        }
		        /* --- ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .toggle-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            cursor: pointer;
        }
        .toggle-row:hover {
            opacity: 0.8;
        }
        .toggle-label {
            font-size: 14px;
            color: var(--text-color);
            flex-grow: 1;
        }
        
        /* ã‚¹ã‚¤ãƒƒãƒã®åœŸå° */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
            flex-shrink: 0;
            margin-left: 10px;
        }

        /* æ—¢å­˜ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’éš ã™ */
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼éƒ¨åˆ† */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc; /* OFFæ™‚ã®è‰² */
            transition: .4s cubic-bezier(0.4, 0.0, 0.2, 1); /* æ»‘ã‚‰ã‹ãªå‹•ã */
            border-radius: 34px;
        }

        /* ã¤ã¾ã¿éƒ¨åˆ† */
        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s cubic-bezier(0.4, 0.0, 0.2, 1);
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* ONæ™‚ã®èƒŒæ™¯è‰² */
        input:checked + .slider {
            background-color: var(--highlight-stroke); /* ã‚¢ãƒ—ãƒªã®ãƒ†ãƒ¼ãƒè‰²ã‚’ä½¿ç”¨ */
        }

        /* ONæ™‚ã®ã¤ã¾ã¿ç§»å‹• */
        input:checked + .slider:before {
            transform: translateX(24px);
        }

        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œï¼ˆOFFæ™‚ã®è‰²ã‚’æš—ã‚ã«ï¼‰ */
        .dark-mode .slider {
            background-color: #555;
        }
                /* --- ãƒŸãƒ‹ãƒãƒƒãƒ—ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        #minimap-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 200px;
            height: 150px;
            background: var(--ui-bg);
            border: 1px solid var(--grid-color);
            box-shadow: var(--ui-shadow);
            z-index: 4000;
            overflow: hidden;
            border-radius: 8px;
            backdrop-filter: blur(5px);
            opacity: 0.9;
        }
        #minimap-content {
            position: relative;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            cursor: pointer;
        }
        .minimap-node {
            position: absolute;
            background-color: var(--accent-color);
            opacity: 0.6;
            border-radius: 2px;
            pointer-events: none;
        }
        #minimap-viewport {
            position: absolute;
            border: 2px solid var(--highlight-stroke);
            background-color: rgba(50, 150, 255, 0.1);
            cursor: grab;
            box-sizing: border-box;
        }
        #minimap-viewport:active {
            cursor: grabbing;
            background-color: rgba(50, 150, 255, 0.2);
        }
                /* --- å†…éƒ¨ãƒªãƒ³ã‚¯ --- */
        a.internal-link {
            color: #0056b3;
            text-decoration: underline;
            border-bottom: 1px dashed #0056b3;
            cursor: pointer;
            font-weight: bold;
        }
        a.internal-link:hover {
            color: #003d82;
            background-color: rgba(0, 86, 179, 0.1);
        }
        /* --- ç·¨é›†ç”¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ --- */
        #editor-context-menu {
            position: fixed;
            background: var(--ui-bg);
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            padding: 5px 0;
            z-index: 10005; /* ä»–ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚ˆã‚Šä¸Š */
            display: none;
            backdrop-filter: blur(10px);
            min-width: 180px;
            color: var(--text-color);
        }
        /* ãƒªãƒ³ã‚¯å…ˆã‚¢ã‚¤ã‚³ãƒ³ï¼ˆCSSæ“¬ä¼¼è¦ç´ ã§è¡¨ç¾ï¼‰ */
        a.internal-link::before {
            content: "ğŸ”—";
            font-size: 0.8em;
            margin-right: 2px;
        }

        /* --- ãƒªãƒ³ã‚¯ä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ« --- */
        .link-picker-tabs {
            display: flex;
            border-bottom: 1px solid #ccc;
            margin-bottom: 10px;
        }
        .link-tab {
            padding: 8px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: var(--text-color);
        }
        .link-tab.active {
            border-bottom-color: var(--accent-color);
            font-weight: bold;
        }
        .link-target-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--input-border);
            border-radius: 4px;
        }
        .link-target-item {
            padding: 8px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }
        .link-target-item:hover {
            background: var(--folder-hover);
        }
        .link-target-name { font-weight: bold; font-size: 14px; }
        .link-target-detail { font-size: 11px; color: #666; }
        .back-link {
            color: inherit;
            text-decoration: none;
            transition: 0.3s; /* ã˜ã‚ã£ã¨è‰²ãŒå¤‰ã‚ã‚‹è¨­å®š */
        }

        .back-link:hover {
            color: #ffb88f; /* ãƒã‚¦ã‚¹ã‚’ä¹—ã›ãŸæ™‚ã®è‰²ï¼ˆãŠå¥½ã¿ã§ï¼ï¼‰ */
            text-underline-offset: 4px;
            text-decoration: underline; /* ãƒªãƒ³ã‚¯ã£ã½ãä¸‹ç·šã‚’å‡ºã™ */
        }
    </style>
</head>
<body>

<div id="mode-indicator" class="mode-indicator">æ¥ç¶šãƒ¢ãƒ¼ãƒ‰ä¸­</div>

<div id="floating-text-menu" class="hidden">
    <div class="floating-toolbar">
    	<button class="float-btn" onmousedown="openLinkPicker(event)" title="å†…éƒ¨ãƒªãƒ³ã‚¯ä½œæˆ"><span class="material-symbols-outlined">link</span></button>
        <div class="separator" style="height:15px; margin:0 5px;"></div>
        <button class="float-btn" id="toggle-palette-btn" onmousedown="event.preventDefault();" title="æ–‡å­—è‰²"><span class="material-symbols-outlined">format_color_text</span></button>
        <button class="float-btn" onmousedown="execCmd(event, 'bold')" title="å¤ªå­—"><span class="material-symbols-outlined">format_bold</span></button>
        <button class="float-btn" onmousedown="execCmd(event, 'underline')" title="ä¸‹ç·š"><span class="material-symbols-outlined">format_underlined</span></button>
        <button class="float-btn" onmousedown="execCmd(event, 'strikeThrough')" title="å–ã‚Šæ¶ˆã—ç·š"><span class="material-symbols-outlined">strikethrough_s</span></button>
        <div class="separator" style="height:15px; margin:0 5px;"></div>
        <button class="float-btn" onmousedown="execCmd(event, 'fontSize', '3')" title="å°">A</button>
        <button class="float-btn" onmousedown="execCmd(event, 'fontSize', '5')" title="ä¸­" style="font-size:16px;">A</button>
        <button class="float-btn" onmousedown="execCmd(event, 'fontSize', '7')" title="å¤§" style="font-size:18px;">A</button>
    </div>
    
    <div id="floating-color-palette">
        <div class="palette-row" id="preset-colors-container"></div>
        <div class="palette-title">æœ€è¿‘ä½¿ç”¨ & ã‚«ã‚¹ã‚¿ãƒ </div>
        <div class="palette-row">
            <div id="recent-colors-container" style="display:flex; gap:4px;"></div>
            <div class="color-picker-wrapper">
                <button class="custom-color-btn"><span class="material-symbols-outlined" style="font-size:14px;">palette</span> ä»–</button>
                <input type="color" id="float-color-input" class="mini-color-picker">
            </div>
        </div>
    </div>
</div>

<div id="app-container">
    <div id="sidebar">
        <div class="sidebar-header">
            <a href="https://parumenn.server-on.net/" class="back-link">
    <span>&lt; ã¾ã„ã¤ãƒ¼ã‚‹ã¸æˆ»ã‚‹ &lt;</span>
</a>
            <button class="tool-btn" onclick="createNewFolder()" title="ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ">
                <span class="material-symbols-outlined">create_new_folder</span>
            </button>
        </div>
        <div class="sidebar-content" id="sidebar-tree"></div>

        <script>
  atOptions = {
    'key' : '93250590c6cc4fa213dc408950ac67ef',
    'format' : 'iframe',
    'height' : 300,
    'width' : 160,
    'params' : {}
  };
</script>
<script src="https://www.highperformanceformat.com/93250590c6cc4fa213dc408950ac67ef/invoke.js"></script>


    </div>

    <div id="main-area">
        <div id="canvas-wrapper">
            <div id="board">
                <svg id="svg-layer-back"></svg>
                <svg id="svg-layer-front"></svg>
            </div>
        </div>

        <div id="ui-layer">
            <button class="main-btn" onclick="addNewNote()">
                <span class="material-symbols-outlined">add</span> è¿½åŠ 
            </button>
            <button class="main-btn" id="connect-mode-btn" onclick="toggleConnectMode()" title="æ¥ç¶šãƒ¢ãƒ¼ãƒ‰">
                <span class="material-symbols-outlined">timeline</span>
            </button>
            <button class="main-btn" id="draw-mode-btn" onclick="toggleDrawMode()" title="ãƒšãƒ³">
                <span class="material-symbols-outlined">draw</span>
            </button>
            <button class="main-btn" id="eraser-mode-btn" onclick="toggleEraserMode()" title="æ¶ˆã—ã‚´ãƒ ">
                <span class="material-symbols-outlined">ink_eraser</span>
            </button>
            <div class="separator"></div>
            <button class="tool-btn" onclick="openSearch()" title="æ¤œç´¢">
                <span class="material-symbols-outlined">search</span>
            </button>
            <button class="tool-btn" id="laser-btn" onclick="toggleLaserMode()" title="ãƒ¬ãƒ¼ã‚¶ãƒ¼ãƒã‚¤ãƒ³ã‚¿ãƒ¼ (Lã‚­ãƒ¼)">
                <span class="material-symbols-outlined" style="color:red;">flare</span>
            </button>
            <button class="tool-btn" onclick="executeUndo()" title="å…ƒã«æˆ»ã™ (Ctrl+Z)">
                <span class="material-symbols-outlined">undo</span>
            </button>
            <button class="tool-btn" onclick="executeRedo()" title="ã‚„ã‚Šç›´ã™ (Ctrl+Y)">
                <span class="material-symbols-outlined">redo</span>
            </button>
            <div class="separator"></div>
            <button class="tool-btn" onclick="resetView()" title="è¡¨ç¤ºä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆ">
                <span class="material-symbols-outlined">center_focus_strong</span>
            </button>
            <button class="tool-btn" onclick="adjustZoom(-10)" style="background:#fff; border:1px solid #ccc; border-radius:4px; margin-right:5px; user-select:none;" title="ç¸®å°">
			    <span class="material-symbols-outlined" style="color:#555;">zoom_out</span>
			</button>
			<input type="range" id="zoom-slider" min="10" max="300" value="100" step="5" title="ã‚ºãƒ¼ãƒ ">
			<button class="tool-btn" onclick="adjustZoom(10)" style="background:#fff; border:1px solid #ccc; border-radius:4px; margin-left:5px; user-select:none;" title="æ‹¡å¤§">
			    <span class="material-symbols-outlined" style="color:#555;">zoom_in</span>
			</button>
            <span id="zoom-level" style="font-weight:bold; min-width:40px; text-align:center;">100%</span>
            <div class="separator"></div>
            <button class="tool-btn" onclick="openSettings()" title="è¨­å®š">
                <span class="material-symbols-outlined">settings</span>
            </button>
            <button class="tool-btn" onclick="toggleDarkMode()" title="ãƒ†ãƒ¼ãƒ">
                <span class="material-symbols-outlined" id="theme-icon">dark_mode</span>
            </button>
        </div>
    </div>
</div>

<div id="minimap-container">
    <div id="minimap-content">
        <div id="minimap-viewport"></div>
    </div>
</div>
<!-- ä»˜ç®‹ç·¨é›†ç”¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
<div id="editor-context-menu">
    <div class="ctx-item" onclick="openLinkPicker(event)">
        <span class="material-symbols-outlined" style="font-size:16px;">link</span> å†…éƒ¨ãƒªãƒ³ã‚¯æŒ¿å…¥
    </div>
    <div class="separator-horizontal" style="margin:5px 0;"></div>
    <!-- å¿…è¦ã«å¿œã˜ã¦ã‚³ãƒ”ãƒ¼/ãƒšãƒ¼ã‚¹ãƒˆãªã©ã‚‚å®Ÿè£…å¯èƒ½ã§ã™ãŒã€ãƒ–ãƒ©ã‚¦ã‚¶åˆ¶é™ãŒã‚ã‚‹ãŸã‚ä»Šå›ã¯ãƒªãƒ³ã‚¯ã®ã¿ -->
</div>
<!-- ãƒªãƒ³ã‚¯å…ˆé¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="link-picker-modal" class="modal-overlay" onclick="if(event.target === this) this.style.display='none'">
    <div class="modal-content">
        <div class="modal-header">
            <span class="modal-title">ãƒªãƒ³ã‚¯å…ˆã‚’é¸æŠ</span>
            <span class="close-modal" onclick="document.getElementById('link-picker-modal').style.display='none'">âœ•</span>
        </div>
        
        <div class="link-picker-tabs">
            <div class="link-tab active" onclick="switchLinkTab('sheet')" id="tab-link-sheet">ã‚·ãƒ¼ãƒˆ</div>
            <div class="link-tab" onclick="switchLinkTab('note')" id="tab-link-note">ä»˜ç®‹ (æ¤œç´¢)</div>
        </div>

        <!-- ã‚·ãƒ¼ãƒˆä¸€è¦§ç”¨ -->
        <div id="link-sheet-container">
            <div id="link-sheet-list" class="link-target-list"></div>
        </div>

        <!-- ä»˜ç®‹æ¤œç´¢ç”¨ -->
        <div id="link-note-container" style="display:none;">
            <input type="text" id="link-note-search" class="search-input" placeholder="ä»˜ç®‹ã®å†…å®¹ã‚’æ¤œç´¢..." oninput="searchLinkNotes()">
            <div id="link-note-list" class="link-target-list" style="margin-top:5px;"></div>
        </div>
    </div>
</div>

<div id="settings-modal" class="modal-overlay" onclick="if(event.target === this) this.style.display='none'">
    <div class="modal-content">
        <div class="modal-header">
            <span class="modal-title">è¨­å®š</span>
            <span class="close-modal" onclick="document.getElementById('settings-modal').style.display='none'">âœ•</span>
        </div>
        
        <div class="section-title">ã‚«ãƒ©ãƒ¼ãƒ—ãƒªã‚»ãƒƒãƒˆ</div>
        <!-- å¤‰æ›´æ¤œçŸ¥ç”¨ã®ãŸã‚ã€JSã§ä¸­èº«ã‚’ç”Ÿæˆã™ã‚‹å½¢ã‚’ç¶­æŒ -->
        <div class="color-inputs" id="color-setting-container"></div>
        
        <div class="separator-horizontal"></div>
        <div class="section-title">å‹•ä½œè¨­å®š</div>
        
        <!-- ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒ1: å‰Šé™¤ç¢ºèª (å¤‰æ›´æ™‚ã« saveSettings ã‚’å‘¼ã¶) -->
        <label class="toggle-row">
            <span class="toggle-label">ä»˜ç®‹å‰Šé™¤æ™‚ã«ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹</span>
            <div class="switch">
                <input type="checkbox" id="setting-confirm-delete" onchange="saveSettings(true)">
                <span class="slider"></span>
            </div>
        </label>

        <!-- ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒ2: å¸ç€è¨­å®š (å¤‰æ›´æ™‚ã« saveSettings ã‚’å‘¼ã¶) -->
        <label class="toggle-row">
            <span class="toggle-label">ã‚°ãƒªãƒƒãƒ‰ãƒ»ä»–ã®ä»˜ç®‹ã«å¸ç€ã•ã›ã‚‹</span>
            <div class="switch">
                <input type="checkbox" id="setting-snap" onchange="saveSettings(true)">
                <span class="slider"></span>
            </div>
        </label>

		<!-- ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒ3: ãƒŸãƒ‹ãƒãƒƒãƒ—è¡¨ç¤ºæœ‰ç„¡ -->
        <label class="toggle-row">
            <span class="toggle-label">ãƒŸãƒ‹ãƒãƒƒãƒ—ã‚’è¡¨ç¤ºã™ã‚‹</span>
            <div class="switch">
                <input type="checkbox" id="setting-show-minimap" onchange="saveSettings(true)">
                <span class="slider"></span>
            </div>
        </label>

        <div class="separator-horizontal"></div>
        <div class="section-title">ãƒ‡ãƒ¼ã‚¿ç®¡ç†</div>
        <div style="display:flex; gap:10px; justify-content:center;">
            <button class="sub-btn" onclick="exportData()"><span class="material-symbols-outlined">download</span> ä¿å­˜</button>
            <button class="sub-btn" onclick="document.getElementById('file-input').click()"><span class="material-symbols-outlined">upload</span> èª­è¾¼</button>
            <input type="file" id="file-input" style="display:none" accept=".json" onchange="importData(this)">
        </div>
        <script>
            atOptions = {
                'key' : '81d0dacf5b714eeb79142328413edb66',
                'format' : 'iframe',
                'height' : 250,
                'width' : 300,
                'params' : {}
            };
        </script>
<script src="https://www.highperformanceformat.com/81d0dacf5b714eeb79142328413edb66/invoke.js"></script>
        <div class="separator-horizontal"></div>
        <div class="section-title" style="color:var(--danger-color);">ãã®ä»–</div>
        <button class="danger-btn" onclick="resetAllData()" style="width:100%;">å…¨ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–</button>
    </div>
</div>

<div id="search-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header"><span class="modal-title">æ¤œç´¢</span><span class="close-modal" onclick="document.getElementById('search-modal').style.display='none'">âœ•</span></div>
        <div class="search-controls">
            <input type="text" id="search-keyword" class="search-input" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰..." oninput="performSearch()">
            <select id="search-filter-label" class="filter-select" onchange="performSearch()"><option value="">å…¨ã¦ã®ãƒ©ãƒ™ãƒ«</option></select>
        </div>
        <div class="section-title">æ¤œç´¢çµæœ</div><div id="search-results-list" class="search-results"><div style="text-align:center; color:#999; margin-top:20px;">æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div></div>
    </div>
</div>

<div id="stamp-menu">
    <div class="stamp-option" onclick="applyStamp('ğŸ‘')">ğŸ‘</div><div class="stamp-option" onclick="applyStamp('ğŸ‘')">ğŸ‘</div>
    <div class="stamp-option" onclick="applyStamp('â¤ï¸')">â¤ï¸</div><div class="stamp-option" onclick="applyStamp('ğŸ‰')">ğŸ‰</div>
    <div class="stamp-option" onclick="applyStamp('âœ…')">âœ…</div><div class="stamp-option" onclick="applyStamp('âŒ')">âŒ</div>
    <div class="stamp-option" onclick="applyStamp('â—')">â—</div><div class="stamp-option" onclick="applyStamp('â“')">â“</div>
</div>

<div id="label-menu">
    <div style="font-size:11px; color:var(--text-color); margin-bottom:5px;">ç¾åœ¨ã®ãƒ©ãƒ™ãƒ« (ã‚¯ãƒªãƒƒã‚¯ã§å‰Šé™¤):</div><div id="current-labels-container" class="label-current"></div>
    <input type="text" id="label-input" class="label-input" placeholder="æ–°ã—ã„ãƒ©ãƒ™ãƒ«..." onkeydown="if(event.key==='Enter') addLabelFromInput()">
    <button class="sub-btn" onclick="addLabelFromInput()" style="width:100%; margin-bottom:5px; justify-content:center;">è¿½åŠ </button>
    <div style="font-size:11px; color:var(--text-color); margin-bottom:5px;">å±¥æ­´ã‹ã‚‰è¿½åŠ :</div><div id="label-history-list" class="label-list"></div>
</div>

<div id="context-menu"></div>
<div id="selection-lasso" class="selection-lasso"></div>
<div id="selection-menu">
    <!-- è¿½åŠ : æ•´åˆ—ãƒœã‚¿ãƒ³ç¾¤ -->
    <div class="selection-tools-grid">
        <button class="align-btn" onclick="alignSelectedItems('left')" title="å·¦æƒãˆ"><span class="material-symbols-outlined">align_horizontal_left</span></button>
        <button class="align-btn" onclick="alignSelectedItems('center-x')" title="å·¦å³ä¸­å¤®æƒãˆ"><span class="material-symbols-outlined">align_horizontal_center</span></button>
        <button class="align-btn" onclick="alignSelectedItems('right')" title="å³æƒãˆ"><span class="material-symbols-outlined">align_horizontal_right</span></button>
        
        <button class="align-btn" onclick="alignSelectedItems('top')" title="ä¸Šæƒãˆ"><span class="material-symbols-outlined">align_vertical_top</span></button>
        <button class="align-btn" onclick="alignSelectedItems('center-y')" title="ä¸Šä¸‹ä¸­å¤®æƒãˆ"><span class="material-symbols-outlined">align_vertical_center</span></button>
        <button class="align-btn" onclick="alignSelectedItems('bottom')" title="ä¸‹æƒãˆ"><span class="material-symbols-outlined">align_vertical_bottom</span></button>
    </div>
    <!-- æ—¢å­˜ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® -->
    <div class="ctx-item" onclick="duplicateSelectedItems()"><span class="material-symbols-outlined" style="font-size:16px;">content_copy</span> è¤‡è£½</div>
    <div class="ctx-item" onclick="deleteSelectedItems()" style="color:var(--danger-color);"><span class="material-symbols-outlined" style="font-size:16px;">delete</span> æ¶ˆå»</div>
</div>



<script>
    const STORAGE_KEY = 'rich_sticky_notes_v17';
    const board = document.getElementById('board');
    const wrapper = document.getElementById('canvas-wrapper');
    const sidebarTree = document.getElementById('sidebar-tree');
    const zoomLevelDisplay = document.getElementById('zoom-level');
    const zoomSlider = document.getElementById('zoom-slider');
    const ctxMenu = document.getElementById('context-menu');
    const settingsModal = document.getElementById('settings-modal');
    const searchModal = document.getElementById('search-modal');
    const connectModeBtn = document.getElementById('connect-mode-btn');
    const drawModeBtn = document.getElementById('draw-mode-btn');
    const eraserModeBtn = document.getElementById('eraser-mode-btn');
    const stampMenu = document.getElementById('stamp-menu');
    const labelMenu = document.getElementById('label-menu');
    const selectionLasso = document.getElementById('selection-lasso');
    const selectionMenu = document.getElementById('selection-menu');
    
    const floatingMenu = document.getElementById('floating-text-menu');
    const floatingPalette = document.getElementById('floating-color-palette');
    const togglePaletteBtn = document.getElementById('toggle-palette-btn');
    const floatColorInput = document.getElementById('float-color-input');
    const presetColorsContainer = document.getElementById('preset-colors-container');
    const recentColorsContainer = document.getElementById('recent-colors-container');

    const PRESET_TEXT_COLORS = ['#333333', '#d93535', '#005cc5', '#008a2e', '#e67c00', '#6f42c1', '#888888'];

    let appData = {
        darkMode: false,
        snapToGrid: true,
        showMinimap: true,
        colors: ['#fff740', '#ff7eb9', '#7afcff', '#feff9c', '#91ffb3', '#e0e0e0'], 
        folders: [{ id: 'f_default', name: 'ãƒã‚¤ãƒ•ã‚©ãƒ«ãƒ€', isOpen: true }],
        sheets: [{ id: 's_default', folderId: 'f_default', name: 'ã¯ã˜ã‚ã«', data: null }],
        currentSheetId: 's_default',
        confirmDelete: true,
        recentTextColors: [] 
    };

    let currentScale = 1;
    let zIndexCounter = 1;
    
    let isConnectMode = false;
    let connectSourceId = null; 
    let isDrawMode = false;
    let isEraserMode = false;
    let isDrawing = false; 
    
    let activeNoteId = null;
    let undoStack = [];
    let redoStack = [];
    const MAX_HISTORY = 50;

    let selectedItems = { notes: new Set(), drawings: new Set(), connections: new Set() };
    
    let isLassoSelecting = false;
    let lassoStart = { x: 0, y: 0 };
    let lassoRect = { left: 0, top: 0, width: 0, height: 0 };
    let currentTextSelectionRange = null;
    
    let preventContextMenu = false;    
    let ctxOutsideHandler = null;
    let minimapScale = 0.5;
    /*----------ãƒ¬ãƒ¼ã‚¶ãƒ¼ãƒã‚¤ãƒ³ã‚¿----------*/
    let isLaserMode = false;
    let laserInterval = null;
    /*------------å†…éƒ¨ãƒªãƒ³ã‚¯-----------*/
    let savedSelectionRange = null;
	/*------------spaceï¼‹ãƒ‰ãƒ©ãƒƒã‚°ã§ã©ã“ã§ã‚‚ç§»å‹•-----------*/
    let isSpacePressed = false;
     
    function init() {
        const loaded = localStorage.getItem(STORAGE_KEY);
        if (loaded) {
            try {
                const parsed = JSON.parse(loaded);
                if (parsed.sheets && Array.isArray(parsed.sheets) && parsed.folders && Array.isArray(parsed.folders)) {
                    appData = { ...appData, ...parsed };
                    if (!appData.recentTextColors) appData.recentTextColors = [];
                    const sheetExists = appData.sheets.some(s => s.id === appData.currentSheetId);
                    if (!sheetExists) {
                        if (appData.sheets.length > 0) {
                            appData.currentSheetId = appData.sheets[0].id;
                        } else {
                            saveCurrentSheetToData(true);
                        }
                    }
                } else {
                    saveCurrentSheetToData(true);
                }
            } catch(e) { 
                console.error('Data load error', e); 
                saveCurrentSheetToData(true);
            }
        } else { saveCurrentSheetToData(true); }
        
        applyTheme(); 
        renderSidebar(); 
        renderColorPalette(); 
        loadSheet(appData.currentSheetId, true);
        initMinimap();
        undoStack = []; redoStack = [];
        
        document.addEventListener('mouseup', handleGlobalMouseUp);
        document.addEventListener('keyup', handleGlobalKeyUp);
    }

    function initMinimap() {
        const mmCont = document.getElementById('minimap-content');
        const mmView = document.getElementById('minimap-viewport');
        
        // ãƒŸãƒ‹ãƒãƒƒãƒ—ã‚¯ãƒªãƒƒã‚¯ã§ç§»å‹•
        mmCont.addEventListener('mousedown', (e) => {
            if (e.target !== mmView) {
                const rect = mmCont.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const clickY = e.clientY - rect.top;
                
                // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®ä¸­å¿ƒã‚’ã‚¯ãƒªãƒƒã‚¯ä½ç½®ã«åˆã‚ã›ã‚‹è¨ˆç®—ï¼ˆç°¡æ˜“ç‰ˆï¼‰
                // å®Ÿéš›ã«ã¯é€†ç®—ã—ã¦ board.style.left/top ã‚’æ›´æ–°ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ãŒå¿…è¦
                // ã“ã“ã§ã¯æç”»æ›´æ–°ã®ã¿è¡Œã„ã¾ã™ï¼ˆå®Œå…¨ãªå®Ÿè£…ã¯ä¸‹è¨˜ updateMinimap å‚ç…§ï¼‰
            }
        });

        // å®šæœŸçš„ã«ãƒŸãƒ‹ãƒãƒƒãƒ—ã‚’æ›´æ–°ï¼ˆã¾ãŸã¯æ“ä½œã®ãŸã³ã«å‘¼ã¶ï¼‰
        setInterval(updateMinimap, 500); // è² è·è»½æ¸›ã®ãŸã‚0.5ç§’é–“éš”ãªã©
    }
    
	function hideContextMenu() {
	    if (ctxMenu) {
	        ctxMenu.style.display = 'none';
	    }
	    // å¤–å´ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥ã®è§£é™¤
	    if (ctxOutsideHandler) {
	        document.removeEventListener('mousedown', ctxOutsideHandler, true);
	        document.removeEventListener('touchstart', ctxOutsideHandler, true);
	        document.removeEventListener('scroll', ctxOutsideHandler, true);
	        window.removeEventListener('resize', ctxOutsideHandler, true);
	        ctxOutsideHandler = null;
	    }
	}

    
    
	function createNewFolder() {
	    // ãƒ•ã‚©ãƒ«ãƒ€åã‚’å…¥åŠ›ï¼ˆæœªå…¥åŠ›ã‚„ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã¯ä¸­æ–­ï¼‰
	    const name = prompt('ãƒ•ã‚©ãƒ«ãƒ€åã‚’å…¥åŠ›', 'æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€');
	    if (!name) return;

	    // ä¸€æ„ãªIDã‚’ç™ºè¡Œ
	    const id = 'f_' + Date.now() + '_' + Math.floor(Math.random() * 1000);

	    // å±¥æ­´è¨˜éŒ²ï¼ˆUndo/Redo å¯¾å¿œï¼‰
	    if (typeof recordHistory === 'function') {
	        recordHistory();
	    }

	    // ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒ‡ãƒ¼ã‚¿ã«è¿½åŠ ï¼ˆé–‹ã„ãŸçŠ¶æ…‹ã§è¿½åŠ ï¼‰
	    appData.folders.push({
	        id,
	        name,
	        isOpen: true
	    });

	    // UIæ›´æ–° & ä¿å­˜
	    renderSidebar();
	    saveData();
	}


    function handleGlobalMouseUp(e) {
        if (isLassoSelecting || isConnectMode || isDrawMode || isEraserMode) return;
        const sel = window.getSelection();
        if (sel.toString().length > 0) {
            const anchor = sel.anchorNode;
            if (!anchor) return;
            const contentEl = anchor.nodeType === 3 ? anchor.parentElement.closest('.note-content') : anchor.closest('.note-content');
            if (contentEl && contentEl.isContentEditable) {
                const range = sel.getRangeAt(0);
                currentTextSelectionRange = range;
                const rect = range.getBoundingClientRect();
                floatingMenu.style.left = `${rect.right}px`;
                floatingMenu.style.top = `${rect.bottom + 10}px`; 
                floatingMenu.classList.remove('hidden');
                return;
            }
        }
        if (!e.target.closest('#floating-text-menu')) {
            floatingMenu.classList.add('hidden');
            floatingPalette.classList.remove('show');
        }
    }

    function handleGlobalKeyUp(e) {
        if (isLassoSelecting || isConnectMode || isDrawMode || isEraserMode) return;
        
        const sel = window.getSelection();
        if (sel.toString().length > 0) {
            const anchor = sel.anchorNode;
            if (!anchor) return;
            const contentEl = anchor.nodeType === 3 ? anchor.parentElement.closest('.note-content') : anchor.closest('.note-content');
            if (contentEl && contentEl.isContentEditable) {
                const range = sel.getRangeAt(0);
                currentTextSelectionRange = range;
                const rect = range.getBoundingClientRect();
                floatingMenu.style.left = `${rect.right}px`;
                floatingMenu.style.top = `${rect.bottom + 10}px`; 
                floatingMenu.classList.remove('hidden');
                return;
            }
        }
        
        // é¸æŠç¯„å›²ãŒãªããªã£ãŸå ´åˆã¯é–‰ã˜ã‚‹
        floatingMenu.classList.add('hidden');
        floatingPalette.classList.remove('show');
    }

    function recordHistory() {
        saveCurrentSheetToData(); 
        const state = JSON.stringify(appData);
        undoStack.push(state);
        if (undoStack.length > MAX_HISTORY) undoStack.shift();
        redoStack = [];
    }

    function executeUndo() {
        if (undoStack.length === 0) return;
        saveCurrentSheetToData();
        redoStack.push(JSON.stringify(appData));
        const prevState = undoStack.pop();
        restoreState(prevState);
    }

    function executeRedo() {
        if (redoStack.length === 0) return;
        saveCurrentSheetToData();
        undoStack.push(JSON.stringify(appData));
        const nextState = redoStack.pop();
        restoreState(nextState);
    }

    function restoreState(jsonState) {
        appData = JSON.parse(jsonState);
        applyTheme(); renderSidebar(); renderColorPalette();
        loadSheet(appData.currentSheetId, true); refreshNotePalettes(); saveData();
    }

    document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'z') { e.preventDefault(); if (e.shiftKey) executeRedo(); else executeUndo(); } 
        else if ((e.ctrlKey || e.metaKey) && e.key === 'y') { e.preventDefault(); executeRedo(); } 
        else if (e.key === 'Escape') {
            if(isConnectMode) toggleConnectMode(); if(isDrawMode) toggleDrawMode(); if(isEraserMode) toggleEraserMode();
            closePopups(); selectionMenu.style.display = 'none'; floatingMenu.classList.add('hidden');
        }
    });

    function saveData() { 
        saveCurrentSheetToData(); 
        try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData)); 
        } catch (e) {
            if (e.name === 'QuotaExceededError') {
                alert('ä¿å­˜å®¹é‡ã®ä¸Šé™ã‚’è¶…ãˆã¾ã—ãŸã€‚å¤§ããªç”»åƒã‚’å‰Šé™¤ã™ã‚‹ã‹ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã—ã¦ãã ã•ã„ã€‚');
            } else {
                console.error('Save error', e);
            }
        }
    }
    
    function resetAllData() { if(confirm('æœ¬å½“ã«åˆæœŸåŒ–ã—ã¾ã™ã‹ï¼Ÿ')) { localStorage.removeItem(STORAGE_KEY); location.reload(); } }

    function exportData() {
        saveCurrentSheetToData(); const dataStr = JSON.stringify(appData, null, 2);
        const blob = new Blob([dataStr], { type: "application/json" }); const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = `memo_backup.json`;
        document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
    }

    function importData(input) {
        const file = input.files[0]; if (!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const importedData = JSON.parse(e.target.result);
                if (importedData.sheets && importedData.folders) {
                    if(confirm('å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿ')) {
                        appData = importedData;
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
                        applyTheme(); 
                        renderSidebar(); 
                        renderColorPalette();
                        if(!appData.sheets.find(s=>s.id === appData.currentSheetId)) {
                            appData.currentSheetId = appData.sheets[0].id;
                        }
                        loadSheet(appData.currentSheetId, true); 
                        refreshNotePalettes(); 
                        settingsModal.style.display = 'none';
                    }
                } else { alert('ç„¡åŠ¹ãªãƒ‡ãƒ¼ã‚¿ã§ã™'); }
            } catch(err) { alert('èª­è¾¼å¤±æ•—'); }
        };
        reader.readAsText(file); input.value = '';
    }

    function addNewNote() {
        recordHistory();
        const rect = wrapper.getBoundingClientRect();
        const boardLeft = parseFloat(board.style.left || 0);
        const boardTop = parseFloat(board.style.top || 0);
        const x = (rect.width / 2 - boardLeft) / currentScale - 100;
        const y = (rect.height / 2 - boardTop) / currentScale - 75;
        const noteId = 'n_' + Date.now() + '_' + Math.floor(Math.random()*1000);
        createNoteDOM({
            id: noteId,
            left: `${x}px`,
            top: `${y}px`,
            backgroundColor: appData.colors[0],
            labels: [],
            stamps: []
        });
        saveData();
    }


function saveCurrentSheetToData(isInitial = false) {
  if (isInitial) {
    const initialJsonRaw = String.raw`
{
  "folders": [
    {
      "id": "f_default",
      "name": "ãƒã‚¤ãƒ•ã‚©ãƒ«ãƒ€",
      "isOpen": false
    },
    {
      "id": "f_1767928903155",
      "name": "ãƒ¡ãƒ¢",
      "isOpen": true
    }
  ],
  "sheets": [
    {
      "id": "s_1767928896625",
      "folderId": "f_default",
      "name": "ã‚¦ã‚¨ãƒ«ã‚«ãƒ ã‚·ãƒ¼ãƒˆ",
      "data": {
        "notes": [
          {
            "id": "n_1768285890067_851",
            "left": "234.436px",
            "top": "180.061px",
            "width": "584px",
            "height": "312px",
            "backgroundColor": "rgb(255, 247, 64)",
            "zIndex": 4,
            "contentHTML": "<font size=\"5\"><b>â‘ </b></font><b>\nâ– ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¡ãƒ¢å¸³</b><div><b>â–¼èƒŒæ™¯</b></div><div><b>ã€€æ—¢å­˜WEBã‚µãƒ¼ãƒ“ã‚¹ã®ä»˜ç®‹å‹ãƒ¡ãƒ¢å¸³ã‚µã‚¤ãƒˆã«å¯¾ã—ã¦ç¤¾å†…æƒ…å ±ã‚’è¨˜è¼‰ã™ã‚‹ã“ã¨ã¯ã§ããªã„ç‚ºãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ä½œã™ã‚‹ãŸã ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æœ¬æ©Ÿèƒ½ã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚</b></div><div><b>ç›´æ„Ÿçš„ãªæ“ä½œã‚’ã‚¢ãƒ—ãƒªã§ã¯ãªããƒ–ãƒ©ã‚¦ã‚¶å®Œçµã«ã¦å®Ÿç¾ã—ã¾ã—ãŸã€‚\n<font color=\"#d93535\">ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¾å­˜ã—ã¾ã™ã€‚</font><br></b><div><br></div></div>",
            "fontSize": "15px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          },
          {
            "id": "n_1768287619039_149",
            "left": "949.65px",
            "top": "321.548px",
            "width": "",
            "height": "",
            "backgroundColor": "rgb(255, 247, 64)",
            "zIndex": 1,
            "contentHTML": "<div><font size=\"5\" style=\"\"><b>â‘¡</b></font></div><b>â– ç”»é¢ã®ä½¿ã„æ–¹\nä»˜ç®‹ä»¥å¤–ã®éƒ¨åˆ†ã‹ã€ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ï¼‹ãƒ‰ãƒ©ãƒƒã‚°ã§ç”»é¢ã®ç§»å‹•ãŒã§ãã¾ã™ã€‚\nç”»é¢ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦<font color=\"#d93535\">å³æ–¹å‘ã«ã‚ã‚‹</font>æ¬¡ã®Tipsã‚’è¡¨ç¤ºã—ã¦ãã ã•ã„ã€‚</b>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          },
          {
            "id": "n_1768287711213_295",
            "left": "1802.01px",
            "top": "196.604px",
            "width": "618px",
            "height": "474px",
            "backgroundColor": "rgb(255, 247, 64)",
            "zIndex": 1,
            "contentHTML": "<b><font size=\"5\">â‘¢</font></b><div><font size=\"3\"><b>â– è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰\nç”»é¢å³ä¸‹ã«ã¦ãƒ©ã‚¤ãƒˆ/ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å¤‰æ›´ãŒã§ãã¾ã™ã€‚</b></font></div><div><img src=\"data:image/png;base64,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\" style=\"cursor: default; width: 126px; height: auto;\"></div><div><b>â†•ã€€ä»˜ç®‹å†…ã«ã¯ç”»åƒã‚’è²¼ã‚‹ã“ã¨ãŒã§ãç”»åƒå³ä¸‹ã®éš…ã«ã¦ã‚µã‚¤ã‚ºã‚’ãƒ”ãƒ³ãƒã§ãã¾ã™</b></div><div><img src=\"data:image/png;base64,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\" style=\"cursor: default; width: 130px; height: auto;\"></div>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          },
          {
            "id": "n_1768289259289_224",
            "left": "664.436px",
            "top": "623.283px",
            "width": "",
            "height": "",
            "backgroundColor": "rgb(224, 224, 224)",
            "zIndex": 1,
            "contentHTML": "<font size=\"5\"><b>â‘¨</b></font><b>\nä»¥ä¸Šã§ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚¬ã‚¤ãƒ‰ã¯çµ‚äº†ã§ã™</b>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          },
          {
            "id": "n_1768289298942_721",
            "left": "2649.55px",
            "top": "178.283px",
            "width": "467px",
            "height": "512px",
            "backgroundColor": "rgb(255, 163, 205)",
            "zIndex": 1,
            "contentHTML": "<b><font size=\"5\">â‘£</font></b><div><b>â– ä»˜ç®‹ã®ç·¨é›†</b></div><div><b>ä»˜ç®‹ã¯ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†ã™ã‚‹ã“ã¨ãŒã§ãä»¥ä¸‹ã®ç·¨é›†ãŒå¯èƒ½ã§ã™ã€‚</b></div><div><img src=\"data:image/png;base64,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\" style=\"cursor: default;\"></div><div><b>ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã«ã¦è£…é£¾ç·¨é›†\nâ–¼ä»˜ç®‹ä¸‹ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼</b></div><div><b>ä»˜ç®‹è‰²å¤‰æ›´ã€Todoç”¨ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã€ãƒ©ãƒ™ãƒ«ã®è¿½åŠ ã€ã‚¹ã‚¿ãƒ³ãƒ—ã®è¿½åŠ ã€ä»˜ç®‹ã®å‰å¾Œé–¢ä¿‚æ“ä½œãŒè¡Œãˆã¾ã™ã€‚</b></div><div><b>â–¼ä»˜ç®‹ä¸Šéƒ¨</b></div><div><b>ä»˜ç®‹ä¸Šéƒ¨ã®ãƒ‰ãƒ©ãƒƒã‚°ã§ç§»å‹•ãŒå¯èƒ½ã§ã™\n<input type=\"checkbox\">&nbsp;ã“ã®ä»˜ç®‹ã‚’å®Œäº†</b></div>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": [
              "ğŸ‘"
            ]
          },
          {
            "id": "n_1768290000675_471",
            "left": "2521.44px",
            "top": "908.283px",
            "width": "728px",
            "height": "590px",
            "backgroundColor": "rgb(255, 247, 64)",
            "zIndex": 1,
            "contentHTML": "<font size=\"5\">â‘¤</font><div>â– ç”»é¢ä¸‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã¤ã„ã¦</div><div><img src=\"data:image/png;base64,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\" style=\"cursor: default;\"></div><div>è¿½åŠ ãƒœã‚¿ãƒ³ã‚ˆã‚Šä»˜ç®‹ã®è¿½åŠ ãŒå¯èƒ½ã§ã™ã€‚</div><div><img src=\"data:image/png;base64,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\" style=\"cursor: default;\"></div><div>æ¥ç¶šãƒœã‚¿ãƒ³ã‚ˆã‚Šä»˜ç®‹åŒå£«ã‚’æ¥ç¶šã§ãã¾ã™ã€‚å‰å¾Œé–¢ä¿‚ã®ã‚ã‚‹ã‚¿ã‚¹ã‚¯ãªã©ã®ãƒ¡ãƒ¢ã«åˆ©ç”¨å¯èƒ½ã§ã™ã€‚</div><div><img src=\"data:image/png;base64,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\" style=\"cursor: nwse-resize;\"></div><div>æ‰‹æ›¸ããƒ¢ãƒ¼ãƒ‰ã§ã¯ãƒã‚¦ã‚¹ãƒã‚¤ãƒ³ã‚¿ã«ã‚ˆã‚‹æ‰‹æ›¸ããŒå¯èƒ½ã§ã™ã€‚</div><div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE0AAAA1CAYAAAAEeGYcAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAVcSURBVHhe7dpPSJMPHAbwR1+xglFbljaCmpNlZrVL9Sq2PLhDBYHQoVOdgpBgxkasqOA3BsIExxDRi24dAjsUeSgw8FDqIEEdtAnSPy/aGzWGrqEyU3+XNty37d271/fVd2Of4/NsiA/vu73b3pLa2tpNFOWklAZF2RVHE6E4mgjF0UQojiZCiVzvnnV1dTAajdDpdDhy5Ai0Wi2OHTtGHyaZSCSCHz9+gOM4fP/+HZ8+fcLk5CQWFxfpQ7dN0tEuX74Ms9kMo9EIlUpF613x7ds3TE1NYXBwEBzH0VoUSUY7f/482tvbUVNTQyvFWFtbw4sXL+Dz+fD7929a52Rbo+n1erS3t+PChQu0UqxoNAqfz4eXL19ibW2N1oIwhw4d+o+GQuh0Ong8Hpw4cYJWirZnzx40NDRg3759mJiYoLUgokZjWRYejwcajYZWeeP06dOorq6G3+/H+vo6rXnlfMlx/fp1dHV1KeaFfjtaWlrQ19cHtVpNK145jWYwGNDW1gaGYWiVt+rq6mCz2WjMS/DpqVar0dvbm9enZCZ6vR7xeBwfP36kVVqCjzSbzYaqqioaF4w7d+5Ap9PROC1Bo506dQpms5nGBYVhGFgsFhqnJWg0q9VKo4LU2NiIhoYGGv8j62hmsxn19fU03hGzs7O4desWrFYrwuEwrWVhsVhQWso/C38L4MaNGzTaEbOzs7Db7VhYWMDU1BQePXq0I8NVV1fDZDLROAXvaBUVFbtylCUGKy8vx7Nnz9DZ2Ym5ubkdG45lWRql4B3NZDKhpKSExrLaOlh3dze0Wi1YloXT6dyx4S5evEijFLyjXbp0iUaySjdYwtbhnjx5gkgkkvJcKR0+fJj3DOMdbSc/jPMNlsCyLB48eIBgMIhQKERrSRkMBholZRyNYRgcOHCAxrIQMhgAcByHvr4+VFZW4vjx47SWVEVFBY2SMo6mVqtRVlZGY8nlMpjFYkE8HkdHR4cyRzt48CCNJCdmMJfLhZMnT9KHSI7v/884mty+fPmi2MEAoLy8nEZJGUeT890JAPx+P2KxGJxOp+IGQ5b/P+Noi4uL+PPnD40lw7IsGIaBw+FI+yvRbg6Gv38/E94fVl6/fs37grhdoVAIVqsVGo0GN2/exN69ewEAq6ur8Hq9WF9fh8vlQk1NDQKBAKLRaPK5Z86ckfWrKpfLhaGhIRoD2UZzu91obGyksaQSw9HT4ejRo8nBfD4f+vv7sbGxkezdbresF9+3b9/GzMwMjYFso7W2tsJut9O44IXDYVy7do3GSRlf0wBgfHwcm5sZNy1YY2NjNErBO1o4HM54iBay0dFRGqXgHQ0AXr16RaOCxnEcpqenaZwi62jDw8P4/PkzjQtWb28v4vE4jVNkHW1jYwMDAwM0Lkhfv37FyMgIjf+RdTQAeP/+PQKBAI0LTk9PD43SEjQaAHR0dMhyg5xSPH/+HB8+fKBxWoJHm5+fx/3797G6ukqrvDc2Nobu7m4aZyR4NPy9enc4HClX5vluZmYGjx8/zul6NKfRAODdu3e4d+8elpaWaJV3RkZGcPfu3azvlhTvxyg+Wq0Wbrdb8P0PSrK5uYn+/n54vV5aCSL4riEqFovhzZs3KC0tRX19fdZfpZVibm4Odrsdb9++pZVgoo+0rXQ6HR4+fIizZ8/SSjFWVlbg9XoxODiY852PlCSjJVy5cgVXr17FuXPnaLVrfv36hfHxcTx9+hQ/f/6ktSiSjpawf/9+NDc3o6mpCVVVVVCpVFCpVDnfppmL5eVlxGIxxGIxLC0tIRgMYnR0VJYvHGQZrdDlx6u3whRHE6E4mgjF0UT4H0ULDYUeFE9iAAAAAElFTkSuQmCC\" style=\"cursor: default;\"></div><div>æ¶ˆã—ã‚´ãƒ ãƒ¢ãƒ¼ãƒ‰ã§ã¯æ¥ç¶šç·šã€æ‰‹æ›¸ãç·šã«å¯¾ã—ã¦æœ‰åŠ¹ã§ã™ã€‚\nï¼Šä»˜ç®‹ã¯ä»˜ç®‹å³ä¸Šã«ã‚ã‚‹æ¶ˆå»ãƒœã‚¿ãƒ³ã‚’åˆ©ç”¨ãã ã•ã„</div><div><br></div>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          },
          {
            "id": "n_1768290451691_569",
            "left": "1858.44px",
            "top": "916.283px",
            "width": "377px",
            "height": "305px",
            "backgroundColor": "rgb(255, 247, 64)",
            "zIndex": 1,
            "contentHTML": "<b><font size=\"5\">â‘¥</font></b><div><font size=\"3\">â– æ¤œç´¢</font></div><div><img src=\"data:image/png;base64,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\" style=\"cursor: nwse-resize;\"></div><div>è™«çœ¼é¡ãƒãƒ¼ã‚¯ã‚ˆã‚Šä»˜ç®‹ã®æ¤œç´¢ãŒå¯èƒ½ã§ã™ã€‚</div><div><br></div>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          },
          {
            "id": "n_1768290526022_698",
            "left": "1822.44px",
            "top": "1304.28px",
            "width": "",
            "height": "",
            "backgroundColor": "rgb(255, 247, 64)",
            "zIndex": 1,
            "contentHTML": "<font size=\"5\"><b>â‘¦</b></font><div>â– ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹</div><div><img src=\"data:image/png;base64,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\" style=\"cursor: default;\"></div><div>ãƒ•ã‚©ãƒ«ãƒ€ã‚„ã‚·ãƒ¼ãƒˆã®è¿½åŠ æ¶ˆå»ãŒå¯èƒ½ã§ã™ã€‚</div>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          },
          {
            "id": "n_1768291357531_298",
            "left": "1777.22px",
            "top": "1863.61px",
            "width": "541px",
            "height": "338px",
            "backgroundColor": "rgb(255, 247, 64)",
            "zIndex": 1,
            "contentHTML": "<b><font size=\"5\">â‘§</font></b><div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABACAYAAABm8Es1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAQdSURBVHhe7dnfK3t/HMDx5zH7NJYfZ820MaIZsVAuSKslxZ0L7caVC0ouFLnh7qvkUkv+AeVHrrjgxrULVy4QYlmI1oYss43R+V5918f6+Hzz/bz5nE/f9+Py/XqftZ69z86pKaWlpRqSEDnZC9J/J2MKJGMKpNhsNvmbKYhSW1srYwoib3OBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBZEyBPhzT5XIxPz/P6Oho9uh/78MxpffJmALJmALJmAJ9+H9zl8vF6OgowWCQQCCQPf4lJpOJ8fFx6urqMmupVIqFhQW2t7cB8Hq99Pf3YzKZANA0jd3dXeHf5WcKCwspKSnBaDSiaRrxeJxIJKKvk9na2kpdXR3pdJpIJEIkEiEajZJMJjN7kskk0Wg0M1cUhfr6ejwez5vP+gyKolBWVkZlZSW5ubnE43FSqRSqquJyufR1Mn0+H4ODgwSDQaamprLHPxQIBMjPz2dubo6Dg4PssVAlJSXYbDbC4TC3t7eZ9dzcXCoqKvR1Mn+ks7OT2dlZlpeXWVxcZGZmhubm5uxtn85gMKCqKrFY7E1IgJeXF66vr/Ud0+/3MzAwgMPh4ObmhlgshsvlYmxsjK6uruztn+rbt28YjUYeHh4wGo04HA7Ky8spLy/HarWSTqf1dZt/z263Mzk5SVFREUtLS2xtbQHQ19dHT08P5+fnTExMZF/2afLy8qiuruby8pLn52ecTicGgwGARCKh75PpdrtRVZVQKJQJCbC2tkY4HMZisXzJQ+cf6XSal5cXCgoKSCaTnJ6ecnx8zPHxMRcXFyiKot+Y70mlUmjah24mIdLpNPf396iqiqqqb2Y5OTnY7Xb9xry6uiIej+N0Omlvb8+sd3d3Y7VaicViBIPBN9d8JkVRiEajPD4+4nQ6qaqqQlVVbDYbNTU1FBcXY7BarX9lX/gzFouFtrY27u7u2NnZyR7/Ep/Px/T0NI2NjaytrVFYWIjH46GlpYWmpiY6Ojro7OxE0zQ2Nzc5PDwkEAjQ29tLKBQiEolkf6RQmqYRi8V4fX2lqKgIVVUxm82kUikuLi70ezIBVlZWWF1d5enpCY/HQ0NDA/f396yurrKxsZG9/UtomsbNzQ1HR0fs7e2xv7/P2dkZiURC3zEB1tfXGRwcxO/34/f7GR4e/m0h/40uY1osFkZGRhgZGWFoaAi3252Zud1uhoaGMnOz2fzm2t9JVzFPTk4Ih8OUlZXh8/nw+Xx4vV7sdntmj91ux+v1ZuaqqnJ5efmlD6P36Pal/U+kq5P5p5MxBZIxBZIxBZIxBZIxBZIxBfrwe6b0PnkyBZIxBZIxBZIxBZIxBZIxBZIxBZIxBZIxBZIxBZIxBZIxBfob46NkGk8b0v4AAAAASUVORK5CYII=\" style=\"cursor: default;\"></div><div>ç”»é¢ä¸‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®[ç”»é¢ä½ç½®ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³]ã«ã‚ˆã‚Šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåº§æ¨™ã«æˆ»ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\n&gt;&gt;ç”»é¢ä½ç½®ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã¿ã¦ãã ã•ã„</div>",
            "fontSize": "16px",
            "labels": [
              "ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒœãƒ¼ãƒ‰"
            ],
            "stamps": []
          }
        ],
        "connections": [
          {
            "from": "n_1768285890067_851",
            "to": "n_1768286615874_362"
          },
          {
            "from": "n_1768285890067_851",
            "to": "n_1768287167431_421"
          },
          {
            "from": "n_1768286615874_362",
            "to": "n_1768287172432_400"
          },
          {
            "from": "n_1768285890067_851",
            "to": "n_1768287619039_149"
          },
          {
            "from": "n_1768287619039_149",
            "to": "n_1768287711213_295"
          },
          {
            "from": "n_1768287711213_295",
            "to": "n_1768289298942_721"
          },
          {
            "from": "n_1768289298942_721",
            "to": "n_1768290000675_471"
          },
          {
            "from": "n_1768290000675_471",
            "to": "n_1768290451691_569"
          },
          {
            "from": "n_1768290451691_569",
            "to": "n_1768290526022_698"
          },
          {
            "from": "n_1768290526022_698",
            "to": "n_1768291357531_298"
          },
          {
            "from": "n_1768291357531_298",
            "to": "n_1768289259289_224"
          }
        ],
        "drawings": [],
        "scale": 1,
        "boardX": "-100px",
        "boardY": "-100px",
        "zIndexCounter": 6
      }
    }
  ],
  "currentSheetId": "s_1767928896625"
}
`;

    // â‘¡ JSONã¸ãƒ‘ãƒ¼ã‚¹
    let initialData = {};
    try {
      initialData = JSON.parse(initialJsonRaw);
    } catch (e) {
      // ä¸‡ä¸€JSONå´ã®æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°è¦‹ã¤ã‘ã‚„ã™ã„ã‚ˆã†é€šçŸ¥
      alert('åˆæœŸJSONã®æ§‹æ–‡ã«èª¤ã‚ŠãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚\n' + e.message);
      throw e;
    }

    // â‘¢ contentHTML ãŒ &lt; ã‚„ &gt; ã®HTMLã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å ´åˆã€å®Ÿã‚¿ã‚°ã¸è‡ªå‹•ãƒ‡ã‚³ãƒ¼ãƒ‰
    const decodeEntities = (str) => {
      if (typeof str !== 'string') return str;
      const textarea = document.createElement('textarea');
      textarea.innerHTML = str;
      // 2å›ãƒ‡ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ãªã‚±ãƒ¼ã‚¹ã‚‚æƒ³å®šï¼ˆ&amp;lt; â†’ &lt; â†’ <ï¼‰
      const once = textarea.value;
      textarea.innerHTML = once;
      return textarea.value;
    };

    try {
      const sheets = initialData?.sheets || [];
      sheets.forEach(s => {
        const notes = s?.data?.notes || [];
        notes.forEach(n => {
          // contentHTML ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦æœ¬æ¥ã®ã‚¿ã‚°ã«æˆ»ã™
          if (n.contentHTML) {
            n.contentHTML = decodeEntities(n.contentHTML);
          }
        });
      });
    } catch (e) {
      console.warn('contentHTML ãƒ‡ã‚³ãƒ¼ãƒ‰å‡¦ç†ã§ä¾‹å¤–:', e);
    }

    // â‘£ æ—¢å­˜ã® appData ã¨ãƒãƒ¼ã‚¸ï¼ˆcolors/è¨­å®šã¯æ—¢å­˜ã‚’æ´»ã‹ã—ã¤ã¤ã€folders/sheets ã¯ç½®æ›ï¼‰
    appData = {
      ...appData,
      folders: initialData.folders || appData.folders,
      sheets: initialData.sheets || appData.sheets,
      currentSheetId: initialData.currentSheetId || (initialData.sheets?.[0]?.id) || appData.currentSheetId
    };

    // â‘¤ å®Œäº†
    return;
  }

  // â€” ä»¥é™ã¯æ—¢å­˜ã®é€šå¸¸ä¿å­˜ãƒ­ã‚¸ãƒƒã‚¯ã®ã¾ã¾ã§OK â€”
  const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
  if (!sheet) return;
  const notes = [];
  document.querySelectorAll('.note').forEach(el => {
    const stamps = [];
    el.querySelectorAll('.stamp-item').forEach(s => stamps.push(s.innerText));
    let labels = [];
    try { labels = JSON.parse(el.dataset.labels || '[]'); } catch(e) {}
    notes.push({
      id: el.dataset.id, left: el.style.left, top: el.style.top, width: el.style.width, height: el.style.height,
      backgroundColor: el.style.backgroundColor, zIndex: parseInt(el.style.zIndex || 1),
      contentHTML: el.querySelector('.note-content').innerHTML, fontSize: el.querySelector('.note-content').style.fontSize,
      labels: labels, stamps: stamps
    });
  });
  if(!sheet.data) sheet.data = { connections: [], drawings: [] };
  sheet.data.notes = notes;
  sheet.data.scale = currentScale;
  sheet.data.boardX = board.style.left;
  sheet.data.boardY = board.style.top;
  sheet.data.zIndexCounter = zIndexCounter;
}


    function loadSheet(sheetId, skipSave = false) {
        if (!skipSave) saveCurrentSheetToData();
        appData.currentSheetId = sheetId;
        const sheet = appData.sheets.find(s => s.id === sheetId);
        if (!sheet) return;

        board.innerHTML = '<svg id="svg-layer-back"></svg><svg id="svg-layer-front"></svg>'; 
        if (!sheet.data) { sheet.data = { notes: [], connections: [], drawings: [], scale: 1, boardX: '-100px', boardY: '-100px', zIndexCounter: 1 }; }
        const d = sheet.data; 
        board.style.left = d.boardX || '-100px'; 
        board.style.top = d.boardY || '-100px'; 
        currentScale = d.scale || 1; 
        zIndexCounter = d.zIndexCounter || 1;
        
        if(!d.connections) d.connections = []; 
        if(!d.drawings) d.drawings = [];
        if (d.notes) d.notes.forEach(n => createNoteDOM(n));
        
        setTimeout(() => { 
            renderConnections(); 
            renderDrawings(); 
            selectedItems.notes.forEach(id => { const note = document.querySelector(`.note[data-id="${id}"]`); if(note) note.classList.add('selected-item'); }); 
        }, 0);
        
        updateZoomDisplay(); 
        renderSidebar(); 
        if (!skipSave) saveData();
    }

    function toggleConnectMode() { isConnectMode = !isConnectMode; toggleMode('connecting-mode', connectModeBtn, isConnectMode); }
    function toggleDrawMode() { isDrawMode = !isDrawMode; toggleMode('drawing-mode', drawModeBtn, isDrawMode); }
    function toggleEraserMode() { isEraserMode = !isEraserMode; toggleMode('eraser-mode', eraserModeBtn, isEraserMode); }
    function toggleMode(cls, btn, active) {
        if(active) {
            if(cls !== 'connecting-mode') { isConnectMode=false; document.body.classList.remove('connecting-mode'); connectModeBtn.classList.remove('active'); }
            if(cls !== 'drawing-mode') { isDrawMode=false; document.body.classList.remove('drawing-mode'); drawModeBtn.classList.remove('active'); }
            if(cls !== 'eraser-mode') { isEraserMode=false; document.body.classList.remove('eraser-mode'); eraserModeBtn.classList.remove('active'); }
        }
        document.body.classList.toggle(cls, active); btn.classList.toggle('active', active);
        if(cls === 'connecting-mode') { connectSourceId = null; document.querySelectorAll('.note').forEach(n => n.classList.remove('connect-source')); renderConnections(); }
    }

    function createConnection(fromId, toId) {
        if(fromId === toId) return;
        const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
        if(!sheet.data.connections) sheet.data.connections = [];
        if(!sheet.data.connections.some(c => c.from === fromId && c.to === toId)) {
            recordHistory(); sheet.data.connections.push({ from: fromId, to: toId }); renderConnections(); saveData();
        }
    }
    
    function getClosestConnectionPoints(fromEl, toEl) {
        const f = { left: fromEl.offsetLeft, top: fromEl.offsetTop, w: fromEl.offsetWidth, h: fromEl.offsetHeight };
        const t = { left: toEl.offsetLeft, top: toEl.offsetTop, w: toEl.offsetWidth, h: toEl.offsetHeight };
        const fromPorts = [ { x: f.left + f.w/2, y: f.top }, { x: f.left + f.w/2, y: f.top + f.h }, { x: f.left, y: f.top + f.h/2 }, { x: f.left + f.w, y: f.top + f.h/2 } ];
        const toPorts = [ { x: t.left + t.w/2, y: t.top }, { x: t.left + t.w/2, y: t.top + t.h }, { x: t.left, y: t.top + t.h/2 }, { x: t.left + t.w, y: t.top + t.h/2 } ];
        let minDist = Infinity, bestPair = { p1: fromPorts[1], p2: toPorts[0] };
        fromPorts.forEach(p1 => { toPorts.forEach(p2 => { const dist = Math.hypot(p2.x - p1.x, p2.y - p1.y); if (dist < minDist) { minDist = dist; bestPair = { p1, p2 }; } }); });
        return { x1: bestPair.p1.x, y1: bestPair.p1.y, x2: bestPair.p2.x, y2: bestPair.p2.y };
    }
    function renderConnections() {
        const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
        if(!sheet || !sheet.data || !sheet.data.connections) return;
        const svg = document.getElementById('svg-layer-back');
        svg.querySelectorAll('.connector-group').forEach(el => el.remove());
        
        let defs = svg.querySelector('defs');
        if(!defs) { defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs'); svg.prepend(defs); }
        if(!defs.querySelector('#arrowhead')) {
            defs.innerHTML += `<marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" class="connector-arrow"/></marker><marker id="arrowhead-active" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="var(--highlight-stroke)"/></marker><marker id="arrowhead-danger" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="var(--danger-color)"/></marker>`;
        }
        sheet.data.connections.forEach((conn, index) => {
            const fromEl = document.querySelector(`.note[data-id="${conn.from}"]`);
            const toEl = document.querySelector(`.note[data-id="${conn.to}"]`);
            if(fromEl && toEl) {
                const coords = getClosestConnectionPoints(fromEl, toEl);
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.classList.add('connector-group'); g.dataset.from = conn.from; g.dataset.to = conn.to;
                if(selectedItems.connections.has(index)) g.classList.add('selected-svg-item');
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', coords.x1); line.setAttribute('y1', coords.y1); line.setAttribute('x2', coords.x2); line.setAttribute('y2', coords.y2); line.setAttribute('marker-end', 'url(#arrowhead)'); line.setAttribute('class', 'connector-path');
                const hit = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                hit.setAttribute('x1', coords.x1); hit.setAttribute('y1', coords.y1); hit.setAttribute('x2', coords.x2); hit.setAttribute('y2', coords.y2); hit.setAttribute('class', 'connector-hit-area');
                g.append(line, hit);
                g.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if(isEraserMode || confirm('æ¥ç¶šã‚’å‰Šé™¤ï¼Ÿ')) { recordHistory(); sheet.data.connections.splice(index, 1); renderConnections(); saveData(); }
                });
                svg.appendChild(g);
            }
        });
    }

    function restoreSelection() {
        if (currentTextSelectionRange) {
            const sel = window.getSelection();
            sel.removeAllRanges();
            sel.addRange(currentTextSelectionRange);
        }
    }
    function execCmd(event, command, value = null) {
        if(event) event.preventDefault(); 
        restoreSelection();
        document.execCommand(command, false, value);
        const sel = window.getSelection();
        if(sel.rangeCount > 0) currentTextSelectionRange = sel.getRangeAt(0);
        saveData();
    }
    togglePaletteBtn.onmousedown = (e) => { e.preventDefault(); floatingPalette.classList.toggle('show'); };
    function renderColorPalette() {
        presetColorsContainer.innerHTML = PRESET_TEXT_COLORS.map(c => `<div class="palette-swatch" style="background:${c}" onmousedown="applyTextColor(event, '${c}')"></div>`).join('');
        recentColorsContainer.innerHTML = appData.recentTextColors.map(c => `<div class="palette-swatch" style="background:${c}" onmousedown="applyTextColor(event, '${c}')"></div>`).join('');
    }
    window.applyTextColor = (event, color) => { execCmd(event, 'foreColor', color); };
    floatColorInput.addEventListener('mousedown', () => { if(window.getSelection().rangeCount > 0) currentTextSelectionRange = window.getSelection().getRangeAt(0); });
    floatColorInput.addEventListener('input', (e) => {
        restoreSelection(); document.execCommand('foreColor', false, e.target.value);
        if(!appData.recentTextColors.includes(e.target.value)) appData.recentTextColors = [e.target.value, ...appData.recentTextColors].slice(0, 7);
        renderColorPalette(); saveData();
    });

    function createNoteDOM(data) {
        const note = document.createElement('div');
        note.className = 'note'; note.dataset.id = data.id || ('n_' + Date.now());
        note.style.left = data.left; note.style.top = data.top;
        if(data.width) note.style.width = data.width; if(data.height) note.style.height = data.height;
        note.style.backgroundColor = data.backgroundColor; note.style.zIndex = data.zIndex;
        if(data.zIndex >= zIndexCounter) zIndexCounter = data.zIndex + 1;
        note.dataset.labels = JSON.stringify(data.labels || []);
        
        note.innerHTML = `
            <div class="note-labels-container"></div>
            <div class="note-header"><span class="delete-btn">âœ•</span></div>
            <div class="note-content" contenteditable="false" style="font-size:${data.fontSize||'16px'}">${data.contentHTML||''}</div>
            <div class="stamp-area"></div>
            <div class="progress-bar-container"><div class="progress-bar-fill"></div></div>
            <div class="note-tools">
                <div class="tool-group color-group">${appData.colors.map(c=>`<div class="color-dot" style="background:${c}" data-color="${c}"></div>`).join('')}</div>
                <div class="separator" style="height:20px; margin:0 5px;"></div>
                <div class="tool-group">
                    <button class="font-size-btn">F</button>
                    <button class="tool-btn checkbox-toggle"><span class="material-symbols-outlined">check_box</span></button>
                    <button class="tool-btn label-toggle"><span class="material-symbols-outlined">label</span></button>
                    <button class="tool-btn stamp-toggle"><span class="material-symbols-outlined">mood</span></button>
                </div>
                <div class="separator" style="height:20px; margin:0 5px;"></div>
                <div class="tool-group"><button class="tool-btn z-back"><span class="material-symbols-outlined">flip_to_back</span></button><button class="tool-btn z-front"><span class="material-symbols-outlined">flip_to_front</span></button></div>
            </div>`;
        
        board.appendChild(note);
        renderNoteLabels(note, data.labels || []);
        if(data.stamps) data.stamps.forEach(s => applyStampToNote(note, s));
        setupNoteEvents(note);
        updateNoteProgress(note);
    }

    // ãƒã‚¤ãƒ©ã‚¤ãƒˆæ¢ç´¢ç”¨é–¢æ•°
    function highlightRoute(startId) {
        const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
        if(!sheet || !sheet.data.connections) return;

        const visitedNodes = new Set();
        const visitedConns = new Set();
        
        function traverse(currId) {
            sheet.data.connections.forEach(c => {
                if(c.from === currId) {
                    const k = `${c.from}:${c.to}`;
                    if(!visitedConns.has(k)) {
                        visitedConns.add(k);
                        visitedNodes.add(c.to); 
                        traverse(c.to); 
                    }
                }
            });
        }
        
        traverse(startId);

        visitedConns.forEach(k => {
            const [f, t] = k.split(':');
            const el = document.querySelector(`.connector-group[data-from="${f}"][data-to="${t}"]`);
            if(el) el.classList.add('route-highlight');
        });

        visitedNodes.forEach(nid => {
            const el = document.querySelector(`.note[data-id="${nid}"]`);
            if(el) el.classList.add('route-active');
        });
    }

    function clearHighlight() {
        document.querySelectorAll('.route-highlight').forEach(el => el.classList.remove('route-highlight'));
        document.querySelectorAll('.route-active').forEach(el => el.classList.remove('route-active'));
    }

    function setupNoteEvents(note) {
        const content = note.querySelector('.note-content');

        
note.addEventListener("mousedown", (e) => {

	  // SPACEä¸­ã¯ä»˜ç®‹ã®ä¸Šã§ã‚‚ç”»é¢ãƒ‰ãƒ©ãƒƒã‚°ã¸å¼·åˆ¶
	  if (isSpacePressed && e.button === 0) {

	    const sx = e.clientX;
	    const sy = e.clientY;
	    const sl = parseFloat(board.style.left) || 0;
	    const st = parseFloat(board.style.top) || 0;

	    const onMove = (mv) => {
	      board.style.left = sl + (mv.clientX - sx) + "px";
	      board.style.top  = st + (mv.clientY - sy) + "px";
	    };

	    const onUp = () => {
	      window.removeEventListener("mousemove", onMove);
	      window.removeEventListener("mouseup", onUp);
	      saveData();
	    };

	    window.addEventListener("mousemove", onMove);
	    window.addEventListener("mouseup", onUp);

	    e.preventDefault();
	    e.stopPropagation();
	    return;
	  }

	  // ä»¥ä¸‹ã€æ—¢å­˜ã®ä»˜ç®‹ãƒ‰ãƒ©ãƒƒã‚°å‡¦ç†
	});

        
        // ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚¤ãƒ™ãƒ³ãƒˆ
        note.addEventListener('mouseenter', () => {
            if(!isConnectMode && !isDrawMode && !isEraserMode && !isLassoSelecting) {
                highlightRoute(note.dataset.id);
            }
        });
        note.addEventListener('mouseleave', () => {
            clearHighlight();
        });

        note.addEventListener('click', (e) => {
            if(isConnectMode) { e.stopPropagation(); if(!connectSourceId){ connectSourceId=note.dataset.id; note.classList.add('connect-source'); } else { createConnection(connectSourceId, note.dataset.id); connectSourceId=null; document.querySelectorAll('.note').forEach(n=>n.classList.remove('connect-source')); } }
        });

        content.addEventListener('dblclick', () => {
            if(isConnectMode || isDrawMode || isEraserMode) return;
            recordHistory();
            content.contentEditable = "true";
            content.focus();
        });
        content.addEventListener('blur', () => {
            content.contentEditable = "false";
            updateNoteProgress(note); 
            saveData();
        });

        content.addEventListener('paste', (e) => {
            // ç”»åƒå‡¦ç†ç”¨ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ 
            const items = (e.clipboardData || e.originalEvent.clipboardData).items;
            let blob = null;
            for (let i = 0; i < items.length; i++) {
                if (items[i].type.indexOf("image") === 0) {
                    blob = items[i].getAsFile();
                    break;
                }
            }
            if (blob) {
                e.preventDefault();
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.createElement("img");
                    img.src = event.target.result;
                    document.execCommand('insertHTML', false, img.outerHTML);
                    saveData();
                };
                reader.readAsDataURL(blob);
                return;
            }

            e.preventDefault();
            const clipboardData = e.clipboardData || window.clipboardData;
            const pasteText = clipboardData.getData('text');
            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            const range = selection.getRangeAt(0);
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            if(urlRegex.test(pasteText)) {
                const selectedText = selection.toString();
                if (selectedText.trim().length > 0) {
                    const anchor = document.createElement('a'); anchor.href = pasteText.trim(); anchor.target = '_blank'; anchor.rel = 'noopener noreferrer'; anchor.textContent = selectedText;
                    range.deleteContents(); range.insertNode(anchor); range.setStartAfter(anchor); range.collapse(true);
                    selection.removeAllRanges(); selection.addRange(range);
                } else { document.execCommand('insertText', false, pasteText); }
            } else { document.execCommand('insertText', false, pasteText); }
            saveData();
        });

        // ç”»åƒãƒªã‚µã‚¤ã‚ºã®ãŸã‚ã®ãƒã‚¦ã‚¹ç§»å‹•ç›£è¦–
        content.addEventListener('mousemove', (e) => {
            if (e.target.tagName === 'IMG') {
                const rect = e.target.getBoundingClientRect();
                // ç”»åƒã®å³ä¸‹15pxã‚¨ãƒªã‚¢åˆ¤å®š
                if (e.clientX > rect.right - 15 && e.clientY > rect.bottom - 15) {
                    e.target.style.cursor = 'nwse-resize';
                } else {
                    e.target.style.cursor = 'default';
                }
            }
        });

        // ç”»åƒãƒªã‚µã‚¤ã‚ºé–‹å§‹
        content.addEventListener('mousedown', (e) => {
            if (e.target.tagName === 'IMG' && e.target.style.cursor === 'nwse-resize') {
                e.preventDefault(); // ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚„ãƒ‰ãƒ©ãƒƒã‚°é˜²æ­¢
                e.stopPropagation(); // ãƒãƒ¼ãƒˆç§»å‹•é˜²æ­¢
                
                recordHistory();
                const img = e.target;
                const startX = e.clientX;
                const startWidth = img.offsetWidth;
                
                const onResizeMove = (mv) => {
                    // ã‚ºãƒ¼ãƒ å€ç‡ã‚’è€ƒæ…®ã—ã¦ç§»å‹•é‡ã‚’è¨ˆç®—
                    const dx = (mv.clientX - startX) / currentScale;
                    const newWidth = Math.max(20, startWidth + dx);
                    img.style.width = newWidth + 'px';
                    img.style.height = 'auto'; // ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ç¶­æŒ
                };
                
                const onResizeUp = () => {
                    window.removeEventListener('mousemove', onResizeMove);
                    window.removeEventListener('mouseup', onResizeUp);
                    saveData();
                };
                
                window.addEventListener('mousemove', onResizeMove);
                window.addEventListener('mouseup', onResizeUp);
                return;
            }
        });

                // â–¼â–¼â–¼ ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå¸ç€å¯¾å¿œç‰ˆã«ç½®æ›ï¼‰ â–¼â–¼â–¼
        note.addEventListener('mousedown', (e) => {
            if (isConnectMode || isDrawMode || isEraserMode) return;
            if (e.button !== 0) return; 
            if (content.isContentEditable) { e.stopPropagation(); return; }

            
			if (isSpacePressed) {
			    e.stopPropagation();
			    e.preventDefault();
			    return;
			}

            if (e.target.closest('.note-tools') || e.target.closest('.delete-btn') || e.target.closest('.stamp-item')) return;
            
            // ãƒªã‚µã‚¤ã‚ºãƒãƒ³ãƒ‰ãƒ«ä»˜è¿‘ãªã‚‰ãƒ‰ãƒ©ãƒƒã‚°ã—ãªã„
            const rect = note.getBoundingClientRect();
            if (e.clientX > rect.right - 20 && e.clientY > rect.bottom - 20) return; 

            e.stopPropagation(); e.preventDefault();  

            // é¸æŠçŠ¶æ…‹ã®æ›´æ–°
            if (!selectedItems.notes.has(note.dataset.id) && !e.shiftKey) {
                clearSelection();
                selectedItems.notes.add(note.dataset.id);
                note.classList.add('selected-item');
            } else if (e.shiftKey) {
                selectedItems.notes.add(note.dataset.id);
                note.classList.add('selected-item');
            }

            recordHistory();
            
            let startX = e.clientX, startY = e.clientY;
            
            // ç§»å‹•å¯¾è±¡ã®åˆæœŸä½ç½®ã‚’ä¿å­˜
            const movingNotes = [];
            selectedItems.notes.forEach(id => {
                const el = document.querySelector(`.note[data-id="${id}"]`);
                if(el) {
                    movingNotes.push({ 
                        el, 
                        origLeft: parseFloat(el.style.left), 
                        origTop: parseFloat(el.style.top),
                        w: el.offsetWidth,
                        h: el.offsetHeight
                    });
                    el.classList.add('dragging');
                }
            });

            // æ‰‹æ›¸ããƒ»ç·šã‚‚ä¸€ç·’ã«å‹•ã‹ã™æº–å‚™
            const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
            const movingDrawings = [];
            selectedItems.drawings.forEach(idx => {
                if(sheet.data.drawings[idx]) movingDrawings.push({ idx, d: sheet.data.drawings[idx].d });
            });

            const onMove = (mv) => {
                const dx = (mv.clientX - startX) / currentScale;
                const dy = (mv.clientY - startY) / currentScale;

                movingNotes.forEach(item => {
                    let newLeft = item.origLeft + dx;
                    let newTop = item.origTop + dy;

                    // â˜… å¸ç€è¨ˆç®—ã‚’å®Ÿè¡Œï¼ˆãƒ¡ã‚¤ãƒ³ã®ä»˜ç®‹ã®ã¿ã€ã¾ãŸã¯å˜ä¸€é¸æŠæ™‚ã®ã¿è¡Œã†ã¨è‡ªç„¶ã§ã™ãŒã€ã“ã“ã§ã¯å…¨é©ç”¨ï¼‰
                    // è¤‡æ•°é¸æŠæ™‚ã¯ã€Œãƒ‰ãƒ©ãƒƒã‚°ã‚’é–‹å§‹ã—ãŸä»˜ç®‹ï¼ˆnoteï¼‰ã€ã‚’åŸºæº–ã«å¸ç€ã•ã›ã‚‹ã¨ç›´æ„Ÿçš„ã§ã™
                    if (item.el === note) {
                        const snapped = calculateSnap(newLeft, newTop, item.w, item.h, item.el.dataset.id);
                        
                        // å¸ç€ã«ã‚ˆã‚‹è£œæ­£å€¤ã‚’è¨ˆç®—
                        const snapDiffX = snapped.x - newLeft;
                        const snapDiffY = snapped.y - newTop;

                        // å…¨ã‚¢ã‚¤ãƒ†ãƒ ã«åŒã˜è£œæ­£ã‚’ã‹ã‘ã‚‹ï¼ˆç›¸å¯¾ä½ç½®ã‚’å´©ã•ãªã„ãŸã‚ï¼‰
                        // ã“ã“ã§ã¯ç°¡æ˜“çš„ã«ã€Œãƒ«ãƒ¼ãƒ—å†…ã§æ¯å›å†è¨ˆç®—ã€ã›ãšã€
                        // ã‚‚ã—å˜ä¸€é¸æŠãªã‚‰ã“ã‚Œã§OKã€‚è¤‡æ•°é¸æŠã®å ´åˆã‚‚ãƒªãƒ¼ãƒ€ãƒ¼ã«è¿½å¾“ã•ã›ã¾ã™ã€‚
                        newLeft = snapped.x;
                        newTop = snapped.y;
                        
                        // ã‚‚ã—è¤‡æ•°é¸æŠãªã‚‰ã€ä»–ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚‚ã“ã®ã€Œã‚ºãƒ¬ã€åˆ†ã ã‘è£œæ­£ã™ã¹ãã§ã™ãŒ
                        // ç°¡æ˜“å®Ÿè£…ã¨ã—ã¦ã€å€‹åˆ¥ã«è¨ˆç®—ã¯ã›ãšã€noteï¼ˆæ´ã‚“ã§ã„ã‚‹è¦ç´ ï¼‰ã®ç§»å‹•é‡ã‚’ä½¿ã„ã¾ã™
                        // ï¼ˆâ€»å³å¯†ãªè¤‡æ•°ç§»å‹•ã‚¹ãƒŠãƒƒãƒ—ã¯è¤‡é›‘ã«ãªã‚‹ãŸã‚ã€ä»Šå›ã¯ã€Œæ´ã‚“ã§ã„ã‚‹ã‚‚ã®ã€ãŒå¸ç€ã—ã¾ã™ï¼‰
                    } else if (selectedItems.notes.size > 1) {
                         // æ´ã‚“ã§ã„ãªã„ä»–ã®é¸æŠè¦ç´ ã¯ã€å¸ç€è¨ˆç®—ã›ãšè¿½å¾“ã®ã¿
                         // (ä¸Šè¨˜ãƒ­ã‚¸ãƒƒã‚¯ã ã¨å€‹åˆ¥ã«å‹•ã„ã¦ã—ã¾ã†ã®ã§ã€dx/dyã§å‹•ã‹ã™ã®ãŒæ­£)
                         // ä»Šå›ã¯ã€Œæ´ã‚“ã§ã„ã‚‹è¦ç´ ã€ãŒå¸ç€ã—ãŸå ´åˆã® delta ã‚’ä»–ã«ã‚‚é©ç”¨ã™ã‚‹å®Ÿè£…ã¯çœç•¥ã—
                         // ã‚°ãƒªãƒƒãƒ‰ã‚¹ãƒŠãƒƒãƒ—ãŒæœ‰åŠ¹ãªã‚‰ã€å€‹ã€…ã«ã¯ã‚¹ãƒŠãƒƒãƒ—ã•ã›ã¾ã›ã‚“ï¼ˆè¿½å¾“å„ªå…ˆï¼‰
                    }

                    item.el.style.left = newLeft + 'px';
                    item.el.style.top = newTop + 'px';
                });

                // æ‰‹æ›¸ãç­‰ã®ç§»å‹•ï¼ˆã‚¹ãƒŠãƒƒãƒ—éå¯¾å¿œã§è¿½å¾“ï¼‰
                if(movingDrawings.length > 0) {
                     movingDrawings.forEach(item => {
                        const newD = item.d.replace(/([-\d.]+)\s+([-\d.]+)/g, (match, x, y) => `${parseFloat(x)+dx} ${parseFloat(y)+dy}`);
                        sheet.data.drawings[item.idx].d = newD;
                    });
                    renderDrawings();
                    const paths = document.querySelectorAll('.drawing-path');
                    movingDrawings.forEach(item => { if(paths[item.idx]) paths[item.idx].classList.add('selected-svg-item'); });
                }
                renderConnections();
            };
            const onUp = () => {
                window.removeEventListener('mousemove', onMove); window.removeEventListener('mouseup', onUp);
                movingNotes.forEach(item => item.el.classList.remove('dragging'));
                saveData();
            };
            window.addEventListener('mousemove', onMove); window.addEventListener('mouseup', onUp);
        });

        // ãƒªã‚µã‚¤ã‚ºé–‹å§‹
                // â–¼â–¼â–¼ ãƒªã‚µã‚¤ã‚ºãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå¸ç€å¯¾å¿œç‰ˆã«ç½®æ›ï¼‰ â–¼â–¼â–¼
        note.addEventListener('mousedown', (e) => {
            if(isConnectMode || isDrawMode || isEraserMode) return;
            const rect = note.getBoundingClientRect();
            const resizeHandleSize = 20;
            
            // å³ä¸‹ã®ãƒªã‚µã‚¤ã‚ºãƒãƒ³ãƒ‰ãƒ«åˆ¤å®š
            if (e.clientX > rect.right - resizeHandleSize && e.clientY > rect.bottom - resizeHandleSize) {
                e.stopPropagation();
                e.preventDefault(); // ãƒ†ã‚­ã‚¹ãƒˆé¸æŠé˜²æ­¢
                recordHistory();

                const startX = e.clientX;
                const startY = e.clientY;
                const startW = note.offsetWidth;
                const startH = note.offsetHeight;
                const noteLeft = parseFloat(note.style.left);
                const noteTop = parseFloat(note.style.top);

                const onMoveResize = (mv) => {
                    const dx = (mv.clientX - startX) / currentScale;
                    const dy = (mv.clientY - startY) / currentScale;

                    let newW = Math.max(100, startW + dx);
                    let newH = Math.max(50, startH + dy);

                    // â˜… ãƒªã‚µã‚¤ã‚ºæ™‚ã®å¸ç€è¨ˆç®—
                    // å³ç«¯ãƒ»ä¸‹ç«¯ã®åº§æ¨™ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚’å¸ç€ã•ã›ã‚‹
                    if (appData.snapToGrid !== false) {
                        const proposedRight = noteLeft + newW;
                        const proposedBottom = noteTop + newH;
                        
                        // å¹…ãƒ»é«˜ã•ã‚’ä¸€æ™‚çš„ã«ã€Œå³ç«¯ãƒ»ä¸‹ç«¯ã®åº§æ¨™ã€ã¨ã—ã¦å¸ç€é–¢æ•°ã«é€šã™
                        // (ç¬¬1,2å¼•æ•°ã«å³ç«¯ãƒ»ä¸‹ç«¯ã‚’æ¸¡ã™)
                        const snapped = calculateSnap(proposedRight, proposedBottom, 0, 0, note.dataset.id);
                        
                        // å¸ç€ã—ãŸåº§æ¨™ - å·¦ä¸Šã®åº§æ¨™ = æ–°ã—ã„å¹…ãƒ»é«˜ã•
                        newW = Math.max(100, snapped.x - noteLeft);
                        newH = Math.max(50, snapped.y - noteTop);
                    }

                    note.style.width = newW + 'px';
                    note.style.height = newH + 'px';
                    renderConnections();
                };

                const onUpResize = () => {
                    window.removeEventListener('mousemove', onMoveResize);
                    window.removeEventListener('mouseup', onUpResize);
                    saveData();
                };
                window.addEventListener('mousemove', onMoveResize);
                window.addEventListener('mouseup', onUpResize);
            }
        });

        note.querySelector('.note-tools').addEventListener('mousedown', e => e.stopPropagation());

        note.querySelector('.delete-btn').onclick = (e) => {
            e.stopPropagation();
            if(appData.confirmDelete === false || confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                recordHistory(); note.remove(); renderConnections(); saveData();
            }
        };
        note.querySelectorAll('.color-dot').forEach(d => d.onclick = (e) => {
            recordHistory(); note.style.backgroundColor = e.target.dataset.color; saveData();
        });
        note.querySelector('.font-size-btn').onclick = () => {
            const sz = prompt('ã‚µã‚¤ã‚º(px)', parseInt(content.style.fontSize)||16);
            if(sz) { recordHistory(); content.style.fontSize = sz + 'px'; saveData(); }
        };
        note.querySelector('.checkbox-toggle').onclick = () => {
            recordHistory(); content.contentEditable="true"; content.focus();
            document.execCommand('insertHTML', false, '<input type="checkbox">&nbsp;'); saveData();
        };
        note.querySelector('.label-toggle').onclick = (e) => showLabelMenu(note.dataset.id, e.clientX, e.clientY);
        note.querySelector('.stamp-toggle').onclick = (e) => showStampMenu(note.dataset.id, e.clientX, e.clientY);
        note.querySelector('.z-front').onclick = () => { note.style.zIndex = ++zIndexCounter; saveData(); };
        note.querySelector('.z-back').onclick = () => { note.style.zIndex = 1; saveData(); };

        
    }

    // --- ãã®ä»–åŸºæœ¬æ©Ÿèƒ½ ---
    let currentPathEl; let currentPathPoints=[];
    wrapper.addEventListener('mousedown', (e) => {
        if(e.button === 2 && !isConnectMode && !isDrawMode && !isEraserMode) {
            isLassoSelecting = true; 
            lassoStart = { x: e.clientX, y: e.clientY };
            
            lassoRect = { left: 0, top: 0, width: 0, height: 0, right: 0, bottom: 0 };
            
            selectionLasso.style.display = 'block'; 
            selectionLasso.style.width = '0px';
            selectionLasso.style.height = '0px'; // é«˜ã•ã‚‚ãƒªã‚»ãƒƒãƒˆã—ã¦ãŠãã¨å®‰å…¨ã§ã™
            
            closePopups(); 
            clearSelection(); 
            return;
      	  }
        if(isDrawMode && e.button === 0 && !e.target.closest('#ui-layer')) {
            isDrawing = true;
            const rect = wrapper.getBoundingClientRect();
            const x = (e.clientX - rect.left - parseFloat(board.style.left))/currentScale;
            const y = (e.clientY - rect.top - parseFloat(board.style.top))/currentScale;
            currentPathPoints = [{x,y}];
            currentPathEl = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            currentPathEl.setAttribute('class', 'drawing-path'); currentPathEl.setAttribute('d', `M ${x} ${y}`);
            document.getElementById('svg-layer-front').appendChild(currentPathEl);
        }
    });
    window.addEventListener('mousemove', (e) => {
        if(isLassoSelecting) {
            const curX=e.clientX, curY=e.clientY;
            const l=Math.min(lassoStart.x, curX), t=Math.min(lassoStart.y, curY);
            selectionLasso.style.left=l+'px'; selectionLasso.style.top=t+'px';
            selectionLasso.style.width=Math.abs(curX-lassoStart.x)+'px'; selectionLasso.style.height=Math.abs(curY-lassoStart.y)+'px';
            lassoRect = { left: l, top: t, right: l+Math.abs(curX-lassoStart.x), bottom: t+Math.abs(curY-lassoStart.y) };
        }
        if(isDrawing) {
            const rect = wrapper.getBoundingClientRect();
            const x = (e.clientX - rect.left - parseFloat(board.style.left))/currentScale;
            const y = (e.clientY - rect.top - parseFloat(board.style.top))/currentScale;
            currentPathPoints.push({x,y});
            currentPathEl.setAttribute('d', currentPathEl.getAttribute('d') + ` L ${x} ${y}`);
        }
    });
    
    window.addEventListener('mouseup', (e) => {
        if(isLassoSelecting) {
            isLassoSelecting=false; selectionLasso.style.display='none';
            performSelectionHitTest();
            if(selectedItems.notes.size>0 || selectedItems.drawings.size>0 || selectedItems.connections.size>0) {
                selectionMenu.style.display='block'; selectionMenu.style.left=e.clientX+'px'; selectionMenu.style.top=e.clientY+'px';
                preventContextMenu = true;
                setTimeout(() => { preventContextMenu = false; }, 100);
            }
        }
        if(isDrawing) {
            isDrawing=false;
            if(currentPathPoints.length>1) {
                recordHistory(); const sheet=appData.sheets.find(s=>s.id===appData.currentSheetId);
                sheet.data.drawings.push({ d: currentPathEl.getAttribute('d') });
                renderDrawings(); saveData();
            } else { currentPathEl.remove(); }
        }
    });

    window.addEventListener('contextmenu', (e) => {
        if (preventContextMenu || isLassoSelecting || isConnectMode || isDrawMode || isEraserMode) {
            e.preventDefault();
            if(isConnectMode) toggleConnectMode(); 
            if(isDrawMode) toggleDrawMode(); 
            if(isEraserMode) toggleEraserMode();
        }
    });

    wrapper.addEventListener('mousedown', (e) => {
        if(e.button!==0) return;
        if(isConnectMode || isDrawMode || isEraserMode) return;
        
        if(!e.target.closest('#selection-menu')) {
            selectionMenu.style.display = 'none';
            clearSelection();
        }
        
        if(!e.target.closest('#label-menu') && !e.target.closest('.label-toggle')) labelMenu.style.display = 'none';
        if(!e.target.closest('#stamp-menu') && !e.target.closest('.stamp-toggle')) stampMenu.style.display = 'none';

        if(e.target.closest('.note')) return; 
        if(e.target.closest('#ui-layer') || e.target.closest('#floating-text-menu')) return;
        
        let sx=e.clientX, sy=e.clientY, sl=parseFloat(board.style.left), st=parseFloat(board.style.top);
        const onM = (mv) => { board.style.left=(sl+mv.clientX-sx)+'px'; board.style.top=(st+mv.clientY-sy)+'px'; };
        const onU = () => { window.removeEventListener('mousemove', onM); window.removeEventListener('mouseup', onU); saveData(); };
        window.addEventListener('mousemove', onM); window.addEventListener('mouseup', onU);
    });

    wrapper.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = e.deltaY > 0 ? -0.1 : 0.1;
        let newScale = currentScale + delta;
        if (newScale > 3) newScale = 3;
        if (newScale < 0.1) newScale = 0.1;

        const rect = wrapper.getBoundingClientRect();
        const mouseX = e.clientX - rect.left;
        const mouseY = e.clientY - rect.top;

        const boardLeft = parseFloat(board.style.left || 0);
        const boardTop = parseFloat(board.style.top || 0);
        const pointX = (mouseX - boardLeft) / currentScale;
        const pointY = (mouseY - boardTop) / currentScale;

        const newBoardLeft = mouseX - pointX * newScale;
        const newBoardTop = mouseY - pointY * newScale;

        currentScale = newScale;
        board.style.left = newBoardLeft + 'px';
        board.style.top = newBoardTop + 'px';
        
        updateZoomDisplay();
        saveData();
    }, { passive: false });

    function renderDrawings() { 
        const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
        const svg = document.getElementById('svg-layer-front'); svg.innerHTML='';
        sheet.data.drawings.forEach((d, i) => {
            const p = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            p.setAttribute('class', 'drawing-path'); p.setAttribute('d', d.d);
            if(selectedItems.drawings.has(i)) p.classList.add('selected-svg-item');
            p.onclick = () => { if(isEraserMode) { recordHistory(); sheet.data.drawings.splice(i,1); renderDrawings(); saveData(); }};
            svg.appendChild(p);
        });
    }
    
    function performSelectionHitTest() { 
        clearSelection();
        const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
        document.querySelectorAll('.note').forEach(n => { if(isIntersect(lassoRect, n.getBoundingClientRect())) { selectedItems.notes.add(n.dataset.id); n.classList.add('selected-item'); } });
        document.querySelectorAll('.drawing-path').forEach((p,i) => { if(isIntersect(lassoRect, p.getBoundingClientRect())) { selectedItems.drawings.add(i); p.classList.add('selected-svg-item'); } });
        document.querySelectorAll('.connector-group').forEach((c,i) => { if(isIntersect(lassoRect, c.getBoundingClientRect())) { selectedItems.connections.add(i); c.classList.add('selected-svg-item'); } });
    }
    function isIntersect(r1, r2) { return !(r2.left > r1.right || r2.right < r1.left || r2.top > r1.bottom || r2.bottom < r1.top); }
    function clearSelection() { selectedItems.notes.clear(); selectedItems.drawings.clear(); selectedItems.connections.clear(); document.querySelectorAll('.selected-item, .selected-svg-item').forEach(e=>e.classList.remove('selected-item','selected-svg-item')); selectionMenu.style.display='none'; }
    
    zoomSlider.oninput = (e) => { 
        applyCenteredZoom(e.target.value / 100); 
    };

	    // æŒ‡å®šã—ãŸå€ç‡ã¸ã€Œç”»é¢ä¸­å¤®åŸºæº–ã€ã§ã‚ºãƒ¼ãƒ ã™ã‚‹é–¢æ•°
    function applyCenteredZoom(newScale) {
        // ç¯„å›²åˆ¶é™ (0.1å€ ï½ 3å€)
        if (newScale > 3) newScale = 3;
        if (newScale < 0.1) newScale = 0.1;

        // 1. ç”»é¢ï¼ˆãƒ©ãƒƒãƒ‘ãƒ¼ï¼‰ã®ä¸­å¤®åº§æ¨™ã‚’å–å¾—
        const rect = wrapper.getBoundingClientRect();
        const centerX = rect.width / 2;
        const centerY = rect.height / 2;

        // 2. ç¾åœ¨ã®ãƒœãƒ¼ãƒ‰ã®ä½ç½®ã‚’å–å¾—
        const boardLeft = parseFloat(board.style.left || 0);
        const boardTop = parseFloat(board.style.top || 0);

        // 3. ã€Œä»Šã€ç”»é¢ä¸­å¤®ã«è¦‹ãˆã¦ã„ã‚‹ãƒœãƒ¼ãƒ‰ä¸Šã®ç‚¹ã€ã®åº§æ¨™ã‚’é€†ç®—
        // (ç”»é¢ä¸­å¤® - ãƒœãƒ¼ãƒ‰ã®ç«¯) / ä»Šã®å€ç‡ = ãƒœãƒ¼ãƒ‰ä¸Šã®çµ¶å¯¾åº§æ¨™
        const pointX = (centerX - boardLeft) / currentScale;
        const pointY = (centerY - boardTop) / currentScale;

        // 4. å€ç‡ã‚’æ›´æ–°
        currentScale = newScale;

        // 5. æ–°ã—ã„ä½ç½®ã‚’è¨ˆç®—
        // ç”»é¢ä¸­å¤® - (ã•ã£ãã®ç‚¹ * æ–°ã—ã„å€ç‡) = æ–°ã—ã„ãƒœãƒ¼ãƒ‰ã®ç«¯
        const newBoardLeft = centerX - (pointX * currentScale);
        const newBoardTop = centerY - (pointY * currentScale);

        // 6. é©ç”¨
        board.style.left = newBoardLeft + 'px';
        board.style.top = newBoardTop + 'px';

        updateZoomDisplay();
        saveData();
    }
    
	/*è™«çœ¼é¡ãƒœã‚¿ãƒ³å€ç‡è¨­å®š*/
    function adjustZoom(amount) {
        // ç¾åœ¨ã®ï¼…ã«åŠ ç®—ã—ã¦æ–°ã—ã„å€ç‡ã‚’ç®—å‡º
        let newPercent = Math.round(currentScale * 100) + amount;
        
        // applyCenteredZoom ã«æ¸¡ã™ï¼ˆå‘ã“ã†ã§åº§æ¨™è¨ˆç®—ã™ã‚‹ï¼‰
        applyCenteredZoom(newPercent / 100);
    }

	/*å€ç‡æ›´æ–°*/
    function updateZoomDisplay() {
    board.style.transform=`scale(${currentScale})`; 
    const percent = Math.round(currentScale * 100);
    zoomLevelDisplay.innerText=`${percent}%`;
    
    zoomSlider.value = percent;
	}
    function resetView() { currentScale=1; board.style.left='-100px'; board.style.top='-100px'; updateZoomDisplay(); saveData(); }

    function applyStamp(char) {
        if (!activeNoteId) return;
        const note = document.querySelector(`.note[data-id="${activeNoteId}"]`);
        if (note) {
            recordHistory();
            applyStampToNote(note, char);
            saveData();
            closePopups();
        }
    }

    function applyStampToNote(note, char) {
        const span=document.createElement('div'); span.className='stamp-item'; span.innerText=char;
        span.onclick=(e)=>{e.stopPropagation(); span.remove(); saveData();};
        note.querySelector('.stamp-area').appendChild(span);
    }
    
    function showLabelMenu(id,x,y){ activeNoteId=id; labelMenu.style.display='block'; labelMenu.style.left=x+'px'; labelMenu.style.top=y+'px'; 
        const note=document.querySelector(`.note[data-id="${id}"]`); let labels=[]; try{labels=JSON.parse(note.dataset.labels||'[]');}catch(e){}
        const cont=document.getElementById('current-labels-container'); cont.innerHTML='';
        labels.forEach(l=>{const b=document.createElement('div');b.className='label-badge-removable';b.innerText=l+' âœ•';b.onclick=()=>removeLabel(l);cont.appendChild(b);});
        const hist=document.getElementById('label-history-list'); hist.innerHTML=''; const allLabels=new Set();
        appData.sheets.forEach(s=>s.data&&s.data.notes&&s.data.notes.forEach(n=>(n.labels||[]).forEach(l=>allLabels.add(l))));
        allLabels.forEach(l=>{const d=document.createElement('div');d.className='label-option';d.innerText=l;d.onclick=()=>addLabel(l);hist.appendChild(d);});
    }
    function showStampMenu(id, x, y) { activeNoteId = id; stampMenu.style.display = 'grid'; stampMenu.style.left = x + 'px'; stampMenu.style.top = y + 'px'; }

    function addLabelFromInput(){ const v=document.getElementById('label-input').value.trim(); if(v) addLabel(v); }
    function addLabel(l){ const n=document.querySelector(`.note[data-id="${activeNoteId}"]`); let ls=[]; try{ls=JSON.parse(n.dataset.labels);}catch(e){} if(!ls.includes(l)){ls.push(l); n.dataset.labels=JSON.stringify(ls); renderNoteLabels(n,ls); saveData();} closePopups(); }
    function removeLabel(l){ const n=document.querySelector(`.note[data-id="${activeNoteId}"]`); let ls=[]; try{ls=JSON.parse(n.dataset.labels);}catch(e){} ls=ls.filter(x=>x!==l); n.dataset.labels=JSON.stringify(ls); renderNoteLabels(n,ls); saveData(); showLabelMenu(activeNoteId, parseInt(labelMenu.style.left), parseInt(labelMenu.style.top)); }
    function renderNoteLabels(n,ls){ const c=n.querySelector('.note-labels-container'); c.innerHTML=''; ls.forEach(l=>{const d=document.createElement('div');d.className='note-label-chip';d.innerText=l;c.appendChild(d);}); }
    
    function deleteSelectedItems(){
        if(appData.confirmDelete!==false && !confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
        recordHistory(); const s=appData.sheets.find(x=>x.id===appData.currentSheetId);
        selectedItems.notes.forEach(id=>{ const el=document.querySelector(`.note[data-id="${id}"]`); if(el) el.remove(); if(s.data.connections) s.data.connections=s.data.connections.filter(c=>c.from!==id&&c.to!==id); });
        Array.from(selectedItems.drawings).sort((a,b)=>b-a).forEach(i=>s.data.drawings.splice(i,1));
        Array.from(selectedItems.connections).sort((a,b)=>b-a).forEach(i=>s.data.connections.splice(i,1));
        clearSelection(); renderDrawings(); renderConnections(); saveData();
    }
    
    function duplicateSelectedItems(){
        recordHistory(); const s=appData.sheets.find(x=>x.id===appData.currentSheetId);
        const off=30/currentScale; const idMap={};
        const newNotes=new Set(), newDraws=new Set(), newConns=new Set();
        selectedItems.notes.forEach(oid=>{
            const el=document.querySelector(`.note[data-id="${oid}"]`); if(!el)return;
            const nid='n_'+Date.now()+'_'+Math.floor(Math.random()*1000); idMap[oid]=nid;
            const d={ id:nid, left:(parseFloat(el.style.left)+off)+'px', top:(parseFloat(el.style.top)+off)+'px', width:el.style.width, height:el.style.height, backgroundColor:el.style.backgroundColor, zIndex:parseInt(el.style.zIndex)+1, contentHTML:el.querySelector('.note-content').innerHTML, fontSize:el.querySelector('.note-content').style.fontSize, labels:JSON.parse(el.dataset.labels||'[]'), stamps:[] };
            el.querySelectorAll('.stamp-item').forEach(st=>d.stamps.push(st.innerText));
            createNoteDOM(d); newNotes.add(nid);
        });
        selectedItems.drawings.forEach(i=>{
            const d=s.data.drawings[i]; if(d){ s.data.drawings.push({d:d.d.replace(/([-\d.]+)\s+([-\d.]+)/g,(m,x,y)=>`${parseFloat(x)+off} ${parseFloat(y)+off}`)}); newDraws.add(s.data.drawings.length-1); }
        });
        selectedItems.connections.forEach(i=>{
            const c=s.data.connections[i]; if(c&&idMap[c.from]&&idMap[c.to]){ s.data.connections.push({from:idMap[c.from], to:idMap[c.to]}); newConns.add(s.data.connections.length-1); }
        });
        clearSelection(); renderDrawings(); renderConnections(); saveData();
        selectedItems.notes=newNotes; selectedItems.drawings=newDraws; selectedItems.connections=newConns;
        newNotes.forEach(id=>document.querySelector(`.note[data-id="${id}"]`).classList.add('selected-item'));
        renderDrawings(); renderConnections();
    }
    
    
	function closePopups() {
	    stampMenu.style.display = 'none';
	    labelMenu.style.display = 'none';
	    searchModal.style.display = 'none';
	    settingsModal.style.display = 'none';
	    selectionMenu.style.display = 'none';
	    // å¤‰æ›´ï¼šã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£çµŒç”±ã§é–‰ã˜ã‚‹
	    hideContextMenu();
	}

    function openSearch(){ const k=document.getElementById('search-keyword'); k.value=''; document.getElementById('search-results-list').innerHTML=''; searchModal.style.display='flex'; k.focus(); }
    function performSearch(){ 
        const k=document.getElementById('search-keyword').value.toLowerCase(); const list=document.getElementById('search-results-list'); list.innerHTML='';
        if(!k)return;
        appData.sheets.forEach(s=>s.data&&s.data.notes&&s.data.notes.forEach(n=>{
            if(n.contentHTML.toLowerCase().includes(k)) {
                const d=document.createElement('div'); d.className='search-result-item';
                d.innerHTML=`<div class="result-sheet">${s.name}</div><div class="result-content">${n.contentHTML.substring(0,50)}</div>`;
                d.onclick=()=>{ jumpToResult(s.id,n.id,parseFloat(n.left),parseFloat(n.top)); };
                list.appendChild(d);
            }
        }));
    }
    function jumpToResult(sid,nid,x,y){ closePopups(); if(appData.currentSheetId!==sid) loadSheet(sid); 
        currentScale=1; updateZoomDisplay();
        const rect=wrapper.getBoundingClientRect();
        board.style.left=(rect.width/2 - x)+'px'; board.style.top=(rect.height/2 - y)+'px';
        setTimeout(()=>{const n=document.querySelector(`.note[data-id="${nid}"]`); if(n){n.style.transition='box-shadow 0.5s'; n.style.boxShadow='0 0 0 10px red'; setTimeout(()=>n.style.boxShadow='',1000);}},100);
        saveData();
    }
    function openSettings(){ 
        const c = document.getElementById('color-setting-container'); 
        c.innerHTML = '';
        appData.colors.forEach((col, i) => { 
            const ip = document.createElement('input'); 
            ip.type = 'color'; 
            ip.value = col; 
            ip.id = `color-setting-${i}`; 
            // ã‚«ãƒ©ãƒ¼å¤‰æ›´æ™‚ã«å³ä¿å­˜ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ã¯é–‰ã˜ãªã„ï¼‰
            ip.onchange = () => saveSettings(true);
            c.appendChild(ip); 
        });
        
        document.getElementById('setting-confirm-delete').checked = appData.confirmDelete;
        document.getElementById('setting-snap').checked = (appData.snapToGrid !== false);
        document.getElementById('setting-show-minimap').checked = (appData.showMinimap !== false);
        settingsModal.style.display = 'flex'; 
    }

    // å¼•æ•° keepOpen: trueãªã‚‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ãªã„ï¼ˆå³æ™‚åæ˜ ç”¨ï¼‰
    function saveSettings(keepOpen = false) {
        for(let i=0; i<6; i++) {
            const el = document.getElementById(`color-setting-${i}`);
            if (el) appData.colors[i] = el.value;
        }
        appData.confirmDelete = document.getElementById('setting-confirm-delete').checked;
        appData.snapToGrid = document.getElementById('setting-snap').checked;
        appData.showMinimap = document.getElementById('setting-show-minimap').checked;
        toggleMinimapDisplay();
        
        saveData(); 
        refreshNotePalettes(); 
        
        if (!keepOpen) {
            settingsModal.style.display = 'none';
        }
    }
    

	function showContextMenu(e, type, id) { 
	    e.preventDefault();
	    closePopups(); 

	    ctxMenu.innerHTML = '';
	    ctxMenu.style.display = 'block';
	    ctxMenu.style.left = e.clientX + 'px';
	    ctxMenu.style.top = e.clientY + 'px';

	    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼å†…ã‚¯ãƒªãƒƒã‚¯ã¯é–‰ã˜å‹•ä½œã‚’é˜»æ­¢
	    ctxMenu.addEventListener('mousedown', (ev) => ev.stopPropagation(), { once: true, capture: true });
	    ctxMenu.addEventListener('touchstart', (ev) => ev.stopPropagation(), { once: true, capture: true });

	    // è¿½åŠ ï¼šæ å¤–ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—/ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«/ãƒªã‚µã‚¤ã‚ºã§é–‰ã˜ã‚‹
	    if (!ctxOutsideHandler) {
	        ctxOutsideHandler = (ev) => {
	            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¤–ãªã‚‰é–‰ã˜ã‚‹
	            if (!ctxMenu.contains(ev.target)) {
	                hideContextMenu();
	            }
	        };
	        document.addEventListener('mousedown', ctxOutsideHandler, true);
	        document.addEventListener('touchstart', ctxOutsideHandler, true);
	        document.addEventListener('scroll', ctxOutsideHandler, true);
	        window.addEventListener('resize', ctxOutsideHandler, true);
	    }

	    const addItem = (l, i, act) => {
	        const d = document.createElement('div');
	        d.className = 'ctx-item';
	        d.innerHTML = `<span class="material-symbols-outlined" style="font-size:16px;">${i}</span>${l}`;
	        d.onclick = () => { act(); hideContextMenu(); }; // â† ã‚¯ãƒªãƒƒã‚¯å¾Œã¯é–‰ã˜ã‚‹
	        ctxMenu.appendChild(d);
	    };

	    if (type === 'folder') {
	        addItem('ã‚·ãƒ¼ãƒˆè¿½åŠ ', 'note_add', () => createNewSheet(id));
	        addItem('åå‰å¤‰æ›´', 'edit', () => { const f = appData.folders.find(x => x.id === id); const n = prompt('åå‰', f.name); if (n) { f.name = n; renderSidebar(); saveData(); }});
	        addItem('ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‰Šé™¤', 'delete', () => { if (confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) { appData.folders = appData.folders.filter(x => x.id !== id); appData.sheets = appData.sheets.filter(x => x.folderId !== id); renderSidebar(); saveData(); }});
	    } else {
	        addItem('åå‰å¤‰æ›´', 'edit', () => { const s = appData.sheets.find(x => x.id === id); const n = prompt('åå‰', s.name); if (n) { s.name = n; renderSidebar(); saveData(); }});
	        addItem('å‰Šé™¤', 'delete', () => { if (confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) { appData.sheets = appData.sheets.filter(x => x.id !== id); if (appData.currentSheetId === id) loadSheet(appData.sheets[0]?.id); else renderSidebar(); saveData(); }});
	    }
	}


	    function renderSidebar() {
        sidebarTree.innerHTML='';
        appData.folders.forEach(f => {
            const folderDiv = document.createElement('div');
            const header = document.createElement('div');
            header.className = 'tree-item';
            header.innerHTML = `<span class="folder-toggle material-symbols-outlined">${f.isOpen ? 'expand_more' : 'chevron_right'}</span><span class="material-symbols-outlined">folder</span><span>${f.name}</span>`;
            
            header.onclick = (e) => {
                if(e.target.closest('.folder-toggle')) {
                    f.isOpen = !f.isOpen; renderSidebar(); saveData();
                }
            };
            header.oncontextmenu = (e) => showContextMenu(e, 'folder', f.id);
            
            // â–¼â–¼â–¼ ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—è¨­å®šï¼ˆä¿®æ­£ãƒ»è¿½åŠ ï¼‰ â–¼â–¼â–¼
            header.draggable = true;
            
            header.ondragstart = (e) => {
                // ãƒ•ã‚©ãƒ«ãƒ€ç§»å‹•ã§ã‚ã‚‹ã“ã¨ã‚’è­˜åˆ¥ã™ã‚‹ã‚­ãƒ¼ã‚’ä½¿ç”¨
                e.dataTransfer.setData('application/x-folder', f.id);
                e.dataTransfer.effectAllowed = 'move';
            };

            header.ondragover = e => {
                e.preventDefault();
                
                // ãƒ‰ãƒ©ãƒƒã‚°ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ãŒã€Œãƒ•ã‚©ãƒ«ãƒ€ã€ã‹ã€Œã‚·ãƒ¼ãƒˆã€ã‹ã§åˆ†å²
                if (e.dataTransfer.types.includes('application/x-folder')) {
                    // --- ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ ---
                    header.style.background = ''; // ã‚·ãƒ¼ãƒˆå—ã‘å…¥ã‚Œç”¨ã®èƒŒæ™¯ã¯æ¶ˆã™
                    
                    const rect = header.getBoundingClientRect();
                    const mid = rect.top + rect.height / 2;
                    
                    if (e.clientY < mid) {
                        header.style.borderTop = '2px solid var(--accent-color)';
                        header.style.borderBottom = '';
                        header.dataset.dropPos = 'before';
                    } else {
                        header.style.borderTop = '';
                        header.style.borderBottom = '2px solid var(--accent-color)';
                        header.dataset.dropPos = 'after';
                    }
                    
                } else {
                    // --- ã‚·ãƒ¼ãƒˆã®å—ã‘å…¥ã‚Œãƒ¢ãƒ¼ãƒ‰ï¼ˆæ—¢å­˜æ©Ÿèƒ½ï¼‰ ---
                    // æ ç·šã¯æ¶ˆã™
                    header.style.borderTop = '';
                    header.style.borderBottom = '';
                    // èƒŒæ™¯ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                    header.style.background = 'var(--active-item)';
                }
            };

            header.ondragleave = () => {
                header.style.background = '';
                header.style.borderTop = '';
                header.style.borderBottom = '';
            };

            header.ondrop = e => {
                e.preventDefault();
                // ã‚¹ã‚¿ã‚¤ãƒ«ãƒªã‚»ãƒƒãƒˆ
                header.style.background = '';
                header.style.borderTop = '';
                header.style.borderBottom = '';

                // ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
                const folderId = e.dataTransfer.getData('application/x-folder');
                const sheetId = e.dataTransfer.getData('text/plain');

                if (folderId) {
                    // ãƒ•ã‚©ãƒ«ãƒ€åŒå£«ã®ä¸¦ã³æ›¿ãˆ
                    if (folderId !== f.id) {
                        reorderFolder(folderId, f.id, header.dataset.dropPos || 'before');
                    }
                } else if (sheetId) {
                    // ã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚©ãƒ«ãƒ€ã¸ç§»å‹•ï¼ˆæ—¢å­˜æ©Ÿèƒ½ï¼‰
                    moveSheetToFolder(sheetId, f.id);
                }
            };
            // â–²â–²â–² ãƒ•ã‚©ãƒ«ãƒ€è¨­å®šã“ã“ã¾ã§ â–²â–²â–²

            folderDiv.appendChild(header);

            if (f.isOpen) {
                appData.sheets.filter(s => s.folderId === f.id).forEach(s => {
                    const sheetDiv = document.createElement('div');
                    sheetDiv.className = `tree-item sheet-item ${s.id === appData.currentSheetId ? 'active' : ''}`;
                    sheetDiv.innerHTML = `<span class="material-symbols-outlined" style="font-size:16px;">description</span> ${s.name}`;
                    sheetDiv.onclick = () => loadSheet(s.id);
                    sheetDiv.oncontextmenu = (e) => showContextMenu(e, 'sheet', s.id);
                    
                    sheetDiv.draggable = true;
                    sheetDiv.ondragstart = (e) => {
                        e.dataTransfer.setData('text/plain', s.id);
                        e.dataTransfer.effectAllowed = 'move';
                    };
                    
                    sheetDiv.ondragover = (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        // ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã‚·ãƒ¼ãƒˆã®ä¸Šã«ãƒ‰ãƒ©ãƒƒã‚°ã—ãŸå ´åˆãªã©ã¯ç„¡è¦–
                        if (e.dataTransfer.types.includes('application/x-folder')) return;

                        const rect = sheetDiv.getBoundingClientRect();
                        const mid = rect.top + rect.height / 2;
                        
                        if (e.clientY < mid) {
                            sheetDiv.style.borderTop = '2px solid var(--accent-color)';
                            sheetDiv.style.borderBottom = '';
                            sheetDiv.dataset.dropPos = 'before';
                        } else {
                            sheetDiv.style.borderTop = '';
                            sheetDiv.style.borderBottom = '2px solid var(--accent-color)';
                            sheetDiv.dataset.dropPos = 'after';
                        }
                    };
                    
                    sheetDiv.ondragleave = () => {
                        sheetDiv.style.borderTop = '';
                        sheetDiv.style.borderBottom = '';
                    };
                    
                    sheetDiv.ondrop = (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        sheetDiv.style.borderTop = '';
                        sheetDiv.style.borderBottom = '';
                        
                        const sourceId = e.dataTransfer.getData('text/plain');
                        // ãƒ•ã‚©ãƒ«ãƒ€ãŒãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚ŒãŸå ´åˆã¯ä½•ã‚‚ã—ãªã„
                        if (!sourceId) return;

                        const position = sheetDiv.dataset.dropPos || 'before';
                        
                        if (sourceId && sourceId !== s.id) {
                            reorderSheet(sourceId, s.id, position);
                        }
                    };
                    folderDiv.appendChild(sheetDiv);
                });
            }
            sidebarTree.appendChild(folderDiv);
        });
    }
    
    function createNewSheet(fid) { 
        const id='s_'+Date.now(); 
        appData.sheets.push({id:id, folderId:fid, name:'ç„¡é¡Œ', data:null}); 
        loadSheet(id); 
    }

	    // ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸¦ã³æ›¿ãˆã‚’å®Ÿè¡Œã™ã‚‹é–¢æ•°
    function reorderFolder(sourceId, targetId, position) {
        const sourceIndex = appData.folders.findIndex(f => f.id === sourceId);
        // spliceã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå¤‰ã‚ã‚‹ãŸã‚ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ä¸€åº¦ç¢ºä¿
        const targetFolder = appData.folders.find(f => f.id === targetId);
        
        if (sourceIndex === -1 || !targetFolder) return;

        recordHistory();

        // 1. å…ƒã®é…åˆ—ã‹ã‚‰å‰Šé™¤
        const [movedFolder] = appData.folders.splice(sourceIndex, 1);

        // 2. ç§»å‹•å…ˆã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å†å–å¾—
        let newTargetIndex = appData.folders.findIndex(f => f.id === targetId);

        // 3. ã€Œç›´å¾Œ(after)ã€ãªã‚‰ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’é€²ã‚ã‚‹
        if (position === 'after') {
            newTargetIndex++;
        }

        // 4. æŒ¿å…¥
        appData.folders.splice(newTargetIndex, 0, movedFolder);

        renderSidebar();
        saveData();
    }
    
    // ã‚·ãƒ¼ãƒˆã®ä¸¦ã³æ›¿ãˆã‚’å®Ÿè¡Œã™ã‚‹é–¢æ•°ï¼ˆä¿®æ­£ç‰ˆï¼‰
    function reorderSheet(sourceId, targetId, position) {
        const sourceIndex = appData.sheets.findIndex(s => s.id === sourceId);
        const targetSheet = appData.sheets.find(s => s.id === targetId);
        
        if (sourceIndex === -1 || !targetSheet) return;

        recordHistory();

        // 1. å…ƒã®ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤
        const [movedSheet] = appData.sheets.splice(sourceIndex, 1);
        
        // 2. ãƒ•ã‚©ãƒ«ãƒ€IDã‚’ç§»å‹•å…ˆã«åˆã‚ã›ã‚‹
        movedSheet.folderId = targetSheet.folderId;

        // 3. ç§»å‹•å…ˆã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å†å–å¾—
        let newTargetIndex = appData.sheets.findIndex(s => s.id === targetId);

        // 4. ã€Œç›´å¾Œ(after)ã€ã¸ã®æŒ¿å…¥ãªã‚‰ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’+1ã™ã‚‹
        if (position === 'after') {
            newTargetIndex++;
        }

        // 5. æŒ¿å…¥
        appData.sheets.splice(newTargetIndex, 0, movedSheet);

        renderSidebar();
        saveData();
    }
    
    function moveSheetToFolder(sid, fid) {
        const s = appData.sheets.find(x=>x.id===sid);
        if(s && s.folderId !== fid) {
            recordHistory(); s.folderId = fid; renderSidebar(); saveData();
        }
    }

    function toggleDarkMode() {
        recordHistory(); appData.darkMode = !appData.darkMode;
        applyTheme(); saveData();
    }
    function applyTheme() {
        if(appData.darkMode) {
            document.body.classList.add('dark-mode'); document.getElementById('theme-icon').innerText = 'light_mode';
        } else {
            document.body.classList.remove('dark-mode'); document.getElementById('theme-icon').innerText = 'dark_mode';
        }
    }

    function refreshNotePalettes() {
        document.querySelectorAll('.note').forEach(note => {
            const toolGroup = note.querySelector('.tool-group.color-group');
            if(toolGroup) {
                toolGroup.innerHTML = appData.colors.map(c => `<div class="color-dot" style="background:${c}" data-color="${c}"></div>`).join('');
                toolGroup.querySelectorAll('.color-dot').forEach(d => {
                    d.onclick = (e) => {
                        recordHistory();
                        note.style.backgroundColor = e.target.dataset.color;
                        saveData();
                    }
                });
            }
        });
    }
    
        // â–¼â–¼â–¼ å¸ç€è¨ˆç®—ç”¨é–¢æ•°ï¼ˆä¿®æ­£ç‰ˆï¼šã‚°ãƒªãƒƒãƒ‰ãªã—ãƒ»è·é›¢åˆ¶é™ã‚ã‚Šï¼‰ â–¼â–¼â–¼
        // â–¼â–¼â–¼ å¸ç€è¨ˆç®—ç”¨é–¢æ•°ï¼ˆæ”¹è‰¯ç‰ˆï¼šæœ€å°èª¤å·®å„ªå…ˆã‚¹ã‚­ãƒ£ãƒ³ï¼‰ â–¼â–¼â–¼
        // â–¼â–¼â–¼ å¸ç€è¨ˆç®—ç”¨é–¢æ•°ï¼ˆä¿®æ­£ãƒ»å®‰å®šç‰ˆï¼‰ â–¼â–¼â–¼
    function calculateSnap(newLeft, newTop, width, height, selfId) {
        if (appData.snapToGrid === false) return { x: newLeft, y: newTop };

        const THRESHOLD = 8;         // å¸ç€è·é›¢ (px)
        const PROXIMITY_LIMIT = 600; // æ¢ç´¢ç¯„å›² (px) - å°‘ã—åºƒã’ã¾ã—ãŸ

        let bestX = newLeft;
        let bestY = newTop;
        
        let minDiffX = THRESHOLD; 
        let minDiffY = THRESHOLD;

        // è‡ªåˆ†ã®åº§æ¨™æƒ…å ±
        const my = {
            l: newLeft,
            r: newLeft + width,
            c: newLeft + width / 2,
            t: newTop,
            b: newTop + height,
            m: newTop + height / 2
        };

        const otherNotes = Array.from(document.querySelectorAll('.note')).filter(n => n.dataset.id !== selfId);

        for (const note of otherNotes) {
            // â˜…ä¿®æ­£ç‚¹ï¼šstyleãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã¯ãªãã€æç”»ã‚µã‚¤ã‚º(offset)ã‚’ç›´æ¥å–å¾—ã—ã¦å®‰å®šåŒ–
            const nl = parseFloat(note.style.left);
            const nt = parseFloat(note.style.top);
            
            // å€¤ãŒå–ã‚Œãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
            if (isNaN(nl) || isNaN(nt)) continue;

            const nw = note.offsetWidth;  // å¹…
            const nh = note.offsetHeight; // é«˜ã•
            
            const target = {
                l: nl,
                r: nl + nw,
                c: nl + nw / 2,
                t: nt,
                b: nt + nh,
                m: nt + nh / 2
            };

            // è·é›¢ãƒã‚§ãƒƒã‚¯
            const dist = Math.hypot(my.c - target.c, my.m - target.m);
            if (dist > PROXIMITY_LIMIT) continue;

            // --- Xè»¸ã®å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒã‚§ãƒƒã‚¯ ---
            const candidatesX = [
                { val: target.l, diff: Math.abs(my.l - target.l) },             // å·¦æƒãˆ
                { val: target.r, diff: Math.abs(my.l - target.r) },             // å·¦-å³
                { val: target.l - width, diff: Math.abs(my.r - target.l) },     // å³-å·¦
                { val: target.r - width, diff: Math.abs(my.r - target.r) },     // å³æƒãˆ
                { val: target.c - width/2, diff: Math.abs(my.c - target.c) }    // ä¸­å¤®æƒãˆ
            ];

            for (const cand of candidatesX) {
                if (cand.diff < minDiffX) {
                    minDiffX = cand.diff;
                    bestX = cand.val;
                }
            }

            // --- Yè»¸ã®å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒã‚§ãƒƒã‚¯ ---
            const candidatesY = [
                { val: target.t, diff: Math.abs(my.t - target.t) },             // ä¸Šæƒãˆ
                { val: target.b, diff: Math.abs(my.t - target.b) },             // ä¸Š-ä¸‹
                { val: target.t - height, diff: Math.abs(my.b - target.t) },    // ä¸‹-ä¸Š
                { val: target.b - height, diff: Math.abs(my.b - target.b) },    // ä¸‹æƒãˆ
                { val: target.m - height/2, diff: Math.abs(my.m - target.m) }   // ä¸­å¤®æƒãˆ
            ];

            for (const cand of candidatesY) {
                if (cand.diff < minDiffY) {
                    minDiffY = cand.diff;
                    bestY = cand.val;
                }
            }
        }

        return { x: bestX, y: bestY };
    }

        // --- è¿½åŠ æ©Ÿèƒ½: é¸æŠã‚¢ã‚¤ãƒ†ãƒ ã®æ•´åˆ— ---
    function alignSelectedItems(mode) {
        // ä»˜ç®‹ãŒ2ã¤ä»¥ä¸Šé¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„
        if (selectedItems.notes.size < 2) return;

        recordHistory();

        // é¸æŠã•ã‚ŒãŸä»˜ç®‹ã®DOMè¦ç´ ã¨åº§æ¨™æƒ…å ±ã‚’å–å¾—
        const notes = Array.from(selectedItems.notes).map(id => {
            const el = document.querySelector(`.note[data-id="${id}"]`);
            if (!el) return null;
            return {
                id: id,
                el: el,
                x: parseFloat(el.style.left),
                y: parseFloat(el.style.top),
                w: el.offsetWidth,
                h: el.offsetHeight
            };
        }).filter(n => n !== null);

        if (notes.length === 0) return;

        // å…¨ä½“ã®å¢ƒç•Œï¼ˆãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹ï¼‰ã‚’è¨ˆç®—
        const minX = Math.min(...notes.map(n => n.x));
        const maxX = Math.max(...notes.map(n => n.x + n.w));
        const minY = Math.min(...notes.map(n => n.y));
        const maxY = Math.max(...notes.map(n => n.y + n.h));
        
        // ä¸­å¿ƒåº§æ¨™
        const centerX = minX + (maxX - minX) / 2;
        const centerY = minY + (maxY - minY) / 2;

        // å„ä»˜ç®‹ã®ä½ç½®ã‚’æ›´æ–°
        notes.forEach(n => {
            switch (mode) {
                // æ°´å¹³æ–¹å‘
                case 'left':
                    n.el.style.left = minX + 'px';
                    break;
                case 'center-x':
                    n.el.style.left = (centerX - n.w / 2) + 'px';
                    break;
                case 'right':
                    n.el.style.left = (maxX - n.w) + 'px';
                    break;
                
                // å‚ç›´æ–¹å‘
                case 'top':
                    n.el.style.top = minY + 'px';
                    break;
                case 'center-y':
                    n.el.style.top = (centerY - n.h / 2) + 'px';
                    break;
                case 'bottom':
                    n.el.style.top = (maxY - n.h) + 'px';
                    break;
            }
        });

        // æ¥ç¶šç·šã®å†æç”»ï¼ˆä»˜ç®‹ãŒå‹•ã„ãŸãŸã‚ï¼‰
        renderConnections();
        
        // ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
        saveData();
        
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹
        selectionMenu.style.display = 'none';
    }

    function updateMinimap() {
        const mmCont = document.getElementById('minimap-content');
        const mmView = document.getElementById('minimap-viewport');
        
        // æ—¢å­˜ã®ãƒ‰ãƒƒãƒˆã‚’ã‚¯ãƒªã‚¢ï¼ˆãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆä»¥å¤–ï¼‰
        Array.from(mmCont.children).forEach(c => {
            if (c.id !== 'minimap-viewport') c.remove();
        });

        const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
        if (!sheet || !sheet.data || !sheet.data.notes) return;

        // å…¨ä»˜ç®‹ã®å¢ƒç•Œã‚’è¨ˆç®—
        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
        
        const notes = sheet.data.notes;
        if (notes.length === 0) return;

        notes.forEach(n => {
            const x = parseFloat(n.left);
            const y = parseFloat(n.top);
            const w = parseFloat(n.width) || 200;
            const h = parseFloat(n.height) || 150;
            if (x < minX) minX = x;
            if (y < minY) minY = y;
            if (x + w > maxX) maxX = x + w;
            if (y + h > maxY) maxY = y + h;
        });

        // ä½™ç™½ã‚’å«ã‚ã‚‹
        const padding = 2000;
        minX -= padding; minY -= padding;
        maxX += padding; maxY += padding;
        
        const totalW = maxX - minX;
        const totalH = maxY - minY;
        
        // ãƒŸãƒ‹ãƒãƒƒãƒ—ã®ã‚µã‚¤ã‚º
        const mapW = mmCont.clientWidth;
        const mapH = mmCont.clientHeight;

        // ç¸®å°ç‡ã®è¨ˆç®—ï¼ˆç¸¦æ¨ªã©ã¡ã‚‰ã«åˆã‚ã›ã¦ç¸®å°ã™ã‚‹ã‹ï¼‰
        const scaleX = mapW / totalW;
        const scaleY = mapH / totalH;
        minimapScale = Math.min(scaleX, scaleY);

        // å„ä»˜ç®‹ã‚’ãƒ‰ãƒƒãƒˆã¨ã—ã¦æç”»
        notes.forEach(n => {
            const dot = document.createElement('div');
            dot.className = 'minimap-node';
            const nx = parseFloat(n.left);
            const ny = parseFloat(n.top);
            const nw = parseFloat(n.width) || 200;
            const nh = parseFloat(n.height) || 150;

            dot.style.left = (nx - minX) * minimapScale + 'px';
            dot.style.top = (ny - minY) * minimapScale + 'px';
            dot.style.width = Math.max(2, nw * minimapScale) + 'px';
            dot.style.height = Math.max(2, nh * minimapScale) + 'px';
            mmCont.appendChild(dot);
        });

        // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆæ ã®æ›´æ–°
        // ç¾åœ¨ã®ç”»é¢è¡¨ç¤ºé ˜åŸŸ
        const wrapper = document.getElementById('canvas-wrapper');
        const wW = wrapper.clientWidth;
        const wH = wrapper.clientHeight;
        
        // Boardã®ã‚ªãƒ•ã‚»ãƒƒãƒˆï¼ˆé€†ç®—ï¼‰
        const bL = parseFloat(board.style.left) || 0;
        const bT = parseFloat(board.style.top) || 0;
        
        // ç”»é¢ã®å·¦ä¸ŠãŒBoardä¸Šã®ã©ã“ã‹
        // screenX = boardX + scale * worldX  => worldX = (screenX - boardX) / scale
        const viewX = (0 - bL) / currentScale;
        const viewY = (0 - bT) / currentScale;
        const viewW = wW / currentScale;
        const viewH = wH / currentScale;

        mmView.style.left = (viewX - minX) * minimapScale + 'px';
        mmView.style.top = (viewY - minY) * minimapScale + 'px';
        mmView.style.width = viewW * minimapScale + 'px';
        mmView.style.height = viewH * minimapScale + 'px';
    }

        /* --- ãƒŸãƒ‹ãƒãƒƒãƒ—æ©Ÿèƒ½ --- */
    function initMinimap() {
        toggleMinimapDisplay();
        
        // 0.5ç§’ã”ã¨ã«æ›´æ–°ï¼ˆè² è·å¯¾ç­–ï¼‰
        setInterval(updateMinimap, 500);

        // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•æ©Ÿèƒ½
        const mmCont = document.getElementById('minimap-content');
        let isDraggingMap = false;

        mmCont.addEventListener('mousedown', (e) => {
            isDraggingMap = true;
            moveViewToMap(e.clientX, e.clientY);
        });
        
        window.addEventListener('mousemove', (e) => {
            if(isDraggingMap && appData.showMinimap) {
                e.preventDefault();
                moveViewToMap(e.clientX, e.clientY);
            }
        });
        
        window.addEventListener('mouseup', () => { isDraggingMap = false; });
    }

    function toggleMinimapDisplay() {
        const mm = document.getElementById('minimap-container');
        if (appData.showMinimap !== false) {
            mm.style.display = 'block';
            updateMinimap(); // è¡¨ç¤ºã—ãŸç¬é–“ã«æ›´æ–°
        } else {
            mm.style.display = 'none';
        }
    }

    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨ã—ã¦ä¿æŒï¼ˆã‚¯ãƒªãƒƒã‚¯ç§»å‹•è¨ˆç®—ç”¨ï¼‰
    let mmState = { minX:0, minY:0, scale:0.1 };

    function updateMinimap() {
        if (appData.showMinimap === false) return;

        const mmCont = document.getElementById('minimap-content');
        const mmView = document.getElementById('minimap-viewport');
        const wrapper = document.getElementById('canvas-wrapper');
        
        // æ—¢å­˜ã®ãƒ‰ãƒƒãƒˆã‚’å‰Šé™¤
        Array.from(mmCont.querySelectorAll('.minimap-node')).forEach(el => el.remove());

        const sheet = appData.sheets.find(s => s.id === appData.currentSheetId);
        const notes = (sheet && sheet.data && sheet.data.notes) ? sheet.data.notes : [];

        // 1. å…¨ä»˜ç®‹ã®ç¯„å›²ã‚’å–å¾—
        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
        
        if (notes.length > 0) {
            notes.forEach(n => {
                const nx = parseFloat(n.left), ny = parseFloat(n.top);
                const nw = parseFloat(n.width)||200, nh = parseFloat(n.height)||150;
                if(nx < minX) minX = nx;
                if(ny < minY) minY = ny;
                if(nx+nw > maxX) maxX = nx+nw;
                if(ny+nh > maxY) maxY = ny+nh;
            });
        } else {
            // ä»˜ç®‹ãŒãªã„å ´åˆã¯åŸç‚¹ä»˜è¿‘ã‚’åŸºæº–ã«ã™ã‚‹
            minX = -1000; minY = -1000; maxX = 1000; maxY = 1000;
        }

        // 2. ç¾åœ¨ã®ç”»é¢è¡¨ç¤ºç¯„å›²ï¼ˆViewportï¼‰ã‚’ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã§å–å¾—
        const bL = parseFloat(board.style.left)||0;
        const bT = parseFloat(board.style.top)||0;
        const wW = wrapper.clientWidth;
        const wH = wrapper.clientHeight;
        
        // ç”»é¢ã®å·¦ä¸Š(0,0)ã¯ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã§ã©ã“ã‹ï¼Ÿ -> (0 - bL) / scale
        const viewL = -bL / currentScale;
        const viewT = -bT / currentScale;
        const viewR = viewL + (wW / currentScale);
        const viewB = viewT + (wH / currentScale);

        // 3. ä»˜ç®‹ç¯„å›²ã¨ç¾åœ¨è¡¨ç¤ºç¯„å›²ã‚’çµ±åˆï¼ˆâ˜…ã“ã‚Œã§è¿·å­ã«ãªã‚‰ãªã„ï¼‰
        // ã•ã‚‰ã«åºƒç¯„å›²ã«è¦‹ãˆã‚‹ã‚ˆã†ã€Paddingã‚’å¤§ããå–ã‚‹ (ä¾‹: 3000px)
        const PADDING = 3000; 
        
        const totalMinX = Math.min(minX, viewL) - PADDING;
        const totalMinY = Math.min(minY, viewT) - PADDING;
        const totalMaxX = Math.max(maxX, viewR) + PADDING;
        const totalMaxY = Math.max(maxY, viewB) + PADDING;

        const totalW = totalMaxX - totalMinX;
        const totalH = totalMaxY - totalMinY;

        // 4. ãƒŸãƒ‹ãƒãƒƒãƒ—ã®ç¸®å°ºè¨ˆç®—
        const mapW = mmCont.clientWidth;
        const mapH = mmCont.clientHeight;
        const scaleX = mapW / totalW;
        const scaleY = mapH / totalH;
        const scale = Math.min(scaleX, scaleY); // åã¾ã‚‹ã‚ˆã†ã«å°ã•ã„æ–¹ã‚’æ¡ç”¨
        
        mmState = { minX: totalMinX, minY: totalMinY, scale: scale };

        // 5. ä»˜ç®‹ãƒ‰ãƒƒãƒˆã®æç”»
        notes.forEach(n => {
            const dot = document.createElement('div');
            dot.className = 'minimap-node';
            const nx = parseFloat(n.left);
            const ny = parseFloat(n.top);
            const nw = parseFloat(n.width)||200;
            const nh = parseFloat(n.height)||150;

            dot.style.left = (nx - totalMinX) * scale + 'px';
            dot.style.top = (ny - totalMinY) * scale + 'px';
            dot.style.width = Math.max(3, nw * scale) + 'px';
            dot.style.height = Math.max(3, nh * scale) + 'px';
            mmCont.appendChild(dot);
        });

        // 6. ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆæ ã®æ›´æ–°
        mmView.style.left = (viewL - totalMinX) * scale + 'px';
        mmView.style.top = (viewT - totalMinY) * scale + 'px';
        mmView.style.width = (wW / currentScale) * scale + 'px';
        mmView.style.height = (wH / currentScale) * scale + 'px';
    }

    // ãƒŸãƒ‹ãƒãƒƒãƒ—ã‚’ã‚¯ãƒªãƒƒã‚¯/ãƒ‰ãƒ©ãƒƒã‚°ã—ãŸä½ç½®ã¸ã‚¸ãƒ£ãƒ³ãƒ—
    function moveViewToMap(clientX, clientY) {
        const mmCont = document.getElementById('minimap-content');
        const rect = mmCont.getBoundingClientRect();
        
        // ãƒŸãƒ‹ãƒãƒƒãƒ—å†…ã®ã‚¯ãƒªãƒƒã‚¯åº§æ¨™ (0~mapW, 0~mapH)
        const clickX = clientX - rect.left;
        const clickY = clientY - rect.top;
        
        // ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã«å¤‰æ›
        // WorldX = minX + (ClickX / scale)
        const worldX = mmState.minX + (clickX / mmState.scale);
        const worldY = mmState.minY + (clickY / mmState.scale);
        
        // ãã®ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã‚’ç”»é¢ä¸­å¿ƒã«ã™ã‚‹ãŸã‚ã® board.style.left/top ã‚’è¨ˆç®—
        // BoardLeft = (WindowWidth/2) - (WorldX * Scale)
        const wrapper = document.getElementById('canvas-wrapper');
        const centerX = wrapper.clientWidth / 2;
        const centerY = wrapper.clientHeight / 2;
        
        board.style.left = (centerX - (worldX * currentScale)) + 'px';
        board.style.top = (centerY - (worldY * currentScale)) + 'px';
        
        updateMinimap(); // å³æ™‚æ›´æ–°
        saveData();
    }

    // é€²æ—ãƒãƒ¼æ›´æ–°é–¢æ•°ï¼ˆä¿®æ­£ç‰ˆï¼‰
    function updateNoteProgress(note) {
        if (!note) return; // å®‰å…¨ç­–
        const content = note.querySelector('.note-content');
        if (!content) return;

        const checkboxes = content.querySelectorAll('input[type="checkbox"]');
        const total = checkboxes.length;
        
        const barContainer = note.querySelector('.progress-bar-container');
        const barFill = note.querySelector('.progress-bar-fill');
        
        if (total === 0) {
            if(barContainer) barContainer.style.display = 'none';
            return;
        }

        let checked = 0;
        checkboxes.forEach(cb => {
            if (cb.checked) checked++;
            // â˜…å‰Šé™¤: ã“ã“ã§ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²ã¯å»ƒæ­¢
        });

        const percent = Math.round((checked / total) * 100);
        if(barContainer) barContainer.style.display = 'block';
        if(barFill) {
            barFill.style.width = percent + '%';
            barFill.style.backgroundColor = (percent === 100) ? '#1e7e34' : '#28a745';
        }
    }

    function toggleLaserMode() {
        isLaserMode = !isLaserMode;
        const btn = document.getElementById('laser-btn');
        
        if (isLaserMode) {
            document.body.classList.add('laser-mode');
            btn.classList.add('active');
            btn.style.background = 'rgba(255,0,0,0.1)';
            
            // ãƒã‚¦ã‚¹ç§»å‹•ã‚¤ãƒ™ãƒ³ãƒˆã‚’é–‹å§‹
            window.addEventListener('mousemove', createLaserTrail);
        } else {
            document.body.classList.remove('laser-mode');
            btn.classList.remove('active');
            btn.style.background = '';
            
            // ãƒã‚¦ã‚¹ç§»å‹•ã‚¤ãƒ™ãƒ³ãƒˆã‚’è§£é™¤
            window.removeEventListener('mousemove', createLaserTrail);
        }
    }

    // è»Œè·¡ç”Ÿæˆé–¢æ•°
    function createLaserTrail(e) {
        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹èª¿æ•´: ã‚ã¾ã‚Šé »ç¹ã«ç”Ÿæˆã—ã™ããªã„ï¼ˆå¿…è¦ãªã‚‰é–“å¼•ãå‡¦ç†ã‚’å…¥ã‚Œã‚‹ï¼‰
        
        const trail = document.createElement('div');
        trail.className = 'laser-trail';
        trail.style.left = (e.clientX - 5) + 'px'; // ä¸­å¿ƒã«åˆã‚ã›ã‚‹
        trail.style.top = (e.clientY - 5) + 'px';
        
        document.body.appendChild(trail);

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«å‰Šé™¤ (CSS animation: 0.5s ã¨é€£å‹•)
        setTimeout(() => {
            trail.remove();
        }, 500);
    }
        // 1. ãƒªãƒ³ã‚¯ä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãï¼ˆä¿®æ­£ç‰ˆï¼‰
    function openLinkPicker(e) {
        if(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        // ç·¨é›†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹
        editorCtxMenu.style.display = 'none';

        const sel = window.getSelection();
        
        // ç¾åœ¨é¸æŠä¸­ãªã‚‰ãã‚Œã‚’ä¿å­˜ã€ãªã‘ã‚Œã°å³ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ä¿å­˜ã—ãŸã‚‚ã®ã‚’ä½¿ç”¨
        if (sel.rangeCount > 0 && sel.toString().length > 0) {
            savedSelectionRange = sel.getRangeAt(0).cloneRange();
        } else if (!savedSelectionRange) {
            alert('ãƒªãƒ³ã‚¯ã«ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠã€ã¾ãŸã¯ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã‚’æŒ‡å®šã—ã¦ãã ã•ã„');
            return;
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
        const modal = document.getElementById('link-picker-modal');
        modal.style.display = 'flex';
        switchLinkTab('sheet');
    }

    // 2. ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    function switchLinkTab(type) {
        document.getElementById('tab-link-sheet').classList.toggle('active', type === 'sheet');
        document.getElementById('tab-link-note').classList.toggle('active', type === 'note');
        document.getElementById('link-sheet-container').style.display = type === 'sheet' ? 'block' : 'none';
        document.getElementById('link-note-container').style.display = type === 'note' ? 'block' : 'none';

        if (type === 'sheet') renderLinkSheetList();
        if (type === 'note') {
            document.getElementById('link-note-search').value = '';
            document.getElementById('link-note-list').innerHTML = '<div style="padding:10px; color:#999; text-align:center;">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>';
            document.getElementById('link-note-search').focus();
        }
    }

    // 3. ã‚·ãƒ¼ãƒˆä¸€è¦§æç”»
    function renderLinkSheetList() {
        const list = document.getElementById('link-sheet-list');
        list.innerHTML = '';
        
        appData.folders.forEach(f => {
            const folderSheets = appData.sheets.filter(s => s.folderId === f.id);
            if (folderSheets.length === 0) return;

            // ãƒ•ã‚©ãƒ«ãƒ€åãƒ˜ãƒƒãƒ€ãƒ¼
            const header = document.createElement('div');
            header.style.padding = '5px 8px';
            header.style.background = 'rgba(0,0,0,0.05)';
            header.style.fontWeight = 'bold';
            header.style.fontSize = '12px';
            header.innerText = `ğŸ“‚ ${f.name}`;
            list.appendChild(header);

            folderSheets.forEach(s => {
                const item = document.createElement('div');
                item.className = 'link-target-item';
                item.innerHTML = `<span class="link-target-name">ğŸ“„ ${s.name}</span>`;
                item.onclick = () => insertInternalLink('sheet', s.id, s.name);
                list.appendChild(item);
            });
        });
    }

    // 4. ä»˜ç®‹æ¤œç´¢ãƒ»ä¸€è¦§æç”»
    function searchLinkNotes() {
        const kw = document.getElementById('link-note-search').value.toLowerCase();
        const list = document.getElementById('link-note-list');
        list.innerHTML = '';

        if (!kw) return;

        let count = 0;
        appData.sheets.forEach(s => {
            if (!s.data || !s.data.notes) return;
            s.data.notes.forEach(n => {
                // HTMLã‚¿ã‚°ã‚’é™¤å»ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ã§æ¤œç´¢
                const text = n.contentHTML.replace(/<[^>]*>/g, '');
                if (text.toLowerCase().includes(kw)) {
                    if (count > 20) return; // è¡¨ç¤ºæ•°åˆ¶é™
                    const item = document.createElement('div');
                    item.className = 'link-target-item';
                    item.innerHTML = `
                        <span class="link-target-name">${text.substring(0, 30)}...</span>
                        <span class="link-target-detail">ğŸ“„ ${s.name} å†…</span>
                    `;
                    item.onclick = () => insertInternalLink('note', n.id, text.substring(0, 10), s.id);
                    list.appendChild(item);
                    count++;
                }
            });
        });

        if (count === 0) list.innerHTML = '<div style="padding:8px;">è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</div>';
    }

    // 5. ãƒªãƒ³ã‚¯æŒ¿å…¥å®Ÿè¡Œ
    function insertInternalLink(type, targetId, label, sheetId = null) {
        document.getElementById('link-picker-modal').style.display = 'none';
        
        // é¸æŠç¯„å›²ã‚’å¾©å…ƒ
        const sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(savedSelectionRange);

        // é¸æŠã•ã‚Œã¦ã„ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—ï¼ˆç©ºãªã‚‰ãƒ©ãƒ™ãƒ«ã‚’ä½¿ç”¨ï¼‰
        let selectedText = sel.toString();
        if (!selectedText) {
            selectedText = label || (type === 'sheet' ? 'ã‚·ãƒ¼ãƒˆã¸ã®ãƒªãƒ³ã‚¯' : 'ä»˜ç®‹ã¸ã®ãƒªãƒ³ã‚¯');
        }

        // aã‚¿ã‚°ã‚’ä½œæˆ
        const a = document.createElement('a');
        a.className = 'internal-link';
        a.href = '#';
        a.dataset.linkType = type;
        a.dataset.targetId = targetId;
        if (sheetId) a.dataset.sheetId = sheetId;
        
        a.textContent = selectedText; // â˜…ä¿®æ­£: ãƒ†ã‚­ã‚¹ãƒˆã‚’ãã®ã¾ã¾è¨­å®š

        // æŒ¿å…¥
        savedSelectionRange.deleteContents();
        savedSelectionRange.insertNode(a);

        // å±¥æ­´ä¿å­˜
        saveData();
    }

    // 6. ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‹•ä½œï¼ˆã‚¤ãƒ™ãƒ³ãƒˆå§”è­²ï¼‰
    // note-contentå†…ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã§å‡¦ç†ã—ã¾ã™
    document.addEventListener('click', (e) => {
        // å†…éƒ¨ãƒªãƒ³ã‚¯ã‹åˆ¤å®š
        if (e.target.classList.contains('internal-link')) {
            e.preventDefault();
            e.stopPropagation();

            const type = e.target.dataset.linkType;
            const targetId = e.target.dataset.targetId;
            const sheetId = e.target.dataset.sheetId;

            if (type === 'sheet') {
                // ã‚·ãƒ¼ãƒˆã¸åˆ‡ã‚Šæ›¿ãˆ
                if (appData.currentSheetId !== targetId) {
                    loadSheet(targetId);
                }
                // ã‚ºãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆã—ã¦ä¸­å¤®ã¸
                resetView(); 
                
            } else if (type === 'note') {
                // ä»˜ç®‹ã¸ã‚¸ãƒ£ãƒ³ãƒ—
                // ã¾ãšå¯¾è±¡ã‚·ãƒ¼ãƒˆã‚’é–‹ã
                if (appData.currentSheetId !== sheetId) {
                    loadSheet(sheetId);
                }
                
                // å¯¾è±¡ä»˜ç®‹ã®åº§æ¨™ã‚’æ¢ã™
                const sheet = appData.sheets.find(s => s.id === sheetId);
                const noteData = sheet.data.notes.find(n => n.id === targetId);

                if (noteData) {
                    // æ¤œç´¢ã‚¸ãƒ£ãƒ³ãƒ—æ©Ÿèƒ½(jumpToResult)ã‚’å†åˆ©ç”¨
                    jumpToResult(sheetId, targetId, parseFloat(noteData.left), parseFloat(noteData.top));
                } else {
                    alert('å¯¾è±¡ã®ä»˜ç®‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸï¼ˆå‰Šé™¤ã•ã‚ŒãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼‰');
                }
            }
        }
    });

        // --- ç·¨é›†ç”¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼åˆ¶å¾¡ ---
    const editorCtxMenu = document.getElementById('editor-context-menu');

    // å…±é€šã®å³ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ä¿®æ­£
    window.addEventListener('contextmenu', (e) => {
        // æ—¢å­˜ã®åˆ¶å¾¡ï¼ˆãƒ¢ãƒ¼ãƒ‰ä¸­ãªã©ã¯ç„¡åŠ¹ï¼‰
        if (preventContextMenu || isLassoSelecting || isConnectMode || isDrawMode || isEraserMode) {
            e.preventDefault();
            // ... (ãƒ¢ãƒ¼ãƒ‰è§£é™¤å‡¦ç†)
            return;
        }

        // â˜…è¿½åŠ : ä»˜ç®‹ã®ãƒ†ã‚­ã‚¹ãƒˆç·¨é›†ä¸­ï¼ˆcontenteditable=trueï¼‰ã®å ´åˆ
        if (e.target.isContentEditable || e.target.closest('[contenteditable="true"]')) {
            e.preventDefault();
            
            // é¸æŠç¯„å›²ã‚’ä¿å­˜ã—ã¦ãŠãï¼ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼æ“ä½œå¾Œã«å¾©å…ƒã™ã‚‹ãŸã‚ï¼‰
            const sel = window.getSelection();
            if (sel.rangeCount > 0) {
                savedSelectionRange = sel.getRangeAt(0).cloneRange();
            } else {
                // ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã ã‘ã§ã‚‚ä¿å­˜
                // (å®Ÿè£…ä¾å­˜: ã‚¯ãƒªãƒƒã‚¯ä½ç½®ã«ã‚­ãƒ£ãƒ¬ãƒƒãƒˆã‚’ç§»å‹•ã•ã›ã‚‹å‡¦ç†ãŒå¿…è¦ã‹ã‚‚)
            }

            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º
            editorCtxMenu.style.display = 'block';
            editorCtxMenu.style.left = e.clientX + 'px';
            editorCtxMenu.style.top = e.clientY + 'px';
            
            // ä»–ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹
            closePopups();
            return;
        }
        
        // ãƒ†ã‚­ã‚¹ãƒˆç·¨é›†ä¸­ã§ãªã‘ã‚Œã°ã€æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼å‡¦ç†ã¸...
    });

    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹å‡¦ç†ã« editorCtxMenu ã‚’è¿½åŠ 
    document.addEventListener('mousedown', (e) => {
        if (editorCtxMenu.style.display === 'block') {
            if (!e.target.closest('#editor-context-menu')) {
                editorCtxMenu.style.display = 'none';
            }
        }
        // ... (æ—¢å­˜ã®å‡¦ç†)
    }, true);
    
    // closePopupsé–¢æ•°ã«ã‚‚è¿½åŠ 
    // (æ—¢å­˜ã® function closePopups() å†…ã«è¿½è¨˜ã—ã¦ãã ã•ã„)
    // editorCtxMenu.style.display = 'none';

    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ (Lã‚­ãƒ¼ã§ãƒˆã‚°ãƒ«)
    document.addEventListener('keydown', (e) => {
        // ... æ—¢å­˜å‡¦ç† ...
        
        // ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ä¸­ã§ãªã‘ã‚Œã° Lã‚­ãƒ¼ ã§ON/OFF
        const activeEl = document.activeElement;
        const isEditing = activeEl.classList.contains('note-content') || activeEl.tagName === 'INPUT';
        
        if (e.key.toLowerCase() === 'l' && !isEditing && !e.ctrlKey && !e.metaKey) {
            toggleLaserMode();
        }
    });

        // â˜…è¿½åŠ : ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å¤‰æ›´ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ç›£è¦–ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆå§”è­²ï¼‰
    document.addEventListener('change', (e) => {
        // å¤‰æ›´ã•ã‚ŒãŸã®ãŒãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§ã‚ã‚Šã€ã‹ã¤ä»˜ç®‹ã®ä¸­ã«ã‚ã‚‹å ´åˆ
        if (e.target.tagName === 'INPUT' && e.target.type === 'checkbox') {
            const note = e.target.closest('.note');
            if (note) {
                // é€²æ—ãƒãƒ¼ã‚’æ›´æ–°
                updateNoteProgress(note);
                // ãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼ˆãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã‚’HTMLã«åæ˜ ã•ã›ã‚‹ãŸã‚ã€checkedå±æ€§ã‚’ã‚»ãƒƒãƒˆï¼‰
                if (e.target.checked) {
                    e.target.setAttribute('checked', 'checked');
                } else {
                    e.target.removeAttribute('checked');
                }
                saveData();
            }
        }
    });
    
    document.addEventListener('mousedown', (e) => {
        
        // ãƒ©ãƒ™ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒé–‹ã„ã¦ã„ã‚‹å ´åˆã®åˆ¤å®š
        if (labelMenu.style.display === 'block') {
            // ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´æ‰€ãŒã€Œãƒ¡ãƒ‹ãƒ¥ãƒ¼æœ¬ä½“ã€ã§ã‚‚ã€Œé–‹ããƒœã‚¿ãƒ³ã€ã§ã‚‚ãªã„å ´åˆ
            if (!e.target.closest('#label-menu') && !e.target.closest('.label-toggle')) {
                labelMenu.style.display = 'none';
            }
        }

        // ã‚¹ã‚¿ãƒ³ãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒé–‹ã„ã¦ã„ã‚‹å ´åˆã®åˆ¤å®š
        if (stampMenu.style.display === 'grid') { // ã‚¹ã‚¿ãƒ³ãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ display: grid ã‚’ä½¿ç”¨
            // ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´æ‰€ãŒã€Œãƒ¡ãƒ‹ãƒ¥ãƒ¼æœ¬ä½“ã€ã§ã‚‚ã€Œé–‹ããƒœã‚¿ãƒ³ã€ã§ã‚‚ãªã„å ´åˆ
            if (!e.target.closest('#stamp-menu') && !e.target.closest('.stamp-toggle')) {
                stampMenu.style.display = 'none';
            }
        }
        
    }, true);

	/*---------------------------spaceï¼‹ãƒ‰ãƒ©ãƒƒã‚°ã§ã©ã“ã§ã‚‚ç§»å‹•-------------------------------*/
	document.addEventListener("keydown", (e) => {
	  if (e.code === "Space") {
	    isSpacePressed = true;
	    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æŠ‘æ­¢ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã§ãƒšãƒ¼ã‚¸ãŒå‹•ã‹ãªã„ã‚ˆã†ã«ï¼‰
	    e.preventDefault();
	  }
	});

	document.addEventListener("keyup", (e) => {
	  if (e.code === "Space") isSpacePressed = false;
	});
	
	wrapper.addEventListener("mousedown", (e) => {

	  // SPACE + å·¦ãƒ‰ãƒ©ãƒƒã‚° â†’ ã©ã“ã§ã‚‚ç”»é¢ç§»å‹•
	  if (isSpacePressed && e.button === 0) {

	    const sx = e.clientX;
	    const sy = e.clientY;
	    const sl = parseFloat(board.style.left) || 0;
	    const st = parseFloat(board.style.top) || 0;

	    const onMove = (mv) => {
	      board.style.left = sl + (mv.clientX - sx) + "px";
	      board.style.top  = st + (mv.clientY - sy) + "px";
	    };

	    const onUp = () => {
	      window.removeEventListener("mousemove", onMove);
	      window.removeEventListener("mouseup", onUp);
	      saveData();
	    };

	    window.addEventListener("mousemove", onMove);
	    window.addEventListener("mouseup", onUp);

	    e.preventDefault();
	    e.stopPropagation();
	    return;
	  }

	  // æ—¢å­˜å‡¦ç† â†“ï¼ˆãã®ã¾ã¾ï¼‰
	});

	/*---------------------------------------------------------------------------------------*/
    
    window.onload = () => { init(); initMinimap(); };
</script>
</body>
</html>