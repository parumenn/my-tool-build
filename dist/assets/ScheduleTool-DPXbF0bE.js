import{c as le,r as c,a3 as Se,j as e,m as ze,a4 as Te,f as $e,X as u,P as X,a as Q,a6 as Ee,Z as De,g as Pe}from"./index-Cyzvhpf6.js";import{W as _e}from"./WorkspaceContext-CBN8AZtq.js";import{S as I}from"./settings-DjdEWhkh.js";import{a as Oe,C as Me}from"./chevron-left-D-e792aY.js";import{C as ee}from"./circle-Bb8du6b8.js";import{I as te}from"./info-CQJrlyVG.js";import{L as Ae}from"./link-BfbsF1qo.js";import{L as Le}from"./lock-CDqXCDif.js";import{T as Ue}from"./trash-2-CgNqYqnN.js";import{C as ae}from"./chevron-right-BDEkWnKK.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=le("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]),Qe=()=>{const z=c.useContext(_e),[M]=Se(),h=M.get("id"),w=M.get("token"),[T,de]=c.useState(""),[A,ne]=c.useState(""),[L,oe]=c.useState(""),[U,ie]=c.useState(""),[m,j]=c.useState([{id:"p1",type:"date",title:"日程候補",candidates:[]}]),[R,J]=c.useState(new Date),[y,B]=c.useState({start:"19:00",end:"21:00"}),[v,ce]=c.useState(!0),[o,W]=c.useState(null),[$,p]=c.useState(!1),[Re,xe]=c.useState(""),[N,F]=c.useState(w),[ge,E]=c.useState(!1),[H,Y]=c.useState(""),[be,k]=c.useState(!1),[i,x]=c.useState(null),[me,D]=c.useState(!1),[f,P]=c.useState({name:"",comment:""}),[C,_]=c.useState({}),[Je,Be]=c.useState(""),[he,q]=c.useState(!1);c.useEffect(()=>{h?O():W(null)},[h]),c.useEffect(()=>{w&&F(w)},[w]);const O=async()=>{p(!0);try{const t=await fetch(`./backend/schedule_api.php?action=get&id=${h}`);if(!t.ok)throw new Error("イベントが見つかりません");const r=await t.json();r.polls&&(r.polls=r.polls.map(a=>({...a,candidates:a.candidates.map(s=>typeof s=="string"?{name:s,note:""}:s)}))),W(r)}catch(t){xe(t.message)}finally{p(!1)}},S=(t,r,a="",s=j,n=m)=>{const d=[...n];d[t].candidates.some(l=>l.name===r)||(d[t].candidates.push({name:r,note:a}),d[t].type==="date"&&d[t].candidates.sort((l,g)=>new Date(l.name.split(" ")[0]).getTime()-new Date(g.name.split(" ")[0]).getTime()),s(d))},Z=(t,r,a=j,s=m)=>{const n=[...s];n[t].candidates.splice(r,1),a(n)},ye=(t,r,a,s)=>{const n=`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} (${["日","月","火","水","木","金","土"][t.getDay()]})`,d=v?`${n} ${y.start}〜${y.end}`:n;S(r,d,"",a,s)},pe=async()=>{if(!T.trim()){alert("イベント名を入力してください");return}if(m[0].candidates.length===0){alert("日程候補を少なくとも1つ選択してください");return}p(!0);try{const r=await(await fetch("./backend/schedule_api.php?action=create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:T,description:A,deadline:L,polls:m,password:U})})).json();if(r.status==="success"){const a=window.location.href.split("?")[0];window.location.href=`${a}?id=${r.id}&token=${r.admin_token}`}}catch{alert("作成に失敗しました")}finally{p(!1)}},ue=async()=>{if(o){if(N){k(!0),x(JSON.parse(JSON.stringify(o)));return}if(!o.has_password){G("");return}E(!0)}},G=async t=>{try{const a=await(await fetch("./backend/schedule_api.php?action=auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,password:t})})).json();a.status==="success"?(F(a.admin_token),E(!1),Y(""),k(!0),x(JSON.parse(JSON.stringify(o)))):alert(a.error||"認証に失敗しました")}catch{alert("通信エラーが発生しました")}},fe=(t,r)=>{if(!i)return;const a=[...i.polls],s=`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} (${["日","月","火","水","木","金","土"][t.getDay()]})`,n=v?`${s} ${y.start}〜${y.end}`:s;a[r].candidates.some(d=>d.name===n)||(a[r].candidates.push({name:n,note:""}),a[r].candidates.sort((d,l)=>new Date(d.name.split(" ")[0]).getTime()-new Date(l.name.split(" ")[0]).getTime()),x({...i,polls:a}))},K=(t,r)=>{if(!i)return;const a=[...i.polls];a[t].candidates.splice(r,1),x({...i,polls:a})},je=async()=>{if(!(!i||!N)){if(!i.title.trim()){alert("タイトルは必須です");return}p(!0);try{(await fetch("./backend/schedule_api.php?action=update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,token:N,title:i.title,description:i.description,deadline:i.deadline,polls:i.polls})})).ok?(alert("イベントを更新しました"),k(!1),O()):alert("更新に失敗しました")}catch{alert("通信エラー")}finally{p(!1)}}},ke=async()=>{if(confirm(`本当にこのイベントを削除しますか？
この操作は取り消せません。`))try{await fetch("./backend/schedule_api.php?action=delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,token:N})});const t=window.location.href.split("?")[0];window.location.href=t}catch{alert("削除失敗")}},we=()=>{if(!o)return;const t={};o.polls.forEach(r=>{t[r.id]=r.candidates.map(()=>({status:2,comment:""}))}),_(t),P({name:"",comment:""}),D(!0)},ve=async()=>{if(!f.name.trim()){alert("名前を入力してください");return}p(!0);try{(await fetch("./backend/schedule_api.php?action=answer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:h,name:f.name,comment:f.comment,selections:C})})).ok?(D(!1),O()):alert("保存に失敗しました")}catch{alert("通信エラー")}finally{p(!1)}},Ne=(t,r)=>{const a=t.candidates[r];try{const s=a.name.split(" ")[0],n=a.name.match(/(\d{1,2}:\d{2})/g);let d=s.replace(/\//g,"")+"T000000",l=s.replace(/\//g,"")+"T235959";if(n&&n.length>=1)if(d=s.replace(/\//g,"")+"T"+n[0].replace(":","")+"00",n.length>=2)l=s.replace(/\//g,"")+"T"+n[1].replace(":","")+"00";else{const b=new Date(s+" "+n[0]);b.setHours(b.getHours()+1),l=b.getFullYear()+String(b.getMonth()+1).padStart(2,"0")+String(b.getDate()).padStart(2,"0")+"T"+String(b.getHours()).padStart(2,"0")+String(b.getMinutes()).padStart(2,"0")+"00"}const g=`https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent((o==null?void 0:o.title)||"予定")}&dates=${d}/${l}&details=${encodeURIComponent((o==null?void 0:o.description)||"")}`;window.open(g,"_blank")}catch{alert("日時形式の解析に失敗しました")}},Ce=t=>t.startsWith("http://")||t.startsWith("https://"),V=({onSelect:t})=>{const r=R.getFullYear(),a=R.getMonth(),s=new Date(r,a,1).getDay(),n=new Date(r,a+1,0).getDate(),d=[];for(let l=0;l<s;l++)d.push(null);for(let l=1;l<=n;l++)d.push(new Date(r,a,l));return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("button",{onClick:()=>J(new Date(r,a-1,1)),className:"p-1 text-gray-600 dark:text-gray-300",children:e.jsx(Me,{size:20})}),e.jsxs("span",{className:"font-bold text-sm text-gray-800 dark:text-white",children:[r,"年 ",a+1,"月"]}),e.jsx("button",{onClick:()=>J(new Date(r,a+1,1)),className:"p-1 text-gray-600 dark:text-gray-300",children:e.jsx(ae,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center mb-1 text-[10px] font-bold text-gray-500",children:[e.jsx("div",{className:"text-red-500",children:"日"}),e.jsx("div",{children:"月"}),e.jsx("div",{children:"火"}),e.jsx("div",{children:"水"}),e.jsx("div",{children:"木"}),e.jsx("div",{children:"金"}),e.jsx("div",{className:"text-blue-500",children:"土"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:d.map((l,g)=>e.jsx("button",{disabled:!l,onClick:()=>l&&(t==null?void 0:t(l)),className:`aspect-square rounded-md flex items-center justify-center text-xs font-bold transition-all ${l?"bg-white dark:bg-gray-700 hover:bg-teal-100 dark:hover:bg-teal-900/50 shadow-sm text-gray-700 dark:text-gray-200":"invisible"}`,children:l==null?void 0:l.getDate()},g))}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold mb-2 cursor-pointer text-gray-600 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:l=>ce(l.target.checked),className:"rounded text-teal-600 focus:ring-teal-500"}),"時間を指定"]}),v&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"time",value:y.start,onChange:l=>B({...y,start:l.target.value}),className:"p-1.5 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full"}),e.jsx("span",{className:"text-gray-400",children:"~"}),e.jsx("input",{type:"time",value:y.end,onChange:l=>B({...y,end:l.target.value}),className:"p-1.5 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full"})]})]})]})};return h?$&&!o?e.jsxs("div",{className:"p-10 text-center",children:[e.jsx("div",{className:"animate-spin text-teal-500 text-4xl mx-auto mb-4",children:"C"}),"読み込み中..."]}):o?e.jsxs("div",{className:`mx-auto max-w-5xl pb-20 ${z?"p-2":"space-y-6"}`,children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-10 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-black text-gray-800 dark:text-white mb-2",children:o.title}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs md:text-sm whitespace-pre-wrap",children:o.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>{const t=window.location.href.split("&token")[0];navigator.clipboard.writeText(t),q(!0),setTimeout(()=>q(!1),2e3)},className:"flex items-center gap-2 px-4 py-2 bg-teal-100 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300 rounded-xl font-bold text-xs hover:bg-teal-200 transition-colors",children:[he?e.jsx(ze,{size:14}):e.jsx(Te,{size:14})," URLコピー"]}),e.jsxs("button",{onClick:ue,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-xl font-bold text-xs hover:bg-gray-200 transition-colors",children:[e.jsx(I,{size:14})," 幹事メニュー"]})]})]}),o.deadline&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-full text-[10px] font-bold mb-6",children:[e.jsx($e,{size:12})," 期限: ",o.deadline.replace("T"," ")]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-2xl relative max-h-[60vh]",children:e.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[e.jsxs("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0 z-20 shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 min-w-[120px] border-b border-r dark:border-gray-700 sticky left-0 bg-gray-50 dark:bg-gray-800 z-30 font-bold text-xs shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"参加者 / 候補"}),o.polls[0].candidates.map((t,r)=>e.jsxs("th",{className:"p-2 min-w-[100px] border-b border-r dark:border-gray-700 font-bold text-center relative group text-xs whitespace-normal",children:[e.jsx("div",{className:"text-gray-800 dark:text-white px-1",children:t.name}),t.note&&e.jsx("div",{className:"text-[10px] text-gray-500 font-normal mt-1 truncate",children:t.note}),e.jsx("button",{onClick:()=>Ne(o.polls[0],r),className:"absolute top-0 right-0 opacity-0 group-hover:opacity-100 text-gray-400 hover:text-blue-500 p-1",children:e.jsx(Oe,{size:12})})]},r))]}),e.jsxs("tr",{className:"bg-teal-50 dark:bg-teal-900/20",children:[e.jsx("th",{className:"p-2 border-b border-r border-teal-100 dark:border-teal-900 sticky left-0 bg-teal-50 dark:bg-teal-900/20 z-30 text-teal-800 dark:text-teal-200 font-bold text-right text-xs shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"回答"}),o.polls[0].candidates.map((t,r)=>{let a=0,s=0;return o.answers.forEach(n=>{var l,g;const d=(g=(l=n.selections[o.polls[0].id])==null?void 0:l[r])==null?void 0:g.status;d===2?a++:d===1&&s++}),e.jsxs("td",{className:"p-2 border-b border-r border-teal-100 dark:border-teal-900 text-center font-bold text-teal-700 dark:text-teal-300 text-xs",children:["〇",a," / △",s]},r)})]})]}),e.jsx("tbody",{children:o.answers.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:o.polls[0].candidates.length+1,className:"p-8 text-center text-gray-400 text-xs",children:"まだ回答がありません"})}):o.answers.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsxs("td",{className:"p-3 border-b border-r dark:border-gray-700 sticky left-0 bg-white dark:bg-dark-lighter z-10 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:[e.jsx("div",{className:"font-bold text-gray-800 dark:text-gray-200 text-xs",children:t.name}),t.comment&&e.jsxs("div",{className:"text-[10px] text-gray-500 mt-0.5 flex items-center gap-1",children:[e.jsx(re,{size:8})," ",t.comment]})]}),o.polls[0].candidates.map((r,a)=>{var l;const s=(l=t.selections[o.polls[0].id])==null?void 0:l[a],n=s==null?void 0:s.status,d=s==null?void 0:s.comment;return e.jsx("td",{className:"p-2 border-b border-r dark:border-gray-700 text-center relative group",children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[n===2?e.jsx(ee,{className:"text-red-500 fill-red-50 dark:fill-red-900/30",size:18}):n===1?e.jsx(se,{className:"text-yellow-500 fill-yellow-50 dark:fill-yellow-900/30",size:18}):e.jsx(u,{className:"text-gray-300",size:18}),d&&e.jsx("div",{className:"absolute bottom-0 right-0 text-gray-400",children:e.jsx(re,{size:10,className:"text-blue-400"})}),d&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-32 bg-gray-900 text-white text-[10px] rounded p-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-40",children:d})]})},a)})]},t.id))})]})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("button",{onClick:we,className:"bg-teal-600 text-white px-8 py-3 rounded-full font-black text-sm md:text-base shadow-xl hover:bg-teal-700 hover:scale-105 transition-all flex items-center justify-center gap-2 mx-auto",children:[e.jsx(X,{strokeWidth:3,size:18})," 出欠を入力する"]})})]}),o.polls.length>1&&o.polls.slice(1).map(t=>e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(te,{className:"text-blue-500",size:18})," ",t.title]}),e.jsx("div",{className:"space-y-3",children:t.candidates.map((r,a)=>{let s=0,n=0;return o.answers.forEach(d=>{var g,b;const l=(b=(g=d.selections[t.id])==null?void 0:g[a])==null?void 0:b.status;l===2?s++:l===1&&n++}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 gap-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm text-gray-700 dark:text-gray-200",children:r.name}),r.note&&(Ce(r.note)?e.jsxs("a",{href:r.note,target:"_blank",rel:"noreferrer",className:"text-[10px] text-blue-500 hover:underline break-all flex items-center gap-1 mt-1",children:[e.jsx(Ae,{size:10})," ",r.note]}):e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1",children:r.note}))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500",children:"回答:"}),e.jsxs("span",{className:"text-sm font-black text-teal-600 dark:text-teal-400",children:["〇",s," / △",n]})]})]},a)})})]},t.id)),me&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-2xl max-h-[90vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white",children:"出欠を入力"}),e.jsx("button",{onClick:()=>D(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(u,{size:20})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto flex-1 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500",children:["お名前 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:f.name,onChange:t=>P({...f,name:t.target.value}),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-bold text-base focus:border-teal-500 outline-none",placeholder:"山田 太郎"})]}),o.polls.map(t=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-bold text-sm text-gray-700 dark:text-gray-300 border-l-4 border-teal-500 pl-2",children:t.title}),e.jsx("div",{className:"space-y-2",children:t.candidates.map((r,a)=>{var n;const s=((n=C[t.id])==null?void 0:n[a])||{status:1,comment:""};return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 p-2 rounded-xl bg-gray-50 dark:bg-gray-700/50 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-xs text-gray-800 dark:text-white",children:r.name}),r.note&&e.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[200px]",children:r.note})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex bg-white dark:bg-gray-800 rounded-lg p-1 border dark:border-gray-600 shadow-sm shrink-0",children:[{val:2,icon:ee,color:"text-red-500"},{val:1,icon:se,color:"text-yellow-500"},{val:0,icon:u,color:"text-gray-400"}].map(d=>e.jsx("button",{onClick:()=>{const l={...C};l[t.id][a]={...s,status:d.val},_(l)},className:`p-1.5 rounded-md transition-all ${s.status===d.val?"bg-gray-100 dark:bg-gray-600 "+d.color:"text-gray-300"}`,children:e.jsx(d.icon,{size:18,fill:s.status===d.val?"currentColor":"none",fillOpacity:.2})},d.val))}),e.jsx("input",{type:"text",placeholder:"コメント",value:s.comment,onChange:d=>{const l={...C};l[t.id][a]={...s,comment:d.target.value},_(l)},className:"flex-1 sm:w-32 p-2 rounded-lg border dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-xs"})]})]},a)})})]},t.id)),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"全体コメント"}),e.jsx("textarea",{value:f.comment,onChange:t=>P({...f,comment:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm h-20",placeholder:"遅れる可能性があります、等"})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900",children:e.jsx("button",{onClick:ve,className:"w-full py-3 bg-teal-600 text-white font-black rounded-xl shadow-lg hover:bg-teal-700 transition-all text-sm",children:"回答を保存する"})})]})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-sm rounded-3xl shadow-2xl p-6 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-white mb-4",children:"幹事ログイン"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"このイベントにはパスワードが設定されています。"}),e.jsx("input",{type:"password",value:H,onChange:t=>Y(t.target.value),className:"w-full p-3 mb-4 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"パスワード"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>E(!1),className:"flex-1 py-2 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-xl font-bold text-sm",children:"キャンセル"}),e.jsx("button",{onClick:()=>G(H),className:"flex-1 py-2 bg-teal-600 text-white rounded-xl font-bold text-sm",children:"認証"})]})]})}),be&&i&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-2xl max-h-[90vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900",children:[e.jsxs("h3",{className:"font-bold text-lg text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(I,{size:18})," 幹事用メニュー"]}),e.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(u,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"イベント名"}),e.jsx("input",{type:"text",value:i.title,onChange:t=>x({...i,title:t.target.value}),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"詳細 / メモ"}),e.jsx("textarea",{value:i.description,onChange:t=>x({...i,description:t.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm h-20 resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"回答期限"}),e.jsx("input",{type:"datetime-local",value:i.deadline||"",onChange:t=>x({...i,deadline:t.target.value}),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"})]})]}),e.jsx("hr",{className:"border-gray-100 dark:border-gray-800"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-bold text-base text-gray-700 dark:text-gray-300",children:"アンケート項目の編集"}),i.polls.map((t,r)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-xl border border-gray-100 dark:border-gray-700",children:[e.jsx("input",{type:"text",value:t.title,onChange:a=>{const s=[...i.polls];s[r].title=a.target.value,x({...i,polls:s})},className:"w-full bg-transparent border-b border-gray-300 dark:border-gray-600 py-1 font-bold text-base focus:border-teal-500 outline-none text-gray-800 dark:text-white mb-3"}),t.type==="date"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 p-2 rounded-xl border border-gray-200 dark:border-gray-600",children:e.jsx(V,{onSelect:a=>fe(a,r)})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase mb-2 block",children:"現在の候補"}),e.jsxs("div",{className:"space-y-1.5 max-h-40 overflow-y-auto pr-1 custom-scrollbar",children:[t.candidates.map((a,s)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsx("span",{className:"font-mono font-bold text-sm text-gray-700 dark:text-gray-200",children:a.name}),e.jsx("button",{onClick:()=>K(r,s),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(u,{size:14})})]},s)),t.candidates.length===0&&e.jsx("div",{className:"text-gray-400 text-xs p-2 text-center",children:"カレンダーの日付をクリックして追加"})]})]})]}):e.jsxs("div",{className:"space-y-2",children:[t.candidates.map((a,s)=>e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 bg-white dark:bg-gray-700 p-2 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsx("input",{type:"text",value:a.name,onChange:n=>{const d=[...i.polls];d[r].candidates[s].name=n.target.value,x({...i,polls:d})},className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"候補名"}),e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsx("input",{type:"text",value:a.note,onChange:n=>{const d=[...i.polls];d[r].candidates[s].note=n.target.value,x({...i,polls:d})},className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"備考・URL"}),e.jsx("button",{onClick:()=>K(r,s),className:"text-gray-400 hover:text-red-500 p-2",children:e.jsx(u,{size:16})})]})]},s)),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-2 bg-white dark:bg-gray-700 p-2 rounded-lg border border-dashed border-gray-300 dark:border-gray-600",children:[e.jsx("input",{type:"text",id:`new-cand-name-${r}`,className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"新しい候補名"}),e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsx("input",{type:"text",id:`new-cand-note-${r}`,className:"flex-1 p-2 rounded border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-sm",placeholder:"備考・URL"}),e.jsx("button",{onClick:()=>{const a=document.getElementById(`new-cand-name-${r}`),s=document.getElementById(`new-cand-note-${r}`);if(a.value){const n=[...i.polls];n[r].candidates.push({name:a.value,note:s.value}),x({...i,polls:n}),a.value="",s.value=""}},className:"px-3 bg-teal-600 text-white rounded text-xs font-bold whitespace-nowrap",children:"追加"})]})]})]})]},t.id))]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-red-500 font-bold mb-2",children:"危険な操作"}),e.jsx("button",{onClick:ke,className:"w-full py-3 bg-red-50 dark:bg-red-900/20 text-red-600 border border-red-200 dark:border-red-800 rounded-xl font-bold text-sm hover:bg-red-100 transition-colors",children:"イベントを削除する"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900 flex gap-4",children:[e.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors",children:"キャンセル"}),e.jsx("button",{onClick:je,className:"flex-1 py-3 bg-teal-600 text-white font-black rounded-xl shadow-lg hover:bg-teal-700 transition-all text-sm",children:"変更を保存"})]})]})}),!z&&e.jsx(Q,{})]}):e.jsx("div",{className:"p-10 text-center text-red-500",children:"イベントが見つかりません"}):e.jsxs("div",{className:"max-w-4xl mx-auto pb-20 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-3xl p-4 md:p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-black text-gray-800 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx(Ee,{className:"text-teal-600"}),"新規イベント作成"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:["イベント名 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:T,onChange:t=>de(t.target.value),className:"w-full p-3 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-bold text-base focus:border-teal-500 outline-none",placeholder:"例: 開発部 歓迎会"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"詳細 / メモ"}),e.jsx("textarea",{value:A,onChange:t=>ne(t.target.value),className:"w-full p-3 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm h-20 resize-none",placeholder:"場所や予算など..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"回答期限 (任意)"}),e.jsx("input",{type:"datetime-local",value:L,onChange:t=>oe(t.target.value),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"幹事用パスワード (任意)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{size:16,className:"text-gray-400"}),e.jsx("input",{type:"password",value:U,onChange:t=>ie(t.target.value),className:"w-full md:w-auto p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",placeholder:"編集・削除時に必要"})]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"設定しない場合、URLを知っている全員が編集可能になります。"})]})]}),e.jsx("hr",{className:"border-gray-100 dark:border-gray-800"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-base md:text-lg flex items-center gap-2",children:"アンケート設定"}),m.map((t,r)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-2xl border border-gray-100 dark:border-gray-700 relative",children:[r>0&&e.jsx("button",{onClick:()=>{const a=[...m];a.splice(r,1),j(a)},className:"absolute top-3 right-3 text-gray-400 hover:text-red-500",children:e.jsx(Ue,{size:16})}),e.jsxs("div",{className:"mb-4 pr-6",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"質問タイトル"}),e.jsx("input",{type:"text",value:t.title,onChange:a=>{const s=[...m];s[r].title=a.target.value,j(s)},className:"w-full bg-transparent border-b border-gray-300 dark:border-gray-600 py-1 font-bold text-base focus:border-teal-500 outline-none text-gray-800 dark:text-white"})]}),t.type==="date"?e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"shrink-0 w-full md:w-auto",children:e.jsx(V,{onSelect:a=>ye(a,r,j,m)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase mb-2",children:"選択された候補"}),e.jsxs("div",{className:"space-y-1.5 max-h-60 overflow-y-auto pr-1 custom-scrollbar",children:[t.candidates.map((a,s)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsx("span",{className:"font-mono font-bold text-sm text-gray-700 dark:text-gray-200",children:a.name}),e.jsx("button",{onClick:()=>Z(r,s),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(u,{size:14})})]},s)),t.candidates.length===0&&e.jsx("div",{className:"text-gray-400 text-xs p-4 text-center border-2 border-dashed border-gray-200 rounded-xl",children:"カレンダーの日付をクリックして追加"})]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-2 bg-white dark:bg-gray-700 p-3 rounded-xl border border-gray-100 dark:border-gray-600",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",id:`cand-input-${r}`,className:"flex-1 p-2 rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm",placeholder:"候補を入力 (例: イタリアン)",onKeyDown:a=>{if(a.key==="Enter"){const s=document.getElementById(`cand-note-${r}`);S(r,a.currentTarget.value,s.value),a.currentTarget.value="",s.value=""}}}),e.jsx("button",{onClick:()=>{const a=document.getElementById(`cand-input-${r}`),s=document.getElementById(`cand-note-${r}`);S(r,a.value,s.value),a.value="",s.value=""},className:"bg-teal-600 text-white px-3 py-1 rounded-lg font-bold text-xs",children:"追加"})]}),e.jsx("input",{type:"text",id:`cand-note-${r}`,className:"w-full p-2 rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-xs",placeholder:"備考・URL (任意)",onKeyDown:a=>{if(a.key==="Enter"){const s=document.getElementById(`cand-input-${r}`);S(r,s.value,a.currentTarget.value),s.value="",a.currentTarget.value=""}}})]}),e.jsx("div",{className:"space-y-1.5",children:t.candidates.map((a,s)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-bold text-sm text-gray-800 dark:text-gray-200 truncate",children:a.name}),a.note&&e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 truncate",children:a.note})]}),e.jsx("button",{onClick:()=>Z(r,s),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(u,{size:14})})]},s))})]})]},t.id)),e.jsxs("button",{onClick:()=>j([...m,{id:`p${Date.now()}`,type:"text",title:"お店・場所など",candidates:[]}]),className:"w-full py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-500 font-bold hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center justify-center gap-2 text-sm",children:[e.jsx(X,{size:16})," 別のアンケート項目を追加 (場所など)"]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:pe,disabled:$,className:"w-full py-4 bg-teal-600 text-white font-black text-lg rounded-2xl shadow-xl hover:bg-teal-700 transition-all flex items-center justify-center gap-2",children:[$?"作成中...":"イベントを作成する"," ",e.jsx(ae,{size:20})]})})]})]}),e.jsxs("article",{className:"p-6 bg-white dark:bg-dark-lighter rounded-3xl border border-gray-100 dark:border-gray-700 prose dark:prose-invert max-w-none shadow-sm",children:[e.jsxs("h2",{className:"text-lg font-black flex items-center gap-2 mb-4",children:[e.jsx(te,{className:"text-teal-500",size:20}),"「まいつーる日程調整」の特長"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-xs leading-relaxed text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-2 flex items-center gap-2",children:[e.jsx(De,{size:16,className:"text-teal-500"}),"ログイン不要で即作成"]}),e.jsx("p",{children:"面倒な会員登録は一切不要。思い立ったらすぐにイベントページを作成し、URLをLINEやSlackで共有するだけで調整がスタートします。回答もスマホからサクサク行えます。"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-2 flex items-center gap-2",children:[e.jsx(Pe,{size:16,className:"text-teal-500"}),"細かいニュアンスも伝わる"]}),e.jsx("p",{children:"単なる○✕だけでなく、日程ごとにコメントを残せるため、「19時以降なら○」「場所によっては△」といった細かい条件もスムーズに共有できます。"})]})]})]}),!z&&e.jsx(Q,{})]})};export{Qe as default};
