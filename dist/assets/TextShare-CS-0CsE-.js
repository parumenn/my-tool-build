import{a3 as P,r as t,j as e,F as R,P as $,f as O,m as x,a as u,a4 as y,Z as B,g as G}from"./index-BGOqOQkd.js";import{T as j}from"./triangle-alert-WFXLyDKC.js";import{C as k}from"./copy-TJ65exfC.js";import{L as I}from"./link-BT6fPaOF.js";import{I as A}from"./info-BVwycOoD.js";const V=()=>{const[w,N]=P(),l=w.get("id"),[o,c]=t.useState(""),[m,v]=t.useState(2),[g,C]=t.useState(""),[d,S]=t.useState(null),[s,r]=t.useState("idle"),[n,h]=t.useState(""),[z,b]=t.useState(!1),[p,f]=t.useState(!1);t.useEffect(()=>{l?(r("loading"),fetch(`./backend/text_share_api.php?action=get&id=${l}`).then(async a=>{if(!a.ok)throw a.status===404?new Error("notfound"):new Error("error");return a.json()}).then(a=>{C(a.text),S({created_at:a.created_at,expires_at:a.expires_at}),r("success")}).catch(a=>{r(a.message==="notfound"?"notfound":"error")})):r("idle")},[l]);const T=async()=>{if(o.trim()){r("loading");try{const a=await fetch("./backend/text_share_api.php?action=save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:o,days:m})});if(!a.ok)throw new Error("Save failed");const E=await a.json(),L=`${window.location.origin}${window.location.pathname}#/share?id=${E.id}`;h(L),r("success")}catch{alert("保存に失敗しました。サイズが大きすぎるか、通信エラーの可能性があります。"),r("idle")}}},_=()=>{navigator.clipboard.writeText(n),b(!0),setTimeout(()=>b(!1),2e3)},U=()=>{navigator.clipboard.writeText(g),f(!0),setTimeout(()=>f(!1),2e3)},i=()=>{N({}),c(""),h(""),r("idle")};return l?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-10 pb-20",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-2xl p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(R,{className:"text-emerald-500"})," 共有されたテキスト"]}),e.jsxs("button",{onClick:i,className:"text-xs bg-gray-100 dark:bg-gray-800 px-3 py-2 rounded-lg font-bold flex items-center gap-1 hover:bg-gray-200 transition-colors",children:[e.jsx($,{size:14})," 新規作成"]})]}),s==="loading"&&e.jsx("div",{className:"py-20 text-center text-gray-400 font-bold animate-pulse",children:"データを読み込み中..."}),(s==="notfound"||s==="error")&&e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(j,{size:32,className:"text-gray-400"})}),e.jsx("h3",{className:"text-xl font-black text-gray-700 dark:text-gray-300 mb-2",children:"テキストが見つかりません"}),e.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"有効期限が切れて削除されたか、URLが間違っている可能性があります。"}),e.jsx("button",{onClick:i,className:"bg-emerald-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-emerald-700 transition-colors",children:"新しく作成する"})]}),s==="success"&&e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs font-bold text-gray-500 bg-gray-50 dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{size:14})," 作成日: ",d==null?void 0:d.created_at]}),e.jsxs("span",{className:"flex items-center gap-1 text-red-500",children:[e.jsx(j,{size:14})," 有効期限: ",d==null?void 0:d.expires_at,"まで"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{readOnly:!0,value:g,className:"w-full h-[60vh] p-6 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 font-mono text-sm resize-none focus:outline-none"}),e.jsxs("button",{onClick:U,className:"absolute top-4 right-4 bg-emerald-600 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-lg hover:bg-emerald-700 transition-colors flex items-center gap-2",children:[p?e.jsx(x,{size:14}):e.jsx(k,{size:14}),p?"コピー完了":"本文をコピー"]})]})]})]}),e.jsx(u,{})]}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-10 pb-20",children:[e.jsxs("div",{className:"bg-white dark:bg-dark-lighter rounded-2xl p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-2 flex items-center gap-2",children:[e.jsx(y,{className:"text-emerald-500"})," テキスト共有ツール"]}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-8",children:["テキストを一時的にクラウドに保存し、共有用のURLを発行します。",e.jsx("br",{}),"最大1GBまで対応。期限が過ぎるとデータは完全に削除されます。"]}),s==="success"?e.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 p-8 rounded-3xl border-2 border-emerald-100 dark:border-emerald-800 text-center animate-fade-in",children:[e.jsx("div",{className:"bg-white dark:bg-emerald-800 p-4 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-sm",children:e.jsx(x,{size:40,className:"text-emerald-500 dark:text-emerald-200"})}),e.jsx("h3",{className:"text-2xl font-black text-emerald-800 dark:text-emerald-200 mb-2",children:"共有URLを発行しました"}),e.jsx("p",{className:"text-emerald-600 dark:text-emerald-400 text-sm mb-8 font-bold",children:"このURLを知っている人だけが閲覧できます"}),e.jsxs("div",{className:"flex gap-2 max-w-lg mx-auto mb-8",children:[e.jsx("input",{type:"text",readOnly:!0,value:n,className:"flex-1 p-4 rounded-xl border-2 border-emerald-200 dark:border-emerald-700 bg-white dark:bg-gray-900 text-emerald-800 dark:text-emerald-200 font-bold text-sm truncate focus:outline-none"}),e.jsx("button",{onClick:_,className:"bg-emerald-600 text-white px-6 rounded-xl font-bold hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-200 dark:shadow-none shrink-0 flex items-center gap-2",children:z?e.jsx(x,{size:20}):e.jsx(k,{size:20})})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 dark:text-emerald-400 font-bold hover:underline flex items-center gap-1",children:[e.jsx(I,{size:16})," ページを開く"]}),e.jsx("span",{className:"text-emerald-300",children:"|"}),e.jsx("button",{onClick:i,className:"text-gray-500 dark:text-gray-400 font-bold hover:text-gray-700 dark:hover:text-gray-200",children:"新しく作成する"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("textarea",{value:o,onChange:a=>c(a.target.value),placeholder:"ここに共有したいテキストを入力してください...",className:"w-full h-64 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-white focus:border-emerald-500 focus:bg-white dark:focus:bg-black transition-colors resize-none font-mono text-sm leading-relaxed"}),e.jsx("p",{className:"text-right text-xs font-bold text-gray-400 mt-2",children:"※ブラウザのメモリ制限により、極端に巨大なテキストは動作が重くなる場合があります。"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6 bg-gray-50 dark:bg-gray-800 p-6 rounded-2xl border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"w-full md:w-auto",children:[e.jsx("label",{className:"block text-xs font-black text-gray-400 uppercase tracking-widest mb-2",children:"有効期限 (自動削除)"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,7].map(a=>e.jsxs("button",{onClick:()=>v(a),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${m===a?"bg-emerald-600 text-white shadow-md":"bg-white dark:bg-gray-700 text-gray-500 border border-gray-200 dark:border-gray-600"}`,children:[a,"日"]},a))})]}),e.jsxs("button",{onClick:T,disabled:s==="loading"||!o,className:"w-full md:w-auto px-10 py-4 bg-emerald-600 text-white font-black rounded-xl shadow-xl hover:bg-emerald-700 hover:shadow-2xl hover:-translate-y-1 transition-all disabled:opacity-50 disabled:transform-none disabled:shadow-none flex items-center justify-center gap-2",children:[s==="loading"?"保存中...":"リンクを作成する"," ",e.jsx(y,{size:20})]})]})]})]}),e.jsxs("article",{className:"p-8 bg-white dark:bg-dark-lighter rounded-3xl border border-gray-100 dark:border-gray-700 prose dark:prose-invert max-w-none shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 mb-6",children:[e.jsx(A,{className:"text-blue-500"}),"大容量テキスト共有ツールの特徴"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 text-sm leading-relaxed text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-3 flex items-center gap-2",children:[e.jsx(B,{size:18,className:"text-emerald-500"}),"コードやログの共有に最適"]}),e.jsx("p",{children:"チャットツールでは送れないような長いエラーログ、ソースコード、設定ファイルなどを手軽に共有できます。最大1GB（サーバー許容値）まで対応しているため、文字数制限を気にする必要はありません。"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-3 flex items-center gap-2",children:[e.jsx(G,{size:18,className:"text-emerald-500"}),"自動削除でゴミを残さない"]}),e.jsx("p",{children:"設定した期間（最大7日）が過ぎると、サーバーからデータは物理的に削除されます。「ずっと残り続けるのが不安」という一時的な共有用途に特化しており、プライバシーとセキュリティに配慮した設計となっています。"})]})]})]}),e.jsx(u,{})]})};export{V as default};
