import{j as e,a as M}from"./index-A0BsTpgX.js";import{r as o}from"./vendor-react-Dy8mW7IA.js";import{P as h,d as O}from"./vendor-utils-V9s-2EHj.js";import{W}from"./WorkspaceContext-gpeJemtb.js";import{X as k,aR as v,ac as w,aS as N,aA as D,aa as P,a6 as _,a4 as Z,y as X,Z as q}from"./vendor-ui-BTIjoA30.js";const V=()=>{const x=o.useContext(W),[b,S]=o.useState("merge"),[d,c]=o.useState(!1),[n,l]=o.useState(!1),[g,u]=o.useState([]),[f,y]=o.useState(null),[p,C]=o.useState(""),[m,F]=o.useState(null),[z,L]=o.useState(90),j=(a,r)=>{const s=new Blob([a],{type:"application/pdf"}),t=document.createElement("a");t.href=URL.createObjectURL(s),t.download=r,document.body.appendChild(t),t.click(),document.body.removeChild(t)},T=a=>{let r=[];"files"in a.target&&a.target.files?r=Array.from(a.target.files):"dataTransfer"in a&&a.dataTransfer.files&&(a.preventDefault(),r=Array.from(a.dataTransfer.files));const s=r.filter(t=>t.type==="application/pdf");u(t=>[...t,...s]),l(!1)},A=async()=>{if(!(g.length<2)){c(!0);try{const a=await h.create();for(const s of g){const t=await s.arrayBuffer(),i=await h.load(t);(await a.copyPages(i,i.getPageIndices())).forEach(I=>a.addPage(I))}const r=await a.save();j(r,"merged_document.pdf")}catch{alert("結合に失敗しました。ファイルが破損しているか、保護されている可能性があります。")}finally{c(!1)}}},R=a=>{var s,t;let r=null;"files"in a.target&&((s=a.target.files)!=null&&s[0])?r=a.target.files[0]:"dataTransfer"in a&&((t=a.dataTransfer.files)!=null&&t[0])&&(a.preventDefault(),r=a.dataTransfer.files[0]),r&&r.type==="application/pdf"&&y(r),l(!1)},E=async()=>{if(!(!f||!p)){c(!0);try{const a=await f.arrayBuffer(),s=await(await h.load(a,{password:p})).save();j(s,`unlocked_${f.name}`),y(null),C("")}catch{alert("パスワードが正しくないか、処理に失敗しました。")}finally{c(!1)}}},$=a=>{var s,t;let r=null;"files"in a.target&&((s=a.target.files)!=null&&s[0])?r=a.target.files[0]:"dataTransfer"in a&&((t=a.dataTransfer.files)!=null&&t[0])&&(a.preventDefault(),r=a.dataTransfer.files[0]),r&&r.type==="application/pdf"&&F(r),l(!1)},U=async()=>{if(m){c(!0);try{const a=await m.arrayBuffer(),r=await h.load(a);r.getPages().forEach(i=>{const B=i.getRotation().angle;i.setRotation(O(B+z))});const t=await r.save();j(t,`rotated_${m.name}`)}catch{alert("回転処理に失敗しました。")}finally{c(!1)}}};return e.jsxs("div",{className:`mx-auto h-full flex flex-col ${x?"max-w-full p-2":"max-w-5xl space-y-10 pb-20"}`,children:[!x&&e.jsxs("div",{className:"flex items-center gap-3 mb-2 shrink-0",children:[e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-2xl",children:e.jsx(k,{className:"text-red-600 dark:text-red-400",size:32})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-gray-800 dark:text-white",children:"PDFツールボックス"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"ブラウザ完結・サーバー保存なしで安全に編集"})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl overflow-x-auto no-scrollbar shrink-0",children:[{id:"merge",icon:v,label:"結合"},{id:"unlock",icon:w,label:"保護解除"},{id:"rotate",icon:N,label:"一括回転"}].map(a=>e.jsxs("button",{onClick:()=>{S(a.id),l(!1)},className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-black transition-all whitespace-nowrap ${b===a.id?"bg-white dark:bg-gray-700 text-red-600 dark:text-red-400 shadow-sm":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[e.jsx(a.icon,{size:16})," ",a.label]},a.id))}),e.jsxs("div",{className:`bg-white dark:bg-dark-lighter rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col min-h-[450px] overflow-hidden ${x?"p-4":"p-10"}`,children:[b==="merge"&&e.jsxs("div",{className:"space-y-6 animate-fade-in flex-1 flex flex-col max-w-2xl mx-auto w-full",children:[e.jsxs("div",{onDragOver:a=>{a.preventDefault(),l(!0)},onDragLeave:()=>l(!1),onDrop:T,className:`border-4 border-dashed rounded-3xl p-10 text-center transition-all relative ${n?"border-red-500 bg-red-50 dark:bg-red-900/20 scale-[0.98]":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,children:[e.jsx("input",{type:"file",accept:".pdf",multiple:!0,onChange:T,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsx(v,{size:48,className:`mx-auto mb-4 ${n?"text-red-500 animate-bounce":"text-gray-300"}`}),e.jsx("p",{className:"font-black text-lg text-gray-700 dark:text-gray-200",children:n?"ここにドロップして追加":"PDFファイルを選択またはドラッグ"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 font-bold uppercase tracking-widest",children:"Multiple Files Supported"})]}),g.length>0&&e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center px-2",children:[e.jsxs("span",{className:"text-xs font-black text-gray-400 uppercase",children:[g.length," ファイル選択中"]}),e.jsx("button",{onClick:()=>u([]),className:"text-xs text-red-500 font-bold hover:underline",children:"すべてクリア"})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-1 no-scrollbar bg-gray-50 dark:bg-gray-900/50 p-2 rounded-2xl border border-gray-100 dark:border-gray-800",children:g.map((a,r)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 group",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-2 rounded-lg text-red-500 font-bold text-[10px]",children:r+1}),e.jsx("span",{className:"text-xs font-bold truncate text-gray-700 dark:text-gray-200",children:a.name})]}),e.jsx("button",{onClick:()=>u(s=>s.filter((t,i)=>i!==r)),className:"text-gray-400 hover:text-red-500 p-1",children:e.jsx(D,{size:14})})]},r))}),e.jsxs("button",{onClick:A,disabled:d,className:"w-full py-4 bg-red-600 text-white font-black rounded-2xl shadow-xl hover:bg-red-700 hover:shadow-2xl hover:-translate-y-1 transition-all disabled:opacity-50 disabled:shadow-none flex items-center justify-center gap-2",children:[d?e.jsx(P,{className:"animate-spin"}):e.jsx(v,{size:20}),d?"結合処理中...":"PDFを結合してダウンロード"]})]})]}),b==="unlock"&&e.jsxs("div",{className:"space-y-6 animate-fade-in flex-1 flex flex-col max-w-2xl mx-auto w-full",children:[e.jsxs("div",{onDragOver:a=>{a.preventDefault(),l(!0)},onDragLeave:()=>l(!1),onDrop:R,className:`border-4 border-dashed rounded-3xl p-10 text-center transition-all relative ${n?"border-red-500 bg-red-50 dark:bg-red-900/20 scale-[0.98]":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,children:[e.jsx("input",{type:"file",accept:".pdf",onChange:R,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsx(w,{size:48,className:`mx-auto mb-4 ${n?"text-red-500 animate-bounce":"text-gray-300"}`}),e.jsx("p",{className:"font-black text-lg text-gray-700 dark:text-gray-200",children:n?"ここにドロップ":"保護されたPDFを選択"})]}),f&&e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-2 rounded-lg text-red-500",children:e.jsx(k,{size:20})}),e.jsx("span",{className:"text-sm font-bold truncate flex-1 text-gray-700 dark:text-gray-200",children:f.name}),e.jsx("button",{onClick:()=>y(null),className:"text-gray-400 hover:text-red-500",children:e.jsx(D,{size:16})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest",children:"パスワード"}),e.jsx("input",{type:"password",value:p,onChange:a=>C(a.target.value),placeholder:"パスワードを入力...",className:"w-full p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white font-bold outline-none focus:border-red-500 transition-colors"})]}),e.jsxs("button",{onClick:E,disabled:d||!p,className:"w-full py-4 bg-red-600 text-white font-black rounded-2xl shadow-xl hover:bg-red-700 disabled:opacity-50 disabled:shadow-none flex items-center justify-center gap-2 transition-all",children:[d?e.jsx(P,{className:"animate-spin"}):e.jsx(w,{size:20}),d?"解除処理中...":"保護を解除してダウンロード"]})]})]}),b==="rotate"&&e.jsxs("div",{className:"space-y-6 animate-fade-in flex-1 flex flex-col max-w-2xl mx-auto w-full",children:[e.jsxs("div",{onDragOver:a=>{a.preventDefault(),l(!0)},onDragLeave:()=>l(!1),onDrop:$,className:`border-4 border-dashed rounded-3xl p-10 text-center transition-all relative ${n?"border-red-500 bg-red-50 dark:bg-red-900/20 scale-[0.98]":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,children:[e.jsx("input",{type:"file",accept:".pdf",onChange:$,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsx(N,{size:48,className:`mx-auto mb-4 ${n?"text-red-500 animate-bounce":"text-gray-300"}`}),e.jsx("p",{className:"font-black text-lg text-gray-700 dark:text-gray-200",children:n?"ここにドロップ":"PDFファイルを選択"})]}),m&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-2 rounded-lg text-red-500",children:e.jsx(k,{size:20})}),e.jsx("span",{className:"text-sm font-bold truncate flex-1 text-gray-700 dark:text-gray-200",children:m.name}),e.jsx("button",{onClick:()=>F(null),className:"text-gray-400 hover:text-red-500",children:e.jsx(D,{size:16})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-6 rounded-2xl border border-gray-200 dark:border-gray-700",children:[e.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest block mb-4",children:"回転角度 (右回り)"}),e.jsx("div",{className:"flex justify-center gap-4",children:[90,180,270].map(a=>e.jsxs("button",{onClick:()=>L(a),className:`px-6 py-3 rounded-xl font-black text-sm transition-all flex items-center gap-2 ${z===a?"bg-red-600 text-white shadow-lg":"bg-white dark:bg-gray-700 text-gray-600 dark:text-gray-300 border border-gray-200 dark:border-gray-600"}`,children:[e.jsx(N,{size:14})," ",a,"°"]},a))})]}),e.jsxs("button",{onClick:U,disabled:d,className:"w-full py-4 bg-red-600 text-white font-black rounded-2xl shadow-xl hover:bg-red-700 disabled:opacity-50 disabled:shadow-none flex items-center justify-center gap-2 transition-all",children:[d?e.jsx(P,{className:"animate-spin"}):e.jsx(_,{size:20}),d?"回転処理中...":"回転してダウンロード"]})]})]})]}),!x&&e.jsxs("article",{className:"mt-12 p-8 bg-white dark:bg-dark-lighter rounded-3xl border border-gray-100 dark:border-gray-700 shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 mb-6",children:[e.jsx(Z,{className:"text-blue-500"}),"PDFツールの特徴とセキュリティ"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 text-sm leading-relaxed text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-3 flex items-center gap-2",children:[e.jsx(X,{size:18,className:"text-red-500"}),"サーバー送信なしの完全ローカル処理"]}),e.jsx("p",{children:"当サイトのPDF編集機能は、WebAssembly技術を活用し、すべてお使いのブラウザ内（クライアントサイド）で完結します。 PDFファイルがサーバーにアップロードされることは一切ありません。契約書や請求書など、機密性の高い文書も安心して処理いただけます。"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-gray-800 dark:text-white font-bold mb-3 flex items-center gap-2",children:[e.jsx(q,{size:18,className:"text-red-500"}),"シンプルな操作性"]}),e.jsx("p",{children:"専用ソフトのインストールや会員登録は不要です。「結合」「解除」「回転」という日常的によく使う機能に絞り込み、ドラッグ＆ドロップで直感的に操作できるように設計されています。"})]})]})]}),!x&&e.jsx(M,{})]})};export{V as default};
